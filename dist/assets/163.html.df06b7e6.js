import{_ as a,o as s,c as n,d as e}from"./app.9f3e6cab.js";const i={},t=e(`<h1 id="chart-releaser" tabindex="-1"><a class="header-anchor" href="#chart-releaser" aria-hidden="true">#</a> Chart Releaser</h1><p>\u6211\u4EEC\u5DF2\u7ECF\u6709\u4E86\u4E00\u5957\u7684 Helm Charts \uFF0C\u60F3\u529E\u6CD5\u628A\u4ED6\u4EEC\u4E32\u8D77\u6765\u53D1\u5E03\u51FA\u53BB\uFF0C\u6B64\u65F6\u60F3\u7740\u53EF\u4EE5\u4F7F\u7528 chart releaser \u6765\u5B9E\u73B0\u4E86\u3002</p><p>\u6211\u4EEC\u7684\u4ED3\u5E93\u5730\u5740\u662F\uFF1Ahttps://github.com/openimsdk/helm-charts/</p><p>\u6211\u4EEC\u6765\u4ECB\u7ECD\u4E24\u79CD\u5DE5\u5177</p><ul><li>cr: https://github.com/helm/chart-releaser</li><li>ct: https://github.com/helm/chart-testing</li></ul><h2 id="cr" tabindex="-1"><a class="header-anchor" href="#cr" aria-hidden="true">#</a> CR</h2><p><strong>\u4F7F\u7528\u7684\u5DE5\u5177 GitHub \u5730\u5740\uFF1Ahttps://github.com/helm/chart-releaser</strong></p><blockquote><p><strong>\u5E2E\u52A9\u5C06GitHub\u5B58\u50A8\u5E93\u8F6C\u6362\u4E3AHelm Chart\u5B58\u50A8\u5E93</strong></p></blockquote><p>\u7B80\u79F0\u4E3A CR:cr-release-packages</p><blockquote><p><code>cr</code> \u662F\u4E00\u4E2A\u5DE5\u5177\uFF0C\u65E8\u5728\u5E2E\u52A9GitHub\u5B58\u50A8\u5E93\u81EA\u6258\u7BA1\u81EA\u5DF1\u7684\u56FE\u8868\u5B58\u50A8\u5E93\uFF0C\u65B9\u6CD5\u662F\u5C06Helm\u56FE\u8868\u5DE5\u4EF6\u6DFB\u52A0\u5230\u4EE5\u56FE\u8868\u7248\u672C\u547D\u540D\u7684GitHub\u53D1\u5E03\u7248\u672C\u4E2D\uFF0C\u7136\u540E\u4E3A\u53EF\u4EE5\u6258\u7BA1\u5728GitHub Pages\uFF08\u6216\u5176\u4ED6\u5730\u65B9\uFF01\uFF09\u4E0A\u7684\u8FD9\u4E9B\u53D1\u5E03\u7248\u672C\u521B\u5EFA <code>index.yaml</code> \u6587\u4EF6\u3002</p></blockquote><h3 id="\u5B89\u88C5" tabindex="-1"><a class="header-anchor" href="#\u5B89\u88C5" aria-hidden="true">#</a> \u5B89\u88C5</h3><p>Binaries (recommended) \u4E8C\u8FDB\u5236\u6587\u4EF6\uFF08\u63A8\u8350\uFF09</p><p>\u4ECE\u7248\u672C\u9875\u9762\u4E0B\u8F7D\u60A8\u7684\u9996\u9009\u8D44\u4EA7\u5E76\u624B\u52A8\u5B89\u88C5\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ brew tap helm/tap
$ brew <span class="token function">install</span> chart-releaser
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u76EE\u524D\uFF0C <code>cr</code> \u53EF\u4EE5\u4ECE\u6253\u5305\u5230\u76EE\u5F55\u4E2D\u7684\u4E00\u7EC4\u56FE\u8868\u521B\u5EFAGitHub Releases\uFF0C\u5E76\u4ECEGitHub Releases\u4E3A\u56FE\u8868\u5B58\u50A8\u5E93\u521B\u5EFA <code>index.yaml</code> \u6587\u4EF6\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>\u276F cr

Create Helm chart repositories on GitHub Pages by uploading Chart packages
and Chart metadata to GitHub Releases and creating a suitable index <span class="token function">file</span>

Usage:
  cr <span class="token punctuation">[</span>command<span class="token punctuation">]</span>

Available Commands:
  completion  Generate the autocompletion script <span class="token keyword">for</span> the specified shell
  <span class="token builtin class-name">help</span>        Help about any <span class="token builtin class-name">command</span>
  index       Update Helm repo index.yaml <span class="token keyword">for</span> the given GitHub repo
  package     Package Helm charts
  upload      Upload Helm chart packages to GitHub Releases
  version     Print version information

Flags:
      <span class="token parameter variable">--config</span> string   Config <span class="token function">file</span> <span class="token punctuation">(</span>default is <span class="token environment constant">$HOME</span>/.cr.yaml<span class="token punctuation">)</span>
  -h, <span class="token parameter variable">--help</span>            <span class="token builtin class-name">help</span> <span class="token keyword">for</span> cr

Use <span class="token string">&quot;cr [command] --help&quot;</span> <span class="token keyword">for</span> <span class="token function">more</span> information about a command.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u89E3\u6790\u53EF\u4EE5\u7528\u7684\u547D\u4EE4\uFF1A</strong></p><ul><li><code>completion</code> \u751F\u6210\u6307\u5B9A shell \u7684\u81EA\u52A8\u8865\u5168\u811A\u672C\u3002\u8FD9\u6709\u52A9\u4E8E\u5728\u4F7F\u7528 <code>cr</code> \u547D\u4EE4\u65F6\u81EA\u52A8\u63D0\u793A\u53EF\u7528\u7684\u547D\u4EE4\u548C\u53C2\u6570\u3002</li><li><code>help</code> \u63D0\u4F9B\u5173\u4E8E\u4EFB\u4F55\u547D\u4EE4\u7684\u5E2E\u52A9\u4FE1\u606F\u3002</li><li><code>index</code> \u4E3A\u7ED9\u5B9A\u7684 GitHub \u4ED3\u5E93\u66F4\u65B0 Helm \u4ED3\u5E93\u7684 <code>index.yaml</code> \u6587\u4EF6\u3002\u8FD9\u4E2A\u6587\u4EF6\u662F Helm \u4ED3\u5E93\u7684\u7D22\u5F15\uFF0C\u5305\u542B\u4E86\u4ED3\u5E93\u4E2D\u6240\u6709\u56FE\u8868\u7684\u4FE1\u606F\u3002</li><li><code>package</code> \u6253\u5305 Helm \u56FE\u8868\u3002\u8FD9\u4E2A\u8FC7\u7A0B\u901A\u5E38\u6D89\u53CA\u5C06\u56FE\u8868\u6E90\u4EE3\u7801\uFF08\u901A\u5E38\u662F\u4E00\u7EC4 YAML \u6587\u4EF6\uFF09\u6253\u5305\u6210\u4E00\u4E2A\u538B\u7F29\u6587\u4EF6\uFF0C\u4EE5\u4FBF\u53D1\u5E03\u548C\u5206\u53D1\u3002</li><li><code>upload</code> \u5C06 Helm \u56FE\u8868\u5305\u4E0A\u4F20\u5230 GitHub Releases\u3002\u8FD9\u662F\u5C06 Helm \u56FE\u8868\u53D1\u5E03\u5230 GitHub \u4ED3\u5E93\u7684\u4E00\u79CD\u65B9\u5F0F\u3002</li><li><code>version</code> \u6253\u5370 <code>cr</code> \u5DE5\u5177\u7684\u7248\u672C\u4FE1\u606F\u3002</li></ul><h3 id="\u4ECEhelm-chart\u8F6F\u4EF6\u5305\u521B\u5EFAgithub\u7248\u672C" tabindex="-1"><a class="header-anchor" href="#\u4ECEhelm-chart\u8F6F\u4EF6\u5305\u521B\u5EFAgithub\u7248\u672C" aria-hidden="true">#</a> \u4ECEHelm Chart\u8F6F\u4EF6\u5305\u521B\u5EFAGitHub\u7248\u672C</h3><p>\u626B\u63CFHelm chart\u5305\u7684\u8DEF\u5F84\uFF0C\u5E76\u5728\u6307\u5B9A\u7684GitHub\u5B58\u50A8\u5E93\u4E2D\u521B\u5EFA\u53D1\u5E03\uFF0C\u4E0A\u4F20\u5305\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ cr upload <span class="token parameter variable">--help</span>
Upload Helm chart packages to GitHub Releases

Usage:
  cr upload <span class="token punctuation">[</span>flags<span class="token punctuation">]</span>

Flags:
  -c, <span class="token parameter variable">--commit</span> string                  Target commit <span class="token keyword">for</span> release
      --generate-release-notes         Whether to automatically generate the name and body <span class="token keyword">for</span> this release. See https://docs.github.com/en/rest/releases/releases
  -b, --git-base-url string            GitHub Base URL <span class="token punctuation">(</span>only needed <span class="token keyword">for</span> private GitHub<span class="token punctuation">)</span> <span class="token punctuation">(</span>default <span class="token string">&quot;https://api.github.com/&quot;</span><span class="token punctuation">)</span>
  -r, --git-repo string                GitHub repository
  -u, --git-upload-url string          GitHub Upload URL <span class="token punctuation">(</span>only needed <span class="token keyword">for</span> private GitHub<span class="token punctuation">)</span> <span class="token punctuation">(</span>default <span class="token string">&quot;https://uploads.github.com/&quot;</span><span class="token punctuation">)</span>
  -h, <span class="token parameter variable">--help</span>                           <span class="token builtin class-name">help</span> <span class="token keyword">for</span> upload
  -o, <span class="token parameter variable">--owner</span> string                   GitHub username or organization
  -p, --package-path string            Path to directory with chart packages <span class="token punctuation">(</span>default <span class="token string">&quot;.cr-release-packages&quot;</span><span class="token punctuation">)</span>
      --release-name-template string   Go template <span class="token keyword">for</span> computing release names, using chart metadata <span class="token punctuation">(</span>default <span class="token string">&quot;{{ .Name }}-{{ .Version }}&quot;</span><span class="token punctuation">)</span>
      --release-notes-file string      Markdown <span class="token function">file</span> with chart release notes. If it is <span class="token builtin class-name">set</span> to empty string, or the <span class="token function">file</span> is not found, the chart description will be used instead. The <span class="token function">file</span> is <span class="token builtin class-name">read</span> from the chart package
      --skip-existing                  Skip upload <span class="token keyword">if</span> release exists
  -t, <span class="token parameter variable">--token</span> string                   GitHub Auth Token
      --make-release-latest bool       Mark the created GitHub release as <span class="token string">&#39;latest&#39;</span> <span class="token punctuation">(</span>default <span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span>
      --packages-with-index            Host the package files <span class="token keyword">in</span> the GitHub Pages branch

Global Flags:
      <span class="token parameter variable">--config</span> string   Config <span class="token function">file</span> <span class="token punctuation">(</span>default is <span class="token environment constant">$HOME</span>/.cr.yaml<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u4ECEgithub-releases\u521B\u5EFA\u5B58\u50A8\u5E93\u7D22\u5F15" tabindex="-1"><a class="header-anchor" href="#\u4ECEgithub-releases\u521B\u5EFA\u5B58\u50A8\u5E93\u7D22\u5F15" aria-hidden="true">#</a> \u4ECEGitHub Releases\u521B\u5EFA\u5B58\u50A8\u5E93\u7D22\u5F15</h3><p>\u4E0A\u4F20\u540E\uFF0C\u60A8\u53EF\u4EE5\u521B\u5EFA\u4E00\u4E2A\u53EF\u4EE5\u6258\u7BA1\u5728GitHub Pages\uFF08\u6216\u5176\u4ED6\u5730\u65B9\uFF09\u4E0A\u7684 <code>index.yaml</code> \u6587\u4EF6\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ cr index <span class="token parameter variable">--help</span>
Update a Helm chart repository index.yaml <span class="token function">file</span> based on a the
given GitHub repository&#39;s releases.

Usage:
  cr index <span class="token punctuation">[</span>flags<span class="token punctuation">]</span>

Flags:
  -b, --git-base-url string            GitHub Base URL <span class="token punctuation">(</span>only needed <span class="token keyword">for</span> private GitHub<span class="token punctuation">)</span> <span class="token punctuation">(</span>default <span class="token string">&quot;https://api.github.com/&quot;</span><span class="token punctuation">)</span>
  -r, --git-repo string                GitHub repository
  -u, --git-upload-url string          GitHub Upload URL <span class="token punctuation">(</span>only needed <span class="token keyword">for</span> private GitHub<span class="token punctuation">)</span> <span class="token punctuation">(</span>default <span class="token string">&quot;https://uploads.github.com/&quot;</span><span class="token punctuation">)</span>
  -h, <span class="token parameter variable">--help</span>                           <span class="token builtin class-name">help</span> <span class="token keyword">for</span> index
  -i, --index-path string              Path to index <span class="token function">file</span> <span class="token punctuation">(</span>default <span class="token string">&quot;.cr-index/index.yaml&quot;</span><span class="token punctuation">)</span>
  -o, <span class="token parameter variable">--owner</span> string                   GitHub username or organization
  -p, --package-path string            Path to directory with chart packages <span class="token punctuation">(</span>default <span class="token string">&quot;.cr-release-packages&quot;</span><span class="token punctuation">)</span>
      --pages-branch string            The GitHub pages branch <span class="token punctuation">(</span>default <span class="token string">&quot;gh-pages&quot;</span><span class="token punctuation">)</span>
      --pages-index-path string        The GitHub pages index path <span class="token punctuation">(</span>default <span class="token string">&quot;index.yaml&quot;</span><span class="token punctuation">)</span>
      <span class="token parameter variable">--pr</span>                             Create a pull request <span class="token keyword">for</span> index.yaml against the GitHub Pages branch <span class="token punctuation">(</span>must not be <span class="token builtin class-name">set</span> <span class="token keyword">if</span> <span class="token parameter variable">--push</span> is <span class="token builtin class-name">set</span><span class="token punctuation">)</span>
      <span class="token parameter variable">--push</span>                           Push index.yaml to the GitHub Pages branch <span class="token punctuation">(</span>must not be <span class="token builtin class-name">set</span> <span class="token keyword">if</span> <span class="token parameter variable">--pr</span> is <span class="token builtin class-name">set</span><span class="token punctuation">)</span>
      --release-name-template string   Go template <span class="token keyword">for</span> computing release names, using chart metadata <span class="token punctuation">(</span>default <span class="token string">&quot;{{ .Name }}-{{ .Version }}&quot;</span><span class="token punctuation">)</span>
      <span class="token parameter variable">--remote</span> string                  The Git remote used when creating a <span class="token builtin class-name">local</span> worktree <span class="token keyword">for</span> the GitHub Pages branch <span class="token punctuation">(</span>default <span class="token string">&quot;origin&quot;</span><span class="token punctuation">)</span>
  -t, <span class="token parameter variable">--token</span> string                   GitHub Auth Token <span class="token punctuation">(</span>only needed <span class="token keyword">for</span> private repos<span class="token punctuation">)</span>
      --packages-with-index            Host the package files <span class="token keyword">in</span> the GitHub Pages branch

Global Flags:
      <span class="token parameter variable">--config</span> string   Config <span class="token function">file</span> <span class="token punctuation">(</span>default is <span class="token environment constant">$HOME</span>/.cr.yaml<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Docker\u955C\u50CF\u88AB\u63A8\u9001\u5230 <code>helmpack/chart-martaser</code> Quay\u5BB9\u5668\u6CE8\u518C\u8868\u3002Docker\u955C\u50CF\u6784\u5EFA\u5728Alpine\u4E4B\u4E0A\uFF0C\u5176\u9ED8\u8BA4\u5165\u53E3\u70B9\u662F <code>cr</code> \u3002\u6709\u5173\u66F4\u591A\u8BE6\u7EC6\u4FE1\u606F\uFF0C\u8BF7\u53C2\u9605Dockerfile\u3002</p><h3 id="usage-\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#usage-\u4F7F\u7528" aria-hidden="true">#</a> Usage \u4F7F\u7528</h3><p>\u4EE5\u4E0B\u662F\u60A8\u5FC5\u987B\u8FD0\u884C\u7684\u4E09\u4E2A\u547D\u4EE4\uFF0C\u4EE5\u4F7F\u56FE\u8868\u6700\u7EC8\u6258\u7BA1\u5728Github\u9875\u9762\u7684\u6839\u76EE\u5F55\u4E2D\u5E76\u53EF\u8BBF\u95EE\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>cr package <span class="token operator">&lt;</span>chart<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>cr upload <span class="token parameter variable">--owner</span> <span class="token operator">&lt;</span>owner<span class="token operator">&gt;</span> --git-repo <span class="token operator">&lt;</span>repo_name<span class="token operator">&gt;</span> --packages-with-index <span class="token parameter variable">--token</span> <span class="token operator">&lt;</span>token<span class="token operator">&gt;</span> <span class="token parameter variable">--push</span> --skip-existing
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4E0D\u8981\u5FD8\u8BB0\u5728upload\u547D\u4EE4\u4E2D\u4F7F\u7528 <code>--skip-existing</code> \u6807\u5FD7\uFF0C\u4EE5\u907F\u514D\u51FA\u73B0 <code>422 Validation Failed</code> \u9519\u8BEF\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>cr index <span class="token parameter variable">--owner</span> <span class="token operator">&lt;</span>owner<span class="token operator">&gt;</span> --git-repo <span class="token operator">&lt;</span>repo_name<span class="token operator">&gt;</span>  --packages-with-index --index-path <span class="token builtin class-name">.</span> <span class="token parameter variable">--token</span> <span class="token operator">&lt;</span>token<span class="token operator">&gt;</span> <span class="token parameter variable">--push</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="\u4F8B\u5982" tabindex="-1"><a class="header-anchor" href="#\u4F8B\u5982" aria-hidden="true">#</a> \u4F8B\u5982</h3><p>\u5728\u4ED3\u5E93\u7684\u6839\u76EE\u5F55\u4E2D\u4F7F\u7528testChart helm chart\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>cr package testChart/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5982\u679C\u4F60\u5C06\u5728\u4E2D\u83B7\u5F97 <code>.tgz</code>\u3002<code>/cr-release-pacakges</code></p><p>\u90A3\u4E48\u4F60\u8981\u6267\u884C\u4E0B\u9762\u4E24\u4E2A\u547D\u4EE4\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>cr upload <span class="token parameter variable">--owner</span> <span class="token operator">&lt;</span>owner<span class="token operator">&gt;</span> --git-repo <span class="token operator">&lt;</span>repo_name<span class="token operator">&gt;</span> --packages-with-index <span class="token parameter variable">--token</span> <span class="token operator">&lt;</span>token<span class="token operator">&gt;</span> <span class="token parameter variable">--push</span> --skip-existing

cr index <span class="token parameter variable">--owner</span> <span class="token operator">&lt;</span>owner<span class="token operator">&gt;</span> --git-repo <span class="token operator">&lt;</span>repo_name<span class="token operator">&gt;</span>  --packages-with-index --index-path <span class="token builtin class-name">.</span> <span class="token parameter variable">--token</span> <span class="token operator">&lt;</span>token<span class="token operator">&gt;</span> <span class="token parameter variable">--push</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4F60\u5E94\u8BE5\u5728\u4F60\u7684github-pages\u5206\u652F\u7684\u6839\u76EE\u5F55\u4E2D\u83B7\u5F97\u4F60\u7684\u56FE\u8868\u548C <code>.tgz</code> \u7684\u7248\u672C\u3002</p><p>\u4F7F\u7528\u5F15\u7528\u6BCF\u4E2A\u56FE\u8868\u548C\u8FD9\u4E9B\u56FE\u8868\u7684\u6BCF\u4E2A\u4E0D\u540C\u7248\u672C\u7684 <code>index.yaml</code> \uFF1A</p><h3 id="\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E" aria-hidden="true">#</a> \u914D\u7F6E</h3><p><code>cr</code> \u662F\u4E00\u4E2A\u547D\u4EE4\u884C\u5E94\u7528\u3002\u6240\u6709\u547D\u4EE4\u884C\u6807\u5FD7\u4E5F\u53EF\u4EE5\u901A\u8FC7\u73AF\u5883\u53D8\u91CF\u6216\u914D\u7F6E\u6587\u4EF6\u8BBE\u7F6E\u3002\u73AF\u5883\u53D8\u91CF\u5FC5\u987B\u4EE5 <code>CR_</code> \u4E3A\u524D\u7F00\u3002\u5FC5\u987B\u4F7F\u7528\u4E0B\u5212\u7EBF\u800C\u4E0D\u662F\u8FDE\u5B57\u7B26\u3002</p><p>CLI\u6807\u5FD7\u3001\u73AF\u5883\u53D8\u91CF\u548C\u914D\u7F6E\u6587\u4EF6\u53EF\u4EE5\u6DF7\u5408\u4F7F\u7528\u3002\u4EE5\u4E0B\u4F18\u5148\u987A\u5E8F\u9002\u7528\uFF1A</p><ol><li>CLI\u6807\u5FD7</li><li>\u73AF\u5883\u53D8\u91CF</li><li>Config\u6587\u4EF6</li></ol><h3 id="examples" tabindex="-1"><a class="header-anchor" href="#examples" aria-hidden="true">#</a> Examples</h3><p>\u4E0B\u9762\u7684\u793A\u4F8B\u663E\u793A\u4E86\u914D\u7F6E\u540C\u4E00\u4E8B\u7269\u7684\u5404\u79CD\u65B9\u6CD5\uFF1A</p><h4 id="cli" tabindex="-1"><a class="header-anchor" href="#cli" aria-hidden="true">#</a> CLI</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>cr upload <span class="token parameter variable">--owner</span> myaccount --git-repo helm-charts --package-path .deploy <span class="token parameter variable">--token</span> <span class="token number">123456789</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="\u73AF\u5883\u53D8\u91CF" tabindex="-1"><a class="header-anchor" href="#\u73AF\u5883\u53D8\u91CF" aria-hidden="true">#</a> \u73AF\u5883\u53D8\u91CF</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">CR_OWNER</span><span class="token operator">=</span>myaccount
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CR_GIT_REPO</span><span class="token operator">=</span>helm-charts
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CR_PACKAGE_PATH</span><span class="token operator">=</span>.deploy
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CR_TOKEN</span><span class="token operator">=</span><span class="token string">&quot;123456789&quot;</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CR_GIT_BASE_URL</span><span class="token operator">=</span><span class="token string">&quot;https://api.github.com/&quot;</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CR_GIT_UPLOAD_URL</span><span class="token operator">=</span><span class="token string">&quot;https://uploads.github.com/&quot;</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CR_SKIP_EXISTING</span><span class="token operator">=</span>true

cr upload
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>--package-path string</code> is Path to directory with chart packages (default <code>.cr-release-packages</code>)</p><h4 id="config\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#config\u6587\u4EF6" aria-hidden="true">#</a> Config\u6587\u4EF6</h4><p><code>config.yaml</code>:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>owner: myaccount
git-repo: helm-charts
package-path: .deploy
token: <span class="token number">123456789</span>
git-base-url: https://api.github.com/
git-upload-url: https://uploads.github.com/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u914D\u7F6E\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E\u4F7F\u7528" aria-hidden="true">#</a> \u914D\u7F6E\u4F7F\u7528</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>cr upload <span class="token parameter variable">--config</span> config.yaml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>cr</code> \u652F\u6301Viper\u53EF\u4EE5\u8BFB\u53D6\u7684\u4EFB\u4F55\u683C\u5F0F\u3002e. JSON\u3001TOML\u3001YAML\u3001HCL\u548CJava\u5C5E\u6027\u6587\u4EF6\u3002</p><p>\u8BF7\u6CE8\u610F\uFF0C\u5982\u679C\u6CA1\u6709\u6307\u5B9A\u914D\u7F6E\u6587\u4EF6\uFF0C\u5219\u4ECE\u5F53\u524D\u76EE\u5F55\u52A0\u8F7D <code>cr.yaml</code> \uFF08\u6216\u4EFB\u4F55\u652F\u6301\u7684\u683C\u5F0F\uFF09\uFF0C\u5982\u679C\u627E\u5230\uFF0C\u5219\u6309\u6B64\u987A\u5E8F\u52A0\u8F7D <code>$HOME/.cr</code> \u6216 <code>/etc/cr</code> \u3002</p><h2 id="ct" tabindex="-1"><a class="header-anchor" href="#ct" aria-hidden="true">#</a> CT</h2><p><code>ct</code> \u662F\u6D4B\u8BD5Helm Charts\u7684\u5DE5\u5177\u3002\u5B83\u65E8\u5728\u7528\u4E8Elinting\u548C\u6D4B\u8BD5pull\u8BF7\u6C42\u3002\u5B83\u81EA\u52A8\u68C0\u6D4B\u9488\u5BF9\u76EE\u6807\u5206\u652F\u66F4\u6539\u7684\u56FE\u8868\u3002</p><h3 id="\u5B89\u88C5-1" tabindex="-1"><a class="header-anchor" href="#\u5B89\u88C5-1" aria-hidden="true">#</a> \u5B89\u88C5</h3><p>\u5EFA\u8BAE\u4F7F\u7528\u63D0\u4F9B\u7684Docker\u955C\u50CF\uFF0C\u8BE5\u955C\u50CF\u53EF\u4EE5\u5728Quay\u4E0A\u627E\u5230\u3002\u5B83\u914D\u5907\u4E86\u6240\u6709\u5FC5\u8981\u7684\u5DE5\u5177\u5B89\u88C5\u3002</p><h3 id="\u4E0A\u624B" tabindex="-1"><a class="header-anchor" href="#\u4E0A\u624B" aria-hidden="true">#</a> \u4E0A\u624B</h3><p>\u4E0B\u9762\u7684\u4F8B\u5B50\u663E\u793A\u4E86\u914D\u7F6E\u540C\u4E00\u4EF6\u4E8B\u7684\u5404\u79CD\u65B9\u6CD5\uFF1A</p><p><strong>With remote repo:</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>ct <span class="token function">install</span> <span class="token parameter variable">--remote</span> upstream --chart-dirs stable,incubator --build-id pr-42
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>\u672C\u5730\u56DE\u8D2D</strong>:</p><p>\u5982\u679C\u60A8\u5728\u5F53\u524D\u76EE\u5F55\u4E2D\u6709\u4E00\u4E2A\u56FE\u8868\uFF0C\u5E76\u4E14ct\u5B89\u88C5\u5728\u4E3B\u673A\u4E0A\uFF0C\u90A3\u4E48\u60A8\u53EF\u4EE5\u8FD0\u884C\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>ct install --chart-dirs . --charts .
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4F7F\u7528Docker\u65F6\uFF0C\u5B83\u53EF\u4EE5\u4F7F\u7528\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token parameter variable">--network</span> <span class="token function">host</span> <span class="token parameter variable">--workdir</span><span class="token operator">=</span>/data <span class="token parameter variable">--volume</span> ~/.kube/config:/root/.kube/config:ro <span class="token parameter variable">--volume</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>:/data quay.io/helmpack/chart-testing:v3.7.1 ct <span class="token function">install</span> --chart-dirs <span class="token builtin class-name">.</span> <span class="token parameter variable">--charts</span> <span class="token builtin class-name">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8BF7\u6CE8\u610F\uFF0C <code>workdir</code> param\u5F88\u91CD\u8981\uFF0C\u5FC5\u987B\u4E0E\u6302\u8F7D\u7684\u5377\u76F8\u540C\u3002</p><h4 id="\u73AF\u5883\u53D8\u91CF-1" tabindex="-1"><a class="header-anchor" href="#\u73AF\u5883\u53D8\u91CF-1" aria-hidden="true">#</a> \u73AF\u5883\u53D8\u91CF</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">CT_REMOTE</span><span class="token operator">=</span>upstream
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CT_CHART_DIRS</span><span class="token operator">=</span>stable,incubator
<span class="token builtin class-name">export</span> CT_BUILD_ID

ct <span class="token function">install</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="config\u6587\u4EF6-1" tabindex="-1"><a class="header-anchor" href="#config\u6587\u4EF6-1" aria-hidden="true">#</a> Config\u6587\u4EF6</h4><p><code>config.yaml</code>:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>remote: upstream
chart-dirs:
  - stable
  - incubator
build-id: pr-42
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u914D\u7F6E\u4F7F\u7528-1" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E\u4F7F\u7528-1" aria-hidden="true">#</a> \u914D\u7F6E\u4F7F\u7528</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>ct <span class="token function">install</span> <span class="token parameter variable">--config</span> config.yaml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>ct</code> \u652F\u6301Viper\u53EF\u4EE5\u8BFB\u53D6\u7684\u4EFB\u4F55\u683C\u5F0F\u3002e. JSON\u3001TOML\u3001YAML\u3001HCL\u548CJava\u5C5E\u6027\u6587\u4EF6\u3002</p><p>\u8BF7\u6CE8\u610F\uFF0C\u5982\u679C\u6CA1\u6709\u6307\u5B9A\u914D\u7F6E\u6587\u4EF6\uFF0C\u5219\u4ECE\u5F53\u524D\u76EE\u5F55\u52A0\u8F7D <code>ct.yaml</code> \uFF08\u6216\u4EFB\u4F55\u652F\u6301\u7684\u683C\u5F0F\uFF09\uFF0C\u5982\u679C\u627E\u5230\uFF0C\u5219\u6309\u6B64\u987A\u5E8F\u52A0\u8F7D <code>$HOME/.ct</code> \u6216 <code>/etc/ct</code> \u3002</p><h4 id="\u4F7F\u7528\u79C1\u6709\u56FE\u8868\u5B58\u50A8\u5E93" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528\u79C1\u6709\u56FE\u8868\u5B58\u50A8\u5E93" aria-hidden="true">#</a> \u4F7F\u7528\u79C1\u6709\u56FE\u8868\u5B58\u50A8\u5E93</h4><p>\u5728\u6DFB\u52A0chart-repos\u65F6\uFF0C\u60A8\u53EF\u4EE5\u5728\u6BCF\u4E2Arepo\u7684\u57FA\u7840\u4E0A\u4F7F\u7528 <code>helm-repo-extra-args</code> \u4E3A <code>helm repo add</code> \u547D\u4EE4\u6307\u5B9A\u5176\u4ED6\u53C2\u6570\u3002\u60A8\u8FD8\u53EF\u4EE5\u6307\u5B9AOCI\u6CE8\u518C\u8868\uFF0C\u8FD9\u4E9B\u6CE8\u518C\u8868\u5C06\u4F7F\u7528 <code>helm registry login</code> \u547D\u4EE4\u6DFB\u52A0\uFF0C\u5B83\u4EEC\u4E5F\u652F\u6301 <code>helm-repo-extra-args</code> \u8FDB\u884C\u8EAB\u4EFD\u9A8C\u8BC1\u3002\u4F8B\u5982\uFF0C\u8FD9\u53EF\u4EE5\u7528\u4E8E\u9A8C\u8BC1\u79C1\u6709\u56FE\u8868\u5B58\u50A8\u5E93\u3002</p><p><code>config.yaml</code>:</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">chart-repos</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> incubator=https<span class="token punctuation">:</span>//incubator.io
  <span class="token punctuation">-</span> basic<span class="token punctuation">-</span>auth=https<span class="token punctuation">:</span>//private.com
  <span class="token punctuation">-</span> ssl<span class="token punctuation">-</span>repo=https<span class="token punctuation">:</span>//self<span class="token punctuation">-</span>signed.ca
  <span class="token punctuation">-</span> oci<span class="token punctuation">-</span>registry=oci<span class="token punctuation">:</span>//nice<span class="token punctuation">-</span>oci<span class="token punctuation">-</span>registry.pt
<span class="token key atrule">helm-repo-extra-args</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> ssl<span class="token punctuation">-</span>repo=<span class="token punctuation">-</span><span class="token punctuation">-</span>ca<span class="token punctuation">-</span>file ./my<span class="token punctuation">-</span>ca.crt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>ct <span class="token function">install</span> <span class="token parameter variable">--config</span> config.yaml --helm-repo-extra-args <span class="token string">&quot;basic-auth=--username user --password secret&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="openim-helm-charts-\u7684-cicd-\u8BBE\u8BA1" tabindex="-1"><a class="header-anchor" href="#openim-helm-charts-\u7684-cicd-\u8BBE\u8BA1" aria-hidden="true">#</a> OpenIM Helm Charts \u7684 CICD \u8BBE\u8BA1</h2><p>OpenIM \u7684 CICD \u8BBE\u8BA1\u4F7F\u7528\u4E86\u4E0A\u7EED\u7684 ct \u548C cr \u7684\u5DE5\u5177\uFF0C\u76EE\u5F55\u8BBE\u8BA1\u4E3B\u8981\u662F\u4E09\u4E2A\u90E8\u5206\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>+ .github/config/ <span class="token comment"># \u5B58\u653E\u914D\u7F6E\u6587\u4EF6 \u5305\u62EC ct \u548C cr \u7684\u914D\u7F6E\u6587\u4EF6</span>
+ scripts/ <span class="token comment"># \u5B58\u653E\u672C\u5730\u548C\u5176\u4ED6\u7684\u81EA\u52A8\u5316\u811A\u672C</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,88),l=[t];function p(c,r){return s(),n("div",null,l)}const d=a(i,[["render",p],["__file","163.html.vue"]]);export{d as default};
