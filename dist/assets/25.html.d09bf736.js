import{_ as d,r as i,o as l,c,a as n,b as s,w as r,e,d as o}from"./app.74e47ba8.js";const p={},u={href:"http://nsddd.top",target:"_blank",rel:"noopener noreferrer"},h=e("author"),b=n("h1",{id:"\u7B2C25\u8282-buildah-podman-\u4EE5\u53CA\u5728-rootless-\u6A21\u5F0F\u4E0B\u5DE5\u4F5C\u539F\u7406",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u7B2C25\u8282-buildah-podman-\u4EE5\u53CA\u5728-rootless-\u6A21\u5F0F\u4E0B\u5DE5\u4F5C\u539F\u7406","aria-hidden":"true"},"#"),e(" \u7B2C25\u8282 Buildah / podman \u4EE5\u53CA\u5728 rootless \u6A21\u5F0F\u4E0B\u5DE5\u4F5C\u539F\u7406")],-1),m=n("div",null,[n("a",{href:"24.md",style:{float:"left"}},"\u2B06\uFE0F\u4E0A\u4E00\u8282\u{1F517} "),n("a",{href:"26.md",style:{float:"right"}}," \u2B07\uFE0F\u4E0B\u4E00\u8282\u{1F517}")],-1),v=n("br",null,null,-1),g=e("\u2764\uFE0F\u{1F495}\u{1F495}\u8BB0\u5F55"),k={href:"https://github.com/3293172751/sealos",target:"_blank",rel:"noopener noreferrer"},_=e("sealos"),f=e("\u5F00\u6E90\u9879\u76EE\u7684\u5B66\u4E60\u8FC7\u7A0B\u3002"),x={href:"https://github.com/3293172751/sealos",target:"_blank",rel:"noopener noreferrer"},D=e("k8s,docker\u548C\u4E91\u539F\u751F\u7684\u5B66\u4E60"),I=e("\u3002Myblog:"),y={href:"http://nsddd.top/",target:"_blank",rel:"noopener noreferrer"},B=e("http://nsddd.top"),P=n("hr",null,null,-1),w=n("p",null,"[TOC]",-1),E=n("h2",{id:"\u4EC0\u4E48\u662F-buildah",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u4EC0\u4E48\u662F-buildah","aria-hidden":"true"},"#"),e(" \u4EC0\u4E48\u662F Buildah")],-1),U={href:"https://buildah.io/",target:"_blank",rel:"noopener noreferrer"},$=e("buildah \u5B98\u65B9"),O=e("Buildah \u662F\u4E00\u6B3E\u57FA\u4E8E Linux \u7684\u5F00\u6E90\u5DE5\u5177\uFF0C\u7528\u4E8E\u6784\u5EFA\u517C\u5BB9\u5F00\u53D1\u5BB9\u5668\u8BA1\u5212\uFF08OCI\uFF09\u7684"),C={href:"https://www.redhat.com/zh/topics/containers/whats-a-linux-container",target:"_blank",rel:"noopener noreferrer"},q=e("\u5BB9\u5668"),R=e("\uFF1B\u8FD9\u610F\u5473\u7740\uFF0C\u8FD9\u4E9B\u5BB9\u5668\u540C\u6837\u4E5F\u4E0E "),A={href:"https://www.redhat.com/zh/topics/containers/what-is-docker",target:"_blank",rel:"noopener noreferrer"},S=e("Docker"),L=e(" \u548C "),N={href:"https://www.redhat.com/zh/topics/containers/what-is-kubernetes",target:"_blank",rel:"noopener noreferrer"},G=e("Kubernetes"),F=e(" \u517C\u5BB9\u3002\u501F\u52A9 Buildah\uFF0C\u60A8\u53EF\u4EE5\u4F7F\u7528\u719F\u6089\u7684\u5DE5\u5177\u4ECE\u73B0\u6709\u57FA\u7840\u955C\u50CF\u521B\u5EFA\u9AD8\u6548\u7684\u5BB9\u5668\u955C\u50CF\uFF0C\u6216\u8005\u4F7F\u7528\u7A7A\u767D\u955C\u50CF\u4ECE\u5934\u5F00\u59CB\u6784\u5EFA\u3002"),M=o('<p>Buildah\u662F\u4E00\u4E2A\u5F00\u6E90\u7684\u547D\u4EE4\u884C\u5DE5\u5177\uFF0C\u7528\u4E8E\u6784\u5EFA\u3001\u521B\u5EFA\u548C\u7BA1\u7406 Docker \u955C\u50CF\u3002\u5B83\u53EF\u4EE5\u5E2E\u52A9\u7528\u6237\u521B\u5EFA\u955C\u50CF\uFF0C\u5E76\u4E0D\u4F9D\u8D56\u4E8E Docker \u5F15\u64CE\uFF0C\u800C\u662F\u76F4\u63A5\u4F7F\u7528\u5BB9\u5668\u7CFB\u7EDF\u548C\u683C\u5F0F\u3002</p><p>Buildah \u7684\u5E94\u7528\u573A\u666F\u5305\u62EC\uFF1A</p><ol><li>\u5F00\u53D1\u4EBA\u5458\u548C DevOps \u5DE5\u7A0B\u5E08\u53EF\u4EE5\u4F7F\u7528 Buildah \u5728\u4E0D\u4F7F\u7528 Docker \u5F15\u64CE\u7684\u60C5\u51B5\u4E0B\u5FEB\u901F\u521B\u5EFA\u955C\u50CF\u3002</li><li>Buildah \u53EF\u4EE5\u5728\u4E0D\u9700\u8981\u7F51\u7EDC\u8FDE\u63A5\u7684\u60C5\u51B5\u4E0B\u8FDB\u884C\u672C\u5730\u955C\u50CF\u6784\u5EFA\uFF0C\u8FD9\u5BF9\u4E8E\u6CA1\u6709\u7F51\u7EDC\u8FDE\u63A5\u7684\u73AF\u5883\u5F88\u6709\u7528\u3002</li><li>Buildah \u53EF\u4EE5\u65B9\u4FBF\u5730\u4E0E\u5176\u4ED6\u5BB9\u5668\u7CFB\u7EDF\u7ED3\u5408\u4F7F\u7528\uFF0C\u5982 Podman\uFF0C\u4EE5\u5B9E\u73B0\u7EDF\u4E00\u7684\u5BB9\u5668\u7BA1\u7406\u3002</li><li>Buildah \u53EF\u4EE5\u901A\u8FC7\u811A\u672C\u8FDB\u884C\u6279\u91CF\u6784\u5EFA\uFF0C\u4ECE\u800C\u63D0\u9AD8\u955C\u50CF\u6784\u5EFA\u6548\u7387\u3002</li></ol><p>\u8FD9\u6B3E\u547D\u4EE4\u884C\u5DE5\u5177\u6709\u4EE5\u4E0B\u7279\u70B9\uFF1A</p><ul><li>\u5728\u6784\u5EFA\u5BB9\u5668\u65F6\u53EF\u4EE5\u4F7F\u7528\u6216\u4E0D\u4F7F\u7528 Dockerfile\uFF08\u4E00\u79CD\u6587\u672C\u6587\u4EF6\uFF0C\u542B\u6709\u7528\u6237\u5728\u7EC4\u88C5\u955C\u50CF\u65F6\u53EF\u4EE5\u8C03\u7528\u7684\u6240\u6709\u547D\u4EE4\uFF09\u3002</li><li>\u65E2\u53EF\u4EE5\u4ECE\u5934\u5F00\u59CB\u521B\u5EFA\u5BB9\u5668\u955C\u50CF\uFF0C\u4E5F\u53EF\u4EE5\u5728\u73B0\u6709\u5BB9\u5668\u955C\u50CF\u7684\u57FA\u7840\u4E0A\u6765\u521B\u5EFA\u3002</li><li>\u4E0D\u5728\u955C\u50CF\u672C\u8EAB\u4E2D\u5305\u542B\u6784\u5EFA\u5DE5\u5177\uFF0C\u4E0D\u4EC5\u53EF\u4EE5\u7F29\u51CF\u6240\u6784\u5EFA\u955C\u50CF\u7684\u5927\u5C0F\uFF0C\u63D0\u5347\u5B89\u5168\uFF0C\u800C\u4E14\u4F1A\u56E0\u4E3A\u4F7F\u7528\u66F4\u5C11\u7684\u8D44\u6E90\u800C\u51CF\u8F7B\u4F20\u8F93\u8D1F\u62C5\u3002</li><li>\u4E0E Dockerfile \u517C\u5BB9\uFF0C\u4ECE\u800C\u80FD\u4ECE Docker \u8F7B\u677E\u8F6C\u6362\u3002</li><li>\u521B\u5EFA\u7279\u5B9A\u4E8E\u7528\u6237\u7684\u955C\u50CF\uFF0C\u56E0\u6B64\u80FD\u591F\u6309\u7167\u521B\u5EFA\u955C\u50CF\u7684\u4EBA\u6765\u5206\u95E8\u522B\u7C7B\u3002</li></ul><h3 id="\u4E3A\u4EC0\u4E48\u9009\u62E9buildah" tabindex="-1"><a class="header-anchor" href="#\u4E3A\u4EC0\u4E48\u9009\u62E9buildah" aria-hidden="true">#</a> \u4E3A\u4EC0\u4E48\u9009\u62E9Buildah</h3><p>Buildah \u53EF\u4EE5\u5E26\u6765\u51FA\u4F17\u7684\u7075\u6D3B\u6027\uFF0C\u8BA9\u60A8\u65E0\u9700 Dockerfile \u5C31\u80FD\u6784\u5EFA\u955C\u50CF\uFF0C\u66F4\u8F7B\u677E\u5730\u5C06\u5176\u4ED6\u811A\u672C\u8BED\u8A00\u6574\u5408\u8FDB\u6784\u5EFA\u8FC7\u7A0B\uFF1B\u4E5F\u80FD\u517C\u987E\u6548\u7387\uFF0C\u4F7F\u7528\u955C\u50CF\u5916\u7684\u6784\u5EFA\u5DE5\u5177\u6765\u521B\u5EFA\u955C\u50CF\u3002\u56E0\u6B64\uFF0C\u8FD9\u6B3E\u5DE5\u5177\u4E0D\u4EC5\u80FD\u591F\u52A0\u5FEB\u521B\u65B0\u901F\u5EA6\uFF0C\u8FD8\u80FD\u8BA9\u65B0\u7684\u6982\u5FF5\u5316\u4E3A\u73B0\u5B9E\u3002\u7528\u6237\u53EF\u4EE5\u5FEB\u901F\u521B\u5EFA\u5BB9\u5668\u955C\u50CF\u5E76\u4EE5\u4E4B\u4E3A\u57FA\u7840\u8FDB\u884C\u6784\u5EFA\uFF0C\u53EA\u9700\u5FC5\u8981\u7684\u5DE5\u5177\u548C\u6D41\u7A0B\u6765\u51C6\u5907\u5C31\u7EEA\u548C\u8FD0\u884C\u4FBF\u53EF\u3002</p><p>Buildah \u8FD8\u80FD\u63D0\u4F9B\u4EE5\u4E0B\u52A9\u529B\uFF1A</p><ul><li>\u68C0\u67E5\u3001\u9A8C\u8BC1\u548C\u4FEE\u6539\u955C\u50CF</li><li>\u5C06\u5BB9\u5668\u548C\u955C\u50CF\u4ECE\u672C\u5730\u5B58\u50A8\u63A8\u9001\u5230\u516C\u5171\u6216\u79C1\u6709\u7684\u955C\u50CF\u4ED3\u5E93\u6216\u5B58\u50A8\u5E93</li><li>\u5C06\u955C\u50CF\u63A8\u9001\u5230 Docker Hub \u6216\u4ECE\u4E2D\u63D0\u53D6</li><li>\u79FB\u9664\u672C\u5730\u5B58\u50A8\u7684\u5BB9\u5668\u955C\u50CF</li><li>\u6302\u8F7D\u6216\u5378\u8F7D\u6709\u6548\u5BB9\u5668\u7684\u6839\u6587\u4EF6\u7CFB\u7EDF</li><li>\u5C06\u5BB9\u5668\u6839\u6587\u4EF6\u7CFB\u7EDF\u7684\u66F4\u65B0\u5185\u5BB9\u7528\u4F5C\u65B0\u955C\u50CF\u7684\u6587\u4EF6\u7CFB\u7EDF\u5C42</li></ul><h3 id="podman" tabindex="-1"><a class="header-anchor" href="#podman" aria-hidden="true">#</a> Podman</h3><p>Podman \u662F\u4E00\u4E2A\u5F00\u6E90\u7684\u547D\u4EE4\u884C\u5DE5\u5177\uFF0C\u7528\u4E8E\u7BA1\u7406\u5BB9\u5668\u3002\u5B83\u53EF\u4EE5\u8FD0\u884C\u3001\u521B\u5EFA\u3001\u5220\u9664\u548C\u7BA1\u7406\u5BB9\u5668\uFF0C\u5E76\u4E14\u4E0D\u9700\u8981\u4EFB\u4F55\u5B88\u62A4\u8FDB\u7A0B\u3002Podman \u4F7F\u7528\u4E86\u5BB9\u5668\u7CFB\u7EDF\u548C\u683C\u5F0F\uFF0C\u5E76\u4E14\u4E0D\u4F9D\u8D56\u4E8E Docker \u5F15\u64CE\u3002</p><p><strong>Podman \u7684\u4E3B\u8981\u529F\u80FD\u5305\u62EC\uFF1A</strong></p><ol><li>\u5BB9\u5668\u8FD0\u884C\uFF1APodman \u53EF\u4EE5\u8FD0\u884C\u5BB9\u5668\uFF0C\u5E76\u4E14\u652F\u6301\u5728\u5BB9\u5668\u5185\u6267\u884C\u547D\u4EE4\u3002</li><li>\u5BB9\u5668\u521B\u5EFA\uFF1APodman \u53EF\u4EE5\u4ECE\u955C\u50CF\u521B\u5EFA\u5BB9\u5668\uFF0C\u5E76\u4E14\u652F\u6301\u5BF9\u5BB9\u5668\u8FDB\u884C\u914D\u7F6E\u3002</li><li>\u5BB9\u5668\u7BA1\u7406\uFF1APodman \u53EF\u4EE5\u7BA1\u7406\u5BB9\u5668\uFF0C\u5305\u62EC\u67E5\u8BE2\u5BB9\u5668\u72B6\u6001\u3001\u542F\u52A8\u548C\u505C\u6B62\u5BB9\u5668\u7B49\u3002</li><li>\u955C\u50CF\u7BA1\u7406\uFF1APodman \u53EF\u4EE5\u7BA1\u7406\u955C\u50CF\uFF0C\u5305\u62EC\u62C9\u53D6\u955C\u50CF\u3001\u67E5\u8BE2\u955C\u50CF\u4FE1\u606F\u3001\u5220\u9664\u955C\u50CF\u7B49\u3002</li></ol><p><strong>Podman \u7684\u4F7F\u7528\u573A\u666F\u5305\u62EC\uFF1A</strong></p><ol><li>\u7528\u4E8E\u5F00\u53D1\u3001\u6D4B\u8BD5\u548C\u90E8\u7F72\u5BB9\u5668\u5316\u5E94\u7528\u3002</li><li>\u7528\u4E8E\u5728\u672C\u5730\u8FDB\u884C\u5BB9\u5668\u7BA1\u7406\uFF0C\u4E0D\u9700\u8981\u7F51\u7EDC\u8FDE\u63A5\u3002</li><li>\u7528\u4E8E\u5B9E\u73B0\u5BF9\u5BB9\u5668\u7684\u7B80\u5355\u7BA1\u7406\uFF0C\u5E76\u4E14\u4E0D\u9700\u8981\u4F7F\u7528 Docker \u5F15\u64CE\u3002</li></ol><h3 id="buildah-and-podman" tabindex="-1"><a class="header-anchor" href="#buildah-and-podman" aria-hidden="true">#</a> Buildah and Podman</h3>',16),T=e("Buildah \u548C "),H={href:"https://www.redhat.com/zh/topics/containers/what-is-Podman",target:"_blank",rel:"noopener noreferrer"},j=e("Podman"),V=e(' \u662F\u76F8\u8F85\u76F8\u6210\u7684\u5F00\u6E90\u9879\u76EE\u548C\u547D\u4EE4\u884C\u5DE5\u5177\uFF0C\u90FD\u53EF\u64CD\u4F5C\u548C\u6784\u5EFA OCI \u955C\u50CF\u548C\u5BB9\u5668\u3002Buildah \u8BDE\u751F\u5728\u524D\uFF0C\u800C Podman \u4F7F\u7528\u4E86\u4E0E Buildah \u76F8\u540C\u7684\u4EE3\u7801\u6765\u8FDB\u884C\u6784\u5EFA\u3002\u4E0D\u8FC7\uFF0C\u76F8\u8F83\u4E8E Podman\uFF0CBuildah \u7684\u547D\u4EE4\u8981\u7EC6\u81F4\u5F97\u591A\uFF0C\u80FD\u591F\u5BF9\u955C\u50CF\u8FDB\u884C\u66F4\u7CBE\u7EC6\u7684\u63A7\u5236\uFF0C\u5E76\u53EF\u521B\u5EFA\u66F4\u52A0\u7EC6\u5316\u7684\u955C\u50CF\u5C42\u3002Podman \u7684"build"\u547D\u4EE4\u4F7F\u7528 Buildah \u529F\u80FD\u7684\u4E00\u4E2A\u5B50\u96C6\u3002'),z=n("p",null,"Buildah \u4E13\u95E8\u7528\u4E8E\u6784\u5EFA\u5BB9\u5668\u955C\u50CF\uFF0C\u590D\u5236 Dockerfile \u4E2D\u9664\u5B88\u62A4\u8FDB\u7A0B\u5957\u63A5\u5B57\u7EC4\u4EF6\u4E4B\u5916\u7684\u6240\u6709\u547D\u4EE4\uFF0C\u800C Podman \u5219\u64C5\u957F\u7EF4\u62A4\u548C\u4FEE\u6539\u5BB9\u5668\u4E2D\u955C\u50CF\u6240\u9700\u7684\u5DE5\u4F5C\u3002\u4F7F\u7528 Podman \u65F6\uFF0C\u60A8\u53EF\u4EE5\u521B\u5EFA\u5BB9\u5668\uFF08\u4F7F\u7528 Buildah \u6765\u63D0\u4F9B\u5BB9\u5668\u955C\u50CF\uFF09\uFF0C\u7136\u540E\u5728\u751F\u4EA7\u73AF\u5883\u4E2D\u4F7F\u7528\u719F\u6089\u7684\u547D\u4EE4\u884C\u63A5\u53E3\uFF08CLI\uFF09\u547D\u4EE4\u6765\u8FD0\u884C\u3001\u7EF4\u62A4\u548C\u4FEE\u6539\u60A8\u521B\u5EFA\u7684\u5BB9\u5668\uFF08\u5982\u679C\u60A8\u80FD\u591F\u5728 Docker CLI \u4E2D\u8FD0\u884C\u67D0\u4E2A\u547D\u4EE4\uFF0C\u90A3\u4E48\u4E5F\u80FD\u5728 Podman CLI \u4E2D\u8FD0\u884C\u540C\u6837\u7684\u547D\u4EE4\uFF09\u3002",-1),J=n("p",null,"Podman \u548C Buildah \u4E24\u8005\u7684\u53E6\u4E00\u533A\u522B\u5728\u4E8E\uFF1ABuildah \u7684\u5BB9\u5668\u4E3B\u8981\u662F\u4E3A\u4E34\u65F6\u76EE\u7684\u800C\u521B\u5EFA\u7684\uFF0C\u4EE5\u4FBF\u5C06\u5185\u5BB9\u4F20\u8F93\u5230\u6240\u521B\u5EFA\u7684\u5BB9\u5668\u955C\u50CF\uFF1B\u800C\u4F7F\u7528 Podman \u65F6\uFF0C\u7528\u6237\u521B\u5EFA\u7684\u662F\u5C06\u8981\u5728\u66F4\u957F\u65F6\u95F4\u91CC\u4F7F\u7528\u548C\u7EF4\u62A4\u7684\u4F20\u7EDF\u5BB9\u5668\u3002Buildah \u7684\u5BB9\u5668\u4E3B\u8981\u6EE1\u8DB3\u77ED\u671F\u7528\u9014\uFF0C\u800C Podman \u7684\u5BB9\u5668\u5219\u662F\u4E3A\u957F\u671F\u8FD0\u884C\u800C\u751F\u3002",-1),X=n("p",null,"\u8FD8\u6709\u4E00\u70B9\uFF0CBuildah \u548C Podman \u4E0D\u5171\u4EAB\u5BB9\u5668\u7684\u5185\u90E8\u8868\u8FF0\u5185\u5BB9\uFF0C\u56E0\u6B64\u4E00\u4E2A\u5BB9\u5668\u53EA\u80FD\u5728\u5176\u4E2D\u4E00\u4E2A\u5DE5\u5177\u5185\u770B\u5230\u3002\u4E0D\u8FC7\uFF0C\u4E24\u8005\u5374\u4F1A\u5171\u4EAB\u5BB9\u5668\u955C\u50CF\u7684\u5185\u90E8\u8868\u8FF0\u5185\u5BB9\uFF0C\u5728\u5176\u4E2D\u4E00\u8005\u521B\u5EFA\u3001\u4FEE\u6539\u6216\u63D0\u53D6\u7684\u5BB9\u5668\u955C\u50CF\u4E5F\u53EF\u5728\u53E6\u4E00\u8005\u67E5\u770B\u548C\u4F7F\u7528\u3002",-1),K=n("p",null,[n("strong",null,"\u5B98\u65B9\u8BF4\u6CD5\uFF1A")],-1),Y=e("Buildah \u548C Podman \u662F\u4E24\u4E2A\u4E92\u8865\u7684\u5F00\u6E90\u9879\u76EE\uFF0C\u53EF\u5728\u5927\u591A\u6570 Linux \u5E73\u53F0\u4E0A\u4F7F\u7528\uFF0C\u8FD9\u4E24\u4E2A\u9879\u76EE\u90FD\u4F4D\u4E8E "),Z={href:"https://github.com/",target:"_blank",rel:"noopener noreferrer"},W=e("GitHub.com"),Q=e("\u4E0A\uFF0C "),nn={href:"https://github.com/containers/buildah",target:"_blank",rel:"noopener noreferrer"},en=e("\u6B64\u5904\u4E3A Buildah"),sn=e("\uFF0C "),an={href:"https://github.com/containers/podman",target:"_blank",rel:"noopener noreferrer"},on=e("\u6B64\u5904\u4E3APodman"),tn=e(" \u3002Buildah \u548C Podman \u90FD\u662F\u547D\u4EE4\u884C\u5DE5\u5177\uFF0C\u9002\u7528\u4E8E\u5F00\u653E\u5BB9\u5668\u8BA1\u5212 (OCI) \u56FE\u50CF\u548C\u5BB9\u5668\u3002\u8FD9\u4E24\u4E2A\u9879\u76EE\u5728\u4E13\u4E1A\u4E0A\u6709\u6240\u4E0D\u540C\u3002"),dn=o("<p>Buildah \u4E13\u6CE8\u4E8E\u6784\u5EFA OCI \u56FE\u50CF\u3002Buildah \u7684\u547D\u4EE4\u590D\u5236\u4E86 Dockerfile \u4E2D\u7684\u6240\u6709\u547D\u4EE4\u3002\u8FD9\u5141\u8BB8\u5728\u4E0D\u9700\u8981\u4EFB\u4F55 root \u6743\u9650\u7684\u60C5\u51B5\u4E0B\u4F7F\u7528\u548C\u4E0D\u4F7F\u7528 Dockerfile \u6784\u5EFA\u56FE\u50CF\u3002Buildah \u7684\u6700\u7EC8\u76EE\u6807\u662F\u63D0\u4F9B\u4E00\u4E2A\u8F83\u4F4E\u7EA7\u522B\u7684 coreutils \u63A5\u53E3\u6765\u6784\u5EFA\u56FE\u50CF\u3002\u5728\u6CA1\u6709 Dockerfiles \u7684\u60C5\u51B5\u4E0B\u6784\u5EFA\u56FE\u50CF\u7684\u7075\u6D3B\u6027\u5141\u8BB8\u5C06\u5176\u4ED6\u811A\u672C\u8BED\u8A00\u96C6\u6210\u5230\u6784\u5EFA\u8FC7\u7A0B\u4E2D\u3002Buildah \u9075\u5FAA\u7B80\u5355\u7684 fork-exec \u6A21\u578B\uFF0C\u4E0D\u4F5C\u4E3A\u5B88\u62A4\u8FDB\u7A0B\u8FD0\u884C\uFF0C\u4F46\u5B83\u57FA\u4E8E golang \u4E2D\u7684\u7EFC\u5408 API\uFF0C\u53EF\u4EE5\u4F9B\u5E94\u7ED9\u5176\u4ED6\u5DE5\u5177\u3002</p><p>Podman \u4E13\u6CE8\u4E8E\u5E2E\u52A9\u60A8\u7EF4\u62A4\u548C\u4FEE\u6539 OCI \u955C\u50CF\u7684\u6240\u6709\u547D\u4EE4\u548C\u529F\u80FD\uFF0C\u4F8B\u5982\u62C9\u53D6\u548C\u6807\u8BB0\u3002\u5B83\u8FD8\u5141\u8BB8\u60A8\u521B\u5EFA\u3001\u8FD0\u884C\u548C\u7EF4\u62A4\u4ECE\u8FD9\u4E9B\u56FE\u50CF\u521B\u5EFA\u7684\u90A3\u4E9B\u5BB9\u5668\u3002\u4E3A\u4E86\u901A\u8FC7 Dockerfiles \u6784\u5EFA\u5BB9\u5668\u955C\u50CF\uFF0CPodman \u4F7F\u7528 Buildah \u7684 golang API\uFF0C\u5E76\u4E14\u53EF\u4EE5\u72EC\u7ACB\u4E8E Buildah \u5B89\u88C5\u3002</p><p><strong>Podman \u548C Buildah \u4E4B\u95F4\u7684\u4E3B\u8981\u533A\u522B\u5728\u4E8E\u5B83\u4EEC\u7684\u5BB9\u5668\u6982\u5FF5</strong>\u3002Podman \u5141\u8BB8\u7528\u6237\u521B\u5EFA\u201C\u4F20\u7EDF\u5BB9\u5668\u201D\uFF0C\u8FD9\u4E9B\u5BB9\u5668\u7684\u76EE\u7684\u662F\u957F\u671F\u5B58\u5728\u3002\u867D\u7136 Buildah \u5BB9\u5668\u5B9E\u9645\u4E0A\u53EA\u662F\u4E3A\u4E86\u5141\u8BB8\u5C06\u5185\u5BB9\u6DFB\u52A0\u56DE\u5BB9\u5668\u955C\u50CF\u800C\u521B\u5EFA\u7684\u3002\u4E00\u79CD\u7B80\u5355\u7684\u7406\u89E3\u65B9\u5F0F \uFF1A</p><ul><li><code>buildah run</code>\u662F\u547D\u4EE4\u6A21\u62DF <code>Dockerfile</code> \u4E2D\u7684 <code>RUN</code> \u547D\u4EE4\uFF0C</li><li><code>podman run</code> \u547D\u4EE4\u6A21\u62DF<code>docker run</code>\u529F\u80FD\u4E2D\u7684\u547D\u4EE4\u3002</li></ul><p>\u26A0\uFE0F \u7531\u4E8E\u8FD9\u4E00\u70B9\u4EE5\u53CA\u5B83\u4EEC\u7684\u5E95\u5C42\u5B58\u50A8\u5DEE\u5F02\uFF0C\u60A8\u65E0\u6CD5\u4ECE Buildah \u4E2D\u770B\u5230 Podman \u5BB9\u5668\uFF0C\u53CD\u4E4B\u4EA6\u7136\u3002</p>",5),ln=e("\u7B80\u800C\u8A00\u4E4B\uFF0CBuildah \u662F\u4E00\u79CD\u521B\u5EFA OCI \u955C\u50CF\u7684\u9AD8\u6548\u65B9\u5F0F\uFF0C\u800C Podman \u5141\u8BB8\u60A8\u4F7F\u7528\u719F\u6089\u7684\u5BB9\u5668 CLI \u547D\u4EE4\u5728\u751F\u4EA7\u73AF\u5883\u4E2D\u7BA1\u7406\u548C\u7EF4\u62A4\u8FD9\u4E9B\u955C\u50CF\u548C\u5BB9\u5668\u3002\u6709\u5173\u8BE6\u7EC6\u4FE1\u606F\uFF0C\u8BF7\u53C2\u9605\u300A "),cn={href:"https://github.com/containers/buildah/tree/main/docs/containertools",target:"_blank",rel:"noopener noreferrer"},rn=e("\u5BB9\u5668\u5DE5\u5177\u6307\u5357\u300B"),pn=e("\u3002"),un=o('<blockquote><p>Buildah \u9879\u76EE\u63D0\u4F9B\u4E86\u4E00\u4E2A\u547D\u4EE4\u884C\u5DE5\u5177\uFF0C\u53EF\u7528\u4E8E\u521B\u5EFA OCI \u6216\u4F20\u7EDF Docker \u955C\u50CF\u683C\u5F0F\u7684\u955C\u50CF\uFF0C\u7136\u540E\u4ECE\u8BE5\u955C\u50CF\u6784\u5EFA\u5DE5\u4F5C\u5BB9\u5668\u3002</p><p>\u53EF\u4EE5\u6302\u8F7D\u548C\u4FEE\u6539\u5BB9\u5668\uFF0C\u7136\u540E\u53EF\u4EE5\u6839\u636E\u66F4\u65B0\u540E\u7684\u5BB9\u5668\u4FDD\u5B58\u955C\u50CF\u3002</p></blockquote><p><strong>\u9879\u76EE\u4E4B\u95F4\u7684\u4E00\u4E9B\u547D\u4EE4\u91CD\u53E0</strong>\uFF1A</p><ul><li>\u6784\u5EFA <code>podman build</code> \u548C <code>buildah build</code> \u547D\u4EE4\u6709\u5F88\u5927\u7684\u91CD\u53E0\uFF0C\u56E0\u4E3A Podman \u4ECE Buildah \u501F\u7528\u4E86\u5927\u91CF\u7684 <code>podman build</code> \u5B9E\u73B0\u3002</li><li>\u8FD0\u884C <code>buildah run</code> \u548C <code>podman run</code> \u547D\u4EE4\u76F8\u4F3C\u4F46\u4E0D\u540C\u3002\u5982\u4E0A\u6240\u8FF0\uFF0CPodman \u548C Buildah \u5177\u6709\u4E0D\u540C\u7684\u5BB9\u5668\u6982\u5FF5\u3002\u4E00\u79CD\u7B80\u5355\u7684\u7406\u89E3\u65B9\u5F0F\u662F <code>buildah run</code> \u547D\u4EE4\u6A21\u62DF Dockerfile \u4E2D\u7684 RUN \u547D\u4EE4\uFF0C\u800C <code>podman run</code> \u547D\u4EE4\u6A21\u62DF\u529F\u80FD\u4E2D\u7684 <code>docker run</code> \u547D\u4EE4\u3002\u7531\u4E8E Buildah \u548C Podman \u7684\u5BB9\u5668\u6982\u5FF5\u6709\u4E9B\u4E0D\u540C\uFF0C\u60A8\u65E0\u6CD5\u4ECE Buildah \u4E2D\u770B\u5230 Podman \u5BB9\u5668\uFF0C\u53CD\u4E4B\u4EA6\u7136\u3002</li><li>pull, push \u8FD9\u4E9B\u547D\u4EE4\u5728\u4E24\u8005\u4E4B\u95F4\u57FA\u672C\u76F8\u540C\uFF0C\u90FD\u53EF\u4EE5\u4F7F\u7528\u3002</li><li>\u7531\u4E8E <code>containers</code> \u7684\u4E0D\u540C\uFF0Ccommit Commit \u7684\u5DE5\u4F5C\u65B9\u5F0F\u4E0D\u540C\u3002\u60A8\u4E0D\u80FD\u4ECE Buildah \u63D0\u4EA4 Podman \u5BB9\u5668\uFF0C\u4E5F\u4E0D\u80FD\u4ECE Podman \u63D0\u4EA4 Buildah \u5BB9\u5668\u3002</li><li>tag, rmi, images \u8FD9\u4E9B\u547D\u4EE4\u5728\u4E24\u8005\u4E4B\u95F4\u57FA\u672C\u76F8\u540C\uFF0C\u90FD\u53EF\u4EE5\u4F7F\u7528\u3002</li><li>rm \u8FD9\u6761\u547D\u4EE4\u8868\u9762\u4E0A\u770B\u8D77\u6765\u662F\u7B49\u4EF7\u7684\uFF0C\u4F46\u662F\u7531\u4E8E\u4E24\u4E2A\u9879\u76EE\u7684\u5BB9\u5668\u5E95\u5C42\u5B58\u50A8\u7684\u4E0D\u540C\uFF0C\u5B83\u4EEC\u662F\u4E0D\u540C\u7684\u3002\uFF08\u9274\u4E8E\u6B64\uFF0C\u65E0\u6CD5\u4F7F\u7528 Podman \u547D\u4EE4\u5220\u9664 Buildah \u5BB9\u5668\uFF0C\u4E5F\u65E0\u6CD5\u4F7F\u7528 Buildah \u547D\u4EE4\u5220\u9664 Podman \u5BB9\u5668\u3002)</li><li>mount \u4E24\u8005\u7684\u6302\u8F7D\u547D\u4EE4\u76F8\u4F3C\uFF0C\u60A8\u53EF\u4EE5\u6302\u8F7D\u5BB9\u5668\u955C\u50CF\u5E76\u4FEE\u6539\u5176\u4E2D\u7684\u5185\u5BB9\uFF0C\u8FD9\u4E9B\u5185\u5BB9\u5C06\u5728\u60A8\u63D0\u4EA4\u65F6\u4FDD\u5B58\u5230\u955C\u50CF\u4E2D\u3002</li></ul><p><strong>\u8BC4\u4EF7\uFF1A</strong></p><p>Podman \u548C Docker \u662F\u4E24\u4E2A\u7528\u4E8E\u7BA1\u7406\u5BB9\u5668\u7684\u5DE5\u5177\uFF0C\u5B83\u4EEC\u90FD\u5177\u6709\u9AD8\u5EA6\u7684\u4E92\u64CD\u4F5C\u6027\u3002Podman \u53EF\u4EE5\u4EE3\u66FF\u90E8\u5206 Docker \u7684\u529F\u80FD\uFF0C\u5E76\u4E14\u5728\u4E00\u4E9B\u65B9\u9762\u5177\u6709\u4F18\u52BF\uFF0C<strong>\u26A0\uFE0F \u4F8B\u5982\u4E0D\u9700\u8981\u8FD0\u884C\u4E3A root\uFF08docker\u73B0\u5728\u4E5F\u4E0D\u9700\u8981\u4E86\uFF09</strong>\u3002</p><p>\u7136\u800C\uFF0CDocker \u76EE\u524D\u4ECD\u7136\u662F\u5BB9\u5668\u751F\u6001\u7CFB\u7EDF\u4E2D\u6700\u5E7F\u6CDB\u4F7F\u7528\u7684\u5DE5\u5177\uFF0C\u5E76\u4E14\u62E5\u6709\u5927\u91CF\u7684\u751F\u6001\u7CFB\u7EDF\uFF0C\u5305\u62EC\u4E30\u5BCC\u7684\u955C\u50CF\u5E93\u548C\u63D2\u4EF6\u3002\u56E0\u6B64\uFF0C\u4F7F\u7528\u8005\u53EF\u4EE5\u6839\u636E\u81EA\u5DF1\u7684\u9700\u6C42\u548C\u559C\u597D\u9009\u62E9\u4F7F\u7528 Podman \u6216 Docker\u3002</p><p>\u7B80\u800C\u8A00\u4E4B\uFF0CBuildah \u662F\u4E00\u79CD\u521B\u5EFA OCI \u955C\u50CF\u7684\u6709\u6548\u65B9\u5F0F\uFF0C\u800C Podman \u5141\u8BB8\u60A8\u4F7F\u7528\u719F\u6089\u7684\u5BB9\u5668 cli \u547D\u4EE4\u5728\u751F\u4EA7\u73AF\u5883\u4E2D\u7BA1\u7406\u548C\u7EF4\u62A4\u8FD9\u4E9B\u955C\u50CF\u548C\u5BB9\u5668\u3002</p><p>\u603B\u7684\u6765\u8BF4\uFF0CPodman \u548C Docker \u90FD\u662F\u4F18\u79C0\u7684\u5BB9\u5668\u7BA1\u7406\u5DE5\u5177\uFF0C\u5177\u4F53\u9009\u62E9\u54EA\u79CD\u5DE5\u5177\u53D6\u51B3\u4E8E\u4F7F\u7528\u8005\u7684\u9700\u6C42\u548C\u559C\u597D\u3002</p><h3 id="podman-rootless" tabindex="-1"><a class="header-anchor" href="#podman-rootless" aria-hidden="true">#</a> podman rootless</h3><p>Podman \u53EF\u4EE5\u5728\u666E\u901A\u7528\u6237\u8EAB\u4EFD\u4E0B\u8FD0\u884C\uFF0C\u800C\u4E0D\u9700\u8981 root \u6743\u9650\u3002\u8FD9\u610F\u5473\u7740\uFF0C\u7528\u6237\u53EF\u4EE5\u5728\u81EA\u5DF1\u7684\u5E10\u6237\u4E0B\u7BA1\u7406\u5BB9\u5668\uFF0C\u800C\u4E0D\u9700\u8981\u4F7F\u7528\u7279\u6743\u6A21\u5F0F\u3002</p><p>\u8FD9\u662F\u56E0\u4E3A Podman \u4F7F\u7528\u4E86 user namespaces \u6765\u9694\u79BB\u5BB9\u5668\uFF0C\u4F7F\u5BB9\u5668\u5185\u7684\u8FDB\u7A0B\u5728\u7CFB\u7EDF\u5C42\u9762\u770B\u8D77\u6765\u50CF\u662F root\uFF0C\u4F46\u5B9E\u9645\u4E0A\u5E76\u4E0D\u5177\u6709 root \u6743\u9650\u3002\u8FD9\u4F7F\u5F97\u7528\u6237\u53EF\u4EE5\u5728\u4E0D\u63D0\u5347\u6743\u9650\u7684\u60C5\u51B5\u4E0B\u7BA1\u7406\u5BB9\u5668\uFF0C\u5E76\u4E14\u907F\u514D\u4E86\u67D0\u4E9B\u4E0E\u4F7F\u7528\u7279\u6743\u6A21\u5F0F\u76F8\u5173\u7684\u5B89\u5168\u98CE\u9669\u3002</p><p>\u56E0\u6B64\uFF0CPodman \u662F\u4E00\u4E2A\u66F4\u5B89\u5168\u7684\u5BB9\u5668\u7BA1\u7406\u5DE5\u5177\uFF0C\u7279\u522B\u662F\u5BF9\u4E8E\u90A3\u4E9B\u4E0D\u60F3\u4F7F\u7528\u7279\u6743\u6A21\u5F0F\u7684\u7528\u6237\u6765\u8BF4\u3002\u6B64\u5916\uFF0C\u4F7F\u7528 Podman \u53EF\u4EE5\u7B80\u5316\u5BB9\u5668\u7BA1\u7406\u7684\u6D41\u7A0B\uFF0C\u5E76\u4E14\u4E0D\u9700\u8981\u989D\u5916\u7684\u914D\u7F6E\uFF0C\u4ECE\u800C\u63D0\u9AD8\u751F\u4EA7\u6548\u7387\u3002</p><h2 id="builah-\u6559\u7A0B" tabindex="-1"><a class="header-anchor" href="#builah-\u6559\u7A0B" aria-hidden="true">#</a> builah \u6559\u7A0B</h2>',13),hn={href:"https://www.centos.org/",target:"_blank",rel:"noopener noreferrer"},bn=e("CentOS\uFF1A"),mn=o(`<p>Buildah is available in the default Extras repos for CentOS 7 and in the AppStream repo for CentOS 8 and Stream, however the available version often lags the upstream release.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo yum -y install buildah
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>\u9700\u8981\u6CE8\u610F\u7684\u662F\uFF0C\u4EE5 root \u8EAB\u4EFD\u8FD0\u884C\uFF0C\u56E0\u4E3A\u60A8\u9700\u8981\u4EE5 root \u8EAB\u4EFD\u624D\u80FD\u5B89\u88C5 Buildah \u8F6F\u4EF6\u5305\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token parameter variable">-s</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></blockquote><p><code>containers/image</code>\u9879\u76EE\u63D0\u4F9B\u4E86\u590D\u5236\uFF08\u63A8\u9001\u3001\u62C9\u53D6\uFF09\u3001\u68C0\u67E5\u548C\u7B7E\u7F72\u5BB9\u5668\u955C\u50CF\u7684\u673A\u5236\u3002\u8BE5<code>containers/storage</code>\u9879\u76EE\u63D0\u4F9B\u4E86\u7528\u4E8E\u5B58\u50A8\u6587\u4EF6\u7CFB\u7EDF\u5C42\u3001\u5BB9\u5668\u6620\u50CF\u548C\u5BB9\u5668\u7684\u673A\u5236\u3002Buildah \u662F\u4E00\u4E2A\u5229\u7528\u8FD9\u4E9B\u5E95\u5C42\u9879\u76EE\u7684 CLI\uFF0C\u56E0\u6B64\u5141\u8BB8\u60A8\u6784\u5EFA\u3001\u79FB\u52A8\u548C\u7BA1\u7406\u5BB9\u5668\u955C\u50CF\u548C\u5BB9\u5668\u3002</p>`,4),vn=e("Buildah \u9002\u7528\u4E8E\u8BB8\u591A Linux \u53D1\u884C\u7248\uFF0C\u4F46\u76EE\u524D\u5728 Windows \u6216 Mac \u5E73\u53F0\u4E0A\u4E0D\u53D7\u652F\u6301\u3002Buildah \u4E3B\u8981\u4E13\u6CE8\u4E8E\u6784\u5EFA OCI \u955C\u50CF\uFF0C\u800C"),gn={href:"https://podman.io/",target:"_blank",rel:"noopener noreferrer"},kn=e("Podman"),_n=e("\u63D0\u4F9B\u4E86\u66F4\u5E7F\u6CDB\u7684\u547D\u4EE4\u548C\u529F\u80FD\u96C6\uFF0C\u53EF\u5E2E\u52A9\u60A8\u7EF4\u62A4\u3001\u4FEE\u6539\u548C\u8FD0\u884C OCI \u955C\u50CF\u548C\u5BB9\u5668\u3002\u6709\u5173\u9879\u76EE\u4E4B\u95F4\u5DEE\u5F02\u7684\u66F4\u591A\u4FE1\u606F\uFF0C\u8BF7\u53C2\u9605\u4E3B README.md \u4E2D\u7684"),fn={href:"https://github.com/containers/buildah#buildah-and-podman-relationship",target:"_blank",rel:"noopener noreferrer"},xn=e("Buildah \u548C Podman \u5173\u7CFB"),Dn=e("\u90E8\u5206\u3002"),In=n("h3",{id:"rootless-user",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#rootless-user","aria-hidden":"true"},"#"),e(" rootless user")],-1),yn=e("\u5982\u679C\u60A8\u8BA1\u5212\u4EE5\u6CA1\u6709 root \u6743\u9650\u7684\u7528\u6237\u8EAB\u4EFD\u8FD0\u884C Buildah\uFF0C\u5373\u201C\u65E0\u6839\u7528\u6237\u201D\uFF0C\u7CFB\u7EDF\u7BA1\u7406\u5458\u53EF\u80FD\u9700\u8981\u4E8B\u5148\u505A\u4E00\u4E9B\u989D\u5916\u7684\u914D\u7F6E\u3002Podman GitHub \u7AD9\u70B9\u4E0A\u5217\u51FA\u4E86\u4E3A\u6B64\u6240\u9700\u7684"),Bn={href:"https://github.com/containers/podman/blob/main/docs/tutorials/rootless_tutorial.md",target:"_blank",rel:"noopener noreferrer"},Pn=e("\u8BBE\u7F6E"),wn=e("\u3002"),En=n("strong",null,"Buildah \u5177\u6709\u4E0E Podman \u5BF9\u65E0\u6839\u7528\u6237\u76F8\u540C\u7684\u8BBE\u7F6E\u548C\u914D\u7F6E\u8981\u6C42\u3002",-1),Un={href:"https://github.com/containers/podman/blob/main/docs/tutorials/rootless_tutorial.md",target:"_blank",rel:"noopener noreferrer"},$n=e("podman rootless user"),On=o(`<h3 id="\u5B89\u88C5\u540E\u9A8C\u8BC1" tabindex="-1"><a class="header-anchor" href="#\u5B89\u88C5\u540E\u9A8C\u8BC1" aria-hidden="true">#</a> \u5B89\u88C5\u540E\u9A8C\u8BC1</h3><p>\u5B89\u88C5 Buildah \u540E\u6211\u4EEC\u53EF\u4EE5\u770B\u5230\u6CA1\u6709\u5B89\u88C5\u56FE\u50CF\u3002\u8BE5<code>buildah images</code>\u547D\u4EE4\u5C06\u5217\u51FA\u6240\u6709\u56FE\u50CF\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>buildah images
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6211\u4EEC\u8FD8\u53EF\u4EE5\u8FD0\u884C\u770B\u5230\u6CA1\u6709\u5DE5\u4F5C\u5BB9\u5668\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>buildah containers
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5F53\u60A8\u4ECE\u73B0\u6709\u955C\u50CF\u6784\u5EFA\u5DE5\u4F5C\u5BB9\u5668\u65F6\uFF0CBuildah \u9ED8\u8BA4\u5C06\u201C-working-container\u201D\u9644\u52A0\u5230\u955C\u50CF\u540D\u79F0\u4EE5\u6784\u5EFA\u5BB9\u5668\u540D\u79F0\u3002Buildah CLI \u53EF\u4EE5\u65B9\u4FBF\u5730\u8FD4\u56DE\u65B0\u5BB9\u5668\u7684\u540D\u79F0\u3002\u60A8\u53EF\u4EE5\u901A\u8FC7\u4F7F\u7528\u6807\u51C6 shell \u5206\u914D\u5C06\u8FD4\u56DE\u503C\u5206\u914D\u7ED9 shell \u53D8\u91CF\u6765\u5229\u7528\u8FD9\u4E00\u70B9\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>container=$(buildah from fedora)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4E0D\u9700\u8981\u5C06\u5BB9\u5668\u7684\u540D\u79F0\u5206\u914D\u7ED9 shell \u53D8\u91CF\u3002\u8FD0\u884C <code>buildah from fedora</code>\u5C31\u591F\u4E86\u3002\u5B83\u53EA\u662F\u6709\u52A9\u4E8E\u4EE5\u540E\u7B80\u5316\u547D\u4EE4\u3002\u8981\u67E5\u770B\u6211\u4EEC\u5B58\u50A8\u5728 shell \u53D8\u91CF\u4E2D\u7684\u5BB9\u5668\u7684\u540D\u79F0\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>echo $container
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6211\u4EEC\u53EF\u4EE5\u7528\u8FD9\u4E2A\u65B0\u5BB9\u5668\u505A\u4EC0\u4E48\uFF1F\u8BA9\u6211\u4EEC\u5C1D\u8BD5\u8FD0\u884C bash\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>buildah run $container bash
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,11),Cn=e("\u8BF7\u6CE8\u610F\uFF0C\u6211\u4EEC\u5F97\u5230\u4E86\u4E00\u4E2A\u65B0\u7684 shell \u63D0\u793A\u7B26\uFF0C\u56E0\u4E3A\u6211\u4EEC\u5728\u5BB9\u5668\u5185\u8FD0\u884C\u4E86\u4E00\u4E2A bash shell\u3002\u5E94\u8BE5\u6CE8\u610F\u7684"),qn=n("code",null,"buildah run",-1),Rn=e("\u662F\uFF0C\u5B83\u4E3B\u8981\u7528\u4E8E\u5728\u6784\u5EFA\u8FC7\u7A0B\u4E2D\u8C03\u8BD5\u548C\u8FD0\u884C\u547D\u4EE4\u3002\u50CF Podman \u8FD9\u6837\u529F\u80FD\u66F4\u5168\u7684\u5F15\u64CE\u6216\u50CF"),An={href:"https://github.com/kubernetes-sigs/cri-o",target:"_blank",rel:"noopener noreferrer"},Sn=e("CRI-O"),Ln=e("\u8FD9\u6837\u7684\u5BB9\u5668\u8FD0\u884C\u65F6\u63A5\u53E3\u670D\u52A1\u66F4\u9002\u5408\u5728\u751F\u4EA7\u73AF\u5883\u4E2D\u542F\u52A8\u5BB9\u5668\u3002"),Nn=o(`<p>\u4E00\u5B9A\u8981<code>exit</code>\u79BB\u5F00\u5BB9\u5668\uFF0C\u8BA9\u6211\u4EEC\u5C1D\u8BD5\u8FD0\u884C\u5176\u4ED6\u4E1C\u897F\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>buildah run $container java
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u54CE\u5440\u3002\u672A\u5B89\u88C5 Java\u3002\u8FD4\u56DE\u4E86\u4E00\u6761\u5305\u542B\u7C7B\u4F3C\u4EE5\u4E0B\u5185\u5BB9\u7684\u6D88\u606F\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>runc create failed: unable to start start container process: exec: &quot;java&quot;: executable file not found in $PATH
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8BA9\u6211\u4EEC\u5C1D\u8BD5\u4F7F\u7528\u4EE5\u4E0B\u65B9\u6CD5\u5C06\u5B83\u5B89\u88C5\u5728\u5BB9\u5668\u4E2D\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>buildah run $container -- dnf -y install java
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8BED\u6CD5\u57FA\u672C\u4E0A\u544A\u8BC9 Buildah\uFF1A\u5728\u8FD9\u4E00\u70B9\u4E4B\u540E<code>--</code>\u6CA1\u6709\u66F4\u591A\u7684\u547D\u4EE4\u9009\u9879\u3002<code>buildah run</code>\u6B64\u70B9\u4E4B\u540E\u7684\u9009\u9879\u7528\u4E8E\u5728\u5BB9\u5668\u5185\u542F\u52A8\u7684\u547D\u4EE4\u3002\u5982\u679C\u6211\u4EEC\u6307\u5B9A\u7684\u547D\u4EE4\u5305\u542B\u4E0D\u9002\u7528\u4E8E Buildah \u7684\u547D\u4EE4\u884C\u9009\u9879\uFF0C\u5219\u5B83\u662F\u5FC5\u9700\u7684\u3002</p><p>\u73B0\u5728\u8FD0\u884C<code>buildah run $container java</code>\u4F1A\u663E\u793A\u5DF2\u7ECF\u5B89\u88C5\u4E86Java\u3002\u5B83\u5C06\u8FD4\u56DE\u6807\u51C6 Java<code>Usage</code>\u8F93\u51FA\u3002</p><h3 id="\u4ECE-scratch-\u5F00\u59CB\u6784\u5EFA\u955C\u50CF" tabindex="-1"><a class="header-anchor" href="#\u4ECE-scratch-\u5F00\u59CB\u6784\u5EFA\u955C\u50CF" aria-hidden="true">#</a> \u4ECE scratch \u5F00\u59CB\u6784\u5EFA\u955C\u50CF</h3><p>\u4F7F\u7528\u6784\u5EFA OCI \u517C\u5BB9\u5BB9\u5668\u955C\u50CF\u7684\u4F18\u52BF\u4E4B\u4E00 <code>buildah</code> \u662F\u60A8\u53EF\u4EE5\u8F7B\u677E\u5730\u4ECE\u5934\u5F00\u59CB\u6784\u5EFA\u5BB9\u5668\u955C\u50CF\uFF0C\u4ECE\u800C\u4ECE\u955C\u50CF\u4E2D\u6392\u9664\u4E0D\u5FC5\u8981\u7684\u5305\u3002\u5927\u591A\u6570\u7528\u4E8E\u751F\u4EA7\u7684\u6700\u7EC8\u5BB9\u5668\u955C\u50CF\u53EF\u80FD\u4E0D\u9700\u8981\u50CF<code>dnf</code>.</p><p>\u8BA9\u6211\u4EEC\u4ECE\u5934\u5F00\u59CB\u6784\u5EFA\u4E00\u4E2A\u5BB9\u5668\u548C\u56FE\u50CF\u3002\u7279\u6B8A\u7684\u201C\u56FE\u50CF\u201D\u540D\u79F0\u201Cscratch\u201D\u544A\u8BC9 Buildah \u521B\u5EFA\u4E00\u4E2A\u7A7A\u5BB9\u5668\u3002\u5BB9\u5668\u6709\u5C11\u91CF\u5173\u4E8E\u5BB9\u5668\u7684\u5143\u6570\u636E\uFF0C\u4F46\u6CA1\u6709\u771F\u6B63\u7684 Linux \u5185\u5BB9\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">newcontainer</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>buildah from scratch<span class="token variable">)</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u60A8\u53EF\u4EE5\u901A\u8FC7\u8FD0\u884C\u4EE5\u4E0B\u547D\u4EE4\u6765\u67E5\u770B\u8FD9\u4E2A\u65B0\u7684\u7A7A\u5BB9\u5668\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>buildah containers
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u60A8\u5E94\u8BE5\u770B\u5230\u7C7B\u4F3C\u4E8E\u4EE5\u4E0B\u5185\u5BB9\u7684\u8F93\u51FA\uFF1A</p><p><img src="http://sm.nsddd.top/sm202302081630890.png" alt="image-20230208163025720"></p><p>\u5B83\u7684\u5BB9\u5668\u540D\u79F0\u9ED8\u8BA4\u4E3A working-container \u5E76\u4E14\u5B58\u50A8\u5728<code>$newcontainer</code>\u53D8\u91CF\u4E2D\u3002\u8BF7\u6CE8\u610F\u56FE\u50CF\u540D\u79F0 (IMAGE NAME) \u662F\u201Cscratch\u201D\u3002\u8FD9\u662F\u4E00\u4E2A\u7279\u6B8A\u503C\uFF0C\u8868\u793A\u5DE5\u4F5C\u5BB9\u5668\u4E0D\u662F\u57FA\u4E8E\u56FE\u50CF\u3002\u5F53\u6211\u4EEC\u8FD0\u884C\u65F6\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>buildah images
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6211\u4EEC\u6CA1\u6709\u770B\u5230\u5217\u51FA\u7684\u201Cscratch\u201D\u56FE\u50CF\u3002\u6CA1\u6709\u76F8\u5E94\u7684\u5212\u75D5\u56FE\u50CF\u3002\u57FA\u4E8E\u201Cscratch\u201D\u7684\u5BB9\u5668\u4ECE\u65E0\u5230\u6709\u3002</p><p>\u90A3\u4E48\u8FD9\u4E2A\u5BB9\u5668\u5B9E\u9645\u4E0A\u6709\u4EC0\u4E48\u4F5C\u7528\u5417\uFF1F\u8BA9\u6211\u4EEC\u6765\u770B\u770B\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>buildah run <span class="token variable">$newcontainer</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6CA1\u6709\u3002\u8FD9\u771F\u7684\u662F\u7A7A\u7684\u3002\u5305\u5B89\u88C5\u7A0B\u5E8F<code>dnf</code>\u751A\u81F3\u4E0D\u5728\u8FD9\u4E2A\u5BB9\u5668\u5185\u3002\u5B83\u672C\u8D28\u4E0A\u662F\u5185\u6838\u4E4B\u4E0A\u7684\u4E00\u4E2A\u7A7A\u5C42\u3002\u90A3\u4E48\u53EF\u4EE5\u7528\u5B83\u505A\u4EC0\u4E48\u5462\uFF1F\u5E78\u8FD0\u7684\u662F\u6709\u4E00\u4E2A<code>buildah mount</code>\u547D\u4EE4\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">scratchmnt</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>buildah <span class="token function">mount</span> $newcontainer<span class="token variable">)</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6CE8\u610F\uFF1A\u5982\u679C\u5C1D\u8BD5\u4EE5\u65E0\u6839\u6A21\u5F0F\u6302\u8F7D\uFF0C\u8BE5\u547D\u4EE4\u5C06\u5931\u8D25\u3002\u53EA\u80FD\u5728\u60A8\u62E5\u6709\u7684\u6302\u8F7D\u547D\u540D\u7A7A\u95F4\u4E2D\u6302\u8F7D\u5BB9\u5668\u3002\u901A\u8FC7\u6267\u884C<code>buildah unshare</code>\u547D\u4EE4\u521B\u5EFA\u5E76\u8FDB\u5165\u7528\u6237\u547D\u540D\u7A7A\u95F4\u548C\u6302\u8F7D\u547D\u540D\u7A7A\u95F4\u3002\u6709\u5173\u66F4\u591A\u4FE1\u606F\uFF0C\u8BF7\u53C2\u9605 buildah-mount(1) \u624B\u518C\u9875\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ buildah unshare
<span class="token comment"># scratchmnt=$(buildah mount $newcontainer)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u65E0\u7279\u6743\u6A21\u5F0F\uFF1A</strong></p><p>\u5982\u679C\u60A8\u5DF2\u5B89\u88C5 Podman \u5E76\u5C06\u5176\u8BBE\u7F6E\u4E3A\u5728\u65E0 root \u6743\u9650\u6A21\u5F0F\u4E0B\u4F7F\u7528\uFF0C\u5219\u65E0\u9700\u8FDB\u884C\u8FDB\u4E00\u6B65\u914D\u7F6E\uFF0C\u5C31\u80FD\u5728\u975E\u7279\u6743\u73AF\u5883\u4E2D\u4F7F\u7528 Buildah\u3002\u5982\u679C\u9700\u8981\u4E3A Buildah \u542F\u7528\u65E0 root \u6743\u9650\u6A21\u5F0F\uFF0C\u8BF7\u8FD0\u884C\u4EE5\u4E0B\u547D\u4EE4\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">usermod</span> --add-subuids <span class="token number">200000</span>-201000 --add-subgids <span class="token number">200000</span>-201000 <span class="token environment constant">$USER</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>\u4F7F\u7528 <code>sudo</code> \u4EE5\u8D85\u7EA7\u7528\u6237\u7684\u8EAB\u4EFD\u8FD0\u884C\u547D\u4EE4\uFF0C\u4EE5\u83B7\u5F97\u8DB3\u591F\u7684\u6743\u9650\u6765\u4FEE\u6539\u7528\u6237\u4FE1\u606F\u3002</li><li>\u4F7F\u7528 <code>usermod</code> \u547D\u4EE4\u4FEE\u6539\u7528\u6237\u4FE1\u606F\u3002</li><li>\u4F7F\u7528 <code>--add-subuids</code> \u9009\u9879\u5411\u7528\u6237\u6DFB\u52A0\u5B50\u7528\u6237 ID \u8303\u56F4\uFF0C\u4ECE 200000 \u5230 201000\u3002</li><li>\u4F7F\u7528 <code>--add-subgids</code> \u9009\u9879\u5411\u7528\u6237\u6DFB\u52A0\u5B50\u7528\u6237\u7EC4 ID \u8303\u56F4\uFF0C\u4ECE 200000 \u5230 201000\u3002</li><li>\u4F7F\u7528 <code>$USER</code> \u53D8\u91CF\u6307\u5B9A\u8981\u4FEE\u6539\u7684\u7528\u6237\u540D\u3002</li></ul><p>\u547D\u4EE4\u5C06\u4E3A\u5F53\u524D\u7528\u6237\u542F\u7528\u65E0 root \u6743\u9650\u6A21\u5F0F\u3002\u8FD0\u884C\u8BE5\u547D\u4EE4\u540E\uFF0C\u6CE8\u9500\u7136\u540E\u91CD\u65B0\u767B\u5F55\u5373\u53EF\u542F\u7528\u66F4\u6539\u3002</p><p>\u4EE5\u4E0A\u547D\u4EE4\u4F1A\u5728\u4E3B\u673A\u4E0A\u5B9A\u4E49\u4E00\u7CFB\u5217\u672C\u5730 UID\uFF0C\u5206\u914D\u7ED9\u5BB9\u5668\u4E2D\u7684\u7528\u6237\u7684 UID \u5C06\u6620\u5C04\u5230\u8FD9\u4E9B UID\u3002\u8BF7\u6CE8\u610F\uFF0C\u4E3A\u4E0D\u540C\u7528\u6237\u5B9A\u4E49\u7684\u8303\u56F4\u4E0D\u5F97\u91CD\u53E0\u3002\u540C\u6837\u91CD\u8981\u7684\u662F\uFF0C\u8FD9\u4E9B\u8303\u56F4\u4E0D\u80FD\u91CD\u590D\u4F7F\u7528\u4EFB\u4F55\u73B0\u6709\u672C\u5730\u7528\u6237\u6216\u7EC4\u7684 UID\u3002\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u5728 SLES 15 \u4E2D\u4F7F\u7528 <code>useradd</code> \u547D\u4EE4\u6DFB\u52A0\u7528\u6237\u4F1A\u81EA\u52A8\u5206\u914D subUID \u548C subGID \u8303\u56F4\u3002</p><p><strong>\u26A0\uFE0F \u5728\u65E0 root \u6743\u9650\u6A21\u5F0F\u4E0B\uFF0CBuildah \u547D\u4EE4\u5FC5\u987B\u5728\u7528\u6237\u7684\u5DF2\u4FEE\u6539\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u4E2D\u6267\u884C\u3002\u8981\u8FDB\u5165\u6B64\u7528\u6237\u540D\u79F0\u7A7A\u95F4\uFF0C\u8BF7\u8FD0\u884C <code>buildah unshare</code> \u547D\u4EE4\u3002\u5426\u5219 <code>buildah mount</code> \u547D\u4EE4\u5C06\u4F1A\u5931\u8D25\u3002</strong></p><hr><p><strong>\u5C1D\u8BD5\u8FD0\u884Cbash:</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">container</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>buildah from fedora<span class="token variable">)</span></span>  <span class="token comment"># \u662F os base image</span>

<span class="token builtin class-name">echo</span> <span class="token variable">$container</span> <span class="token comment"># \u8F93\u51FA\u8FD9\u4E2A\u955C\u50CF\u7684\u4FE1\u606F</span>

buildah run <span class="token variable">$container</span> <span class="token function">bash</span>  <span class="token comment"># \u8FD0\u884C\u8FD9\u4E2A\u955C\u50CF</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,35),Gn=e("\u901A\u8FC7\u56DE"),Fn=n("code",null,"$scratchmnt",-1),Mn=e("\u663E\u6211\u4EEC\u53EF\u4EE5\u770B\u5230"),Tn={href:"https://wiki.archlinux.org/index.php/Overlay_filesystem",target:"_blank",rel:"noopener noreferrer"},Hn=e("\u8986\u76D6\u6302\u8F7D\u70B9"),jn=e("\u7684\u8DEF\u5F84\uFF0C\u5B83\u88AB\u7528\u4F5C\u5BB9\u5668\u7684\u6839\u6587\u4EF6\u7CFB\u7EDF\u3002"),Vn=o(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># echo $scratchmnt</span>
/var/lib/containers/storage/overlay/b78d0e11957d15b5d1fe776293bd40a36c28825fb6cf76f407b4d0a95b2a200d/merged
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,1),zn=n("code",null,"/var/lib/containers/storage",-1),Jn=e("\u8BF7\u6CE8\u610F\uFF0C\u5982\u679C\u60A8\u4EE5 root \u8EAB\u4EFD\u5F00\u59CB\uFF0C\u8986\u76D6\u6302\u8F7D\u70B9\u4F4D\u4E8E\u4E0B\u9762\u7684\u67D0\u4E2A\u4F4D\u7F6E\uFF1B"),Xn=n("code",null,".local/share/containers/storage",-1),Kn=e("\u5982\u679C\u60A8\u5904\u4E8E\u65E0\u6839\u6A21\u5F0F\uFF0C\u5219\u8986\u76D6\u6302\u8F7D\u70B9\u4F4D\u4E8E\u60A8\u7684\u4E3B\u76EE\u5F55\u7684\u76EE\u5F55\u4E0B\u3002\uFF08\u53C2\u89C1\u4E0A\u6587"),Yn=n("code",null,"containers/storage",-1),Zn=e("\u6216\u6709\u5173\u66F4\u591A\u4FE1\u606F\uFF0C\u8BF7\u53C2\u89C1"),Wn={href:"https://github.com/containers/storage",target:"_blank",rel:"noopener noreferrer"},Qn=e("\u5BB9\u5668/\u5B58\u50A8"),ne=e("\u3002\uFF09"),ee=o(`<p>\u73B0\u5728\u6211\u4EEC\u6709\u4E86\u4E00\u4E2A\u65B0\u7684\u7A7A\u5BB9\u5668\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5B89\u88C5\u6216\u5220\u9664\u8F6F\u4EF6\u5305\u6216\u7B80\u5355\u5730\u5C06\u5185\u5BB9\u590D\u5236\u5230\u8BE5\u5BB9\u5668\u4E2D\u3002\u6240\u4EE5\u8BA9\u6211\u4EEC\u5B89\u88C5<code>bash</code>\uFF0C<code>coreutils</code>\u4EE5\u4FBF\u6211\u4EEC\u53EF\u4EE5\u8FD0\u884C bash \u811A\u672C\u3002\u8FD9\u5F88\u5BB9\u6613\u6210\u4E3A<code>nginx</code>\u60A8\u7684\u5BB9\u5668\u6240\u9700\u7684\u5176\u4ED6\u5305\u3002</p><p>**\u6CE8\u610F\uFF1A**\u4E0B\u9762\u793A\u4F8B\u4E2D\u7684\u7248\u672C (35) \u4E0E\u8FD0\u884C\u6B64\u793A\u4F8B\u7684 Linux \u5E73\u53F0 Fedora \u7248\u672C\u76F8\u5173\u3002\u5982\u679C\u60A8\u5728\u4E3B\u673A\u4E0A\u8FD0\u884C dnf \u6765\u586B\u5145\u5BB9\u5668\uFF0C\u60A8\u6307\u5B9A\u7684\u7248\u672C\u5FC5\u987B\u5BF9\u4E3B\u673A\u6709\u6548\uFF0C\u5426\u5219 dnf \u5C06\u629B\u51FA\u9519\u8BEF\u3002\u5373\u5982\u679C\u4F60\u8981\u5728 RHEL \u5E73\u53F0\u4E0A\u8FD0\u884C\u5B83\uFF0C\u4F60\u9700\u8981\u6307\u5B9A<code>--releasever 8.1</code>\u6216\u7C7B\u4F3C\u800C\u4E0D\u662F<code>--releasever 35</code>. \u5982\u679C\u60A8\u5E0C\u671B\u5BB9\u5668\u662F\u7279\u5B9A\u7684 Linux \u5E73\u53F0\uFF0C<code>scratch</code>\u8BF7\u5C06\u793A\u4F8B\u7684\u7B2C\u4E00\u884C\u66F4\u6539\u4E3A\u60A8\u60F3\u8981\u7684\u5E73\u53F0\uFF0C\u5373<code># newcontainer=$(buildah from fedora)</code>\uFF0C\u7136\u540E\u60A8\u53EF\u4EE5\u4E3A\u8BE5 Linux \u5E73\u53F0\u6307\u5B9A\u5408\u9002\u7684\u7248\u672C\u53F7\u3002</p><div class="language-ba ext-ba line-numbers-mode"><pre class="language-ba"><code># dnf install --installroot $scratchmnt --releasever 35 bash coreutils --setopt install_weak_deps=false -y
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="\u955C\u50CF" tabindex="-1"><a class="header-anchor" href="#\u955C\u50CF" aria-hidden="true">#</a> \u955C\u50CF</h3><p><strong>\u83B7\u53D6\u955C\u50CF\uFF1A</strong></p><p>\u6784\u5EFA\u5BB9\u5668\u955C\u50CF\u7684\u7B2C\u4E00\u6B65\u662F\u83B7\u53D6\u57FA\u7840\u955C\u50CF\uFF0C\u8FD9\u662F\u901A\u8FC7 Dockerfile \u4E2D\u7684 FROM \u8BED\u53E5\u5B8C\u6210\u7684\u3002Buildah \u4EE5\u7C7B\u4F3C\u7684\u65B9\u5F0F\u5904\u7406\u8FD9\u4E2A\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span><span class="token punctuation">]</span>$ <span class="token function">sudo</span> buildah from fedora
Getting image <span class="token builtin class-name">source</span> signatures
Copying blob 7778c55b9bda <span class="token keyword">done</span>
Copying config e0d7a1685f <span class="token keyword">done</span>
Writing manifest to image destination
Storing signatures
fedora-working-container
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,7),se=n("strong",null,"Fedora Linux",-1),ae=e("\uFF08\u7B2C\u4E03\u7248\u4EE5\u524D\u4E3A"),oe=n("strong",null,"Fedora Core",-1),ie=e("\uFF09\u662F\u8F83\u5177\u77E5\u540D\u5EA6\u7684"),te={href:"https://zh.wikipedia.org/wiki/Linux%E5%8F%91%E8%A1%8C%E5%A5%97%E4%BB%B6",target:"_blank",rel:"noopener noreferrer"},de=e("Linux\u53D1\u884C\u5305"),le=e("\u4E4B\u4E00\uFF0C\u7531"),ce={href:"https://zh.wikipedia.org/wiki/Fedora%E5%B0%88%E6%A1%88",target:"_blank",rel:"noopener noreferrer"},re=e("Fedora\u9879\u76EE"),pe=e("\u793E\u7FA4\u5F00\u53D1\u3001"),ue={href:"https://zh.wikipedia.org/wiki/%E7%B4%85%E5%B8%BD%E5%85%AC%E5%8F%B8",target:"_blank",rel:"noopener noreferrer"},he=e("\u7EA2\u5E3D\u516C\u53F8"),be=e("\u8D5E\u52A9\uFF0C\u76EE\u6807\u662F\u521B\u5EFA\u4E00\u5957\u65B0\u9896\u3001\u591A\u529F\u80FD\u5E76\u4E14\u81EA\u7531\uFF08"),me={href:"https://zh.wikipedia.org/zh-cn/%E9%96%8B%E6%94%BE%E5%8E%9F%E5%A7%8B%E7%A2%BC",target:"_blank",rel:"noopener noreferrer"},ve=e("\u5F00\u653E\u6E90\u4EE3\u7801"),ge=e("\uFF09\u7684\u64CD\u4F5C\u7CFB\u7EDF\u3002Fedora\u662F\u5546\u4E1A\u5316\u7684"),ke={href:"https://zh.wikipedia.org/wiki/Red_Hat_Enterprise_Linux",target:"_blank",rel:"noopener noreferrer"},_e=e("Red Hat Enterprise Linux"),fe=e("\u53D1\u884C\u7248\u7684"),xe={href:"https://zh.wikipedia.org/wiki/%E4%B8%8A%E6%B8%B8_(%E8%BB%9F%E9%AB%94%E9%96%8B%E7%99%BC)",target:"_blank",rel:"noopener noreferrer"},De=e("\u4E0A\u6E38"),Ie=e("\u6E90\u7801\u3002"),ye=o(`<p>\u8BE5\u547D\u4EE4\u5C06\u62C9\u53D6 Fedora \u7684\u57FA\u7840\u955C\u50CF\u5E76\u5B58\u50A8\u5728\u4E3B\u673A\u4E0A\u3002\u901A\u8FC7\u6267\u884C\u4EE5\u4E0B\u64CD\u4F5C\u53EF\u4EE5\u68C0\u67E5\u4E3B\u673A\u4E0A\u53EF\u7528\u7684\u955C\u50CF\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>~<span class="token punctuation">]</span>$ <span class="token function">sudo</span> buildah images
REPOSITORY                      TAG        IMAGE ID       CREATED        SIZE
docker.io/library/fedora        latest     e0d7a1685fed   <span class="token number">12</span> hours ago   <span class="token number">190</span> MB
docker.io/sealerio/kubernetes   v1.22.15   bb75382891e7   <span class="token number">4</span> weeks ago    <span class="token number">963</span> MB
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728\u62C9\u53D6\u57FA\u7840\u955C\u50CF\u540E\uFF0C\u6709\u4E00\u4E2A\u8BE5\u955C\u50CF\u7684\u8FD0\u884C\u5BB9\u5668\u5B9E\u4F8B\uFF0C\u8FD9\u662F\u4E00\u4E2A\u201C\u5DE5\u4F5C\u5BB9\u5668\u201D\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>~<span class="token punctuation">]</span>$ <span class="token function">sudo</span> buildah containers
CONTAINER ID  BUILDER  IMAGE ID     IMAGE NAME                       CONTAINER NAME
0e5b23a293db     *                  scratch                          working-container
883af373c2a5     *     e0d7a1685fed docker.io/library/fedora:latest  fedora-working-container
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Buildah \u8FD8\u63D0\u4F9B\u4E86\u4E00\u4E2A\u975E\u5E38\u6709\u7528\u7684\u547D\u4EE4\u6765\u505C\u6B62\u548C\u5220\u9664\u5F53\u524D\u6B63\u5728\u8FD0\u884C\u7684\u6240\u6709\u5BB9\u5668\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">sudo</span> buildah <span class="token function">rm</span> <span class="token parameter variable">--all</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="buildah-mount" tabindex="-1"><a class="header-anchor" href="#buildah-mount" aria-hidden="true">#</a> buildah mount</h3><p>buildah-mount - \u6302\u8F7D\u5DE5\u4F5C\u5BB9\u5668\u7684\u6839\u6587\u4EF6\u7CFB\u7EDF\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>buildah <span class="token function">mount</span> <span class="token punctuation">[</span>container <span class="token punctuation">..</span>.<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>\u63CF\u8FF0\uFF1A</strong></p><p>\u5C06\u6307\u5B9A\u5BB9\u5668\u7684\u6839\u6587\u4EF6\u7CFB\u7EDF\u6302\u8F7D\u5230\u53EF\u4ECE\u4E3B\u673A\u8BBF\u95EE\u7684\u4F4D\u7F6E\uFF0C\u5E76\u8FD4\u56DE\u5176\u4F4D\u7F6E\u3002</p><p><strong>\u5982\u679C\u5728\u6CA1\u6709\u4EFB\u4F55\u53C2\u6570\u7684\u60C5\u51B5\u4E0B\u8C03\u7528 mount \u547D\u4EE4\uFF0C\u8BE5\u5DE5\u5177\u5C06\u5217\u51FA\u6240\u6709\u5F53\u524D\u88C5\u8F7D\u7684\u5BB9\u5668\u3002</strong></p><p>\u5728\u65E0\u6839\u6A21\u5F0F\u4E0B\u8FD0\u884C\u65F6\uFF0C\u88C5\u8F7D\u5728\u4E0D\u540C\u7684\u547D\u540D\u7A7A\u95F4\u4E2D\u8FD0\u884C\uFF0C\u4EE5\u4FBF\u5728\u4F7F\u7528 <code>vfs</code> \u4EE5\u5916\u7684\u9A71\u52A8\u7A0B\u5E8F\u65F6\u53EF\u80FD\u65E0\u6CD5\u4ECE\u4E3B\u673A\u8BBF\u95EE\u88C5\u8F7D\u7684\u5377\u3002\u4E3A\u4E86\u80FD\u591F\u8BBF\u95EE\u6302\u8F7D\u7684\u6587\u4EF6\u7CFB\u7EDF\uFF0C\u60A8\u53EF\u80FD\u9700\u8981\u5355\u72EC\u521B\u5EFA\u6302\u8F7D\u547D\u540D\u7A7A\u95F4\u4F5C\u4E3A <code>buildah unshare</code> \u7684\u4E00\u90E8\u5206\u3002\u5728\u4F7F\u7528 <code>buildah unshare</code> \u521B\u5EFA\u7684\u73AF\u5883\u4E2D\uFF0C\u60A8\u53EF\u4EE5\u4F7F\u7528 <code>buildah mount</code> \u5E76\u8BBF\u95EE\u6302\u8F7D\u7684\u6587\u4EF6\u7CFB\u7EDF\u3002</p><p>\u5982\u679C\u5728\u65E0\u6839\u6A21\u5F0F\u4E0B\u8FD0\u884C\uFF0C\u5219\u9700\u8981\u5148\u6267\u884C buildah \u53D6\u6D88\u5171\u4EAB\u4EE5\u4F7F\u7528\u6302\u8F7D\u70B9\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ buildah unshare
<span class="token comment"># buildah mount working-container</span>
/var/lib/containers/storage/overlay/f8cac5cce73e5102ab321cc5b57c0824035b5cb82b6822e3c86ebaff69fefa9c/merged
<span class="token comment"># cp foobar  /var/lib/containers/storage/overlay/f8cac5cce73e5102ab321cc5b57c0824035b5cb82b6822e3c86ebaff69fefa9c/merged</span>
<span class="token comment"># buildah unmount working-container</span>
<span class="token comment"># exit</span>
$ buildah commit  working-container newimage
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="buildah-umount" tabindex="-1"><a class="header-anchor" href="#buildah-umount" aria-hidden="true">#</a> buildah umount</h3><p>buildah-umount - \u5378\u8F7D\u6307\u5B9A\u5DE5\u4F5C\u5BB9\u5668\u4E0A\u7684\u6839\u6587\u4EF6\u7CFB\u7EDF\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>buildah <span class="token function">umount</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span>container <span class="token punctuation">..</span>.<span class="token punctuation">]</span>

<span class="token comment"># options : --all, -a --\u5168\u90E8\uFF0C -a \u5C06\u5378\u8F7D\u6240\u6709\u5F53\u524D\u88C5\u8F7D\u7684\u5BB9\u5668\u3002</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u{1F4A1}\u7B80\u5355\u7684\u4E00\u4E2A\u6848\u4F8B\u5982\u4E0B\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>buildah <span class="token function">umount</span> containerID 
buildah <span class="token function">umount</span> containerID1 containerID2 containerID3
buildah <span class="token function">umount</span> <span class="token parameter variable">--all</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="buildah-unshare" tabindex="-1"><a class="header-anchor" href="#buildah-unshare" aria-hidden="true">#</a> buildah unshare</h3><p>buildah-unshare -\u5728\u4FEE\u6539\u7684\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u5185\u8FD0\u884C\u547D\u4EE4\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>buildah unshare <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token punctuation">]</span> <span class="token punctuation">[</span>command<span class="token punctuation">]</span> <span class="token comment"># [\u9009\u9879] [--] [\u547D\u4EE4]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5728\u65B0\u7528\u6237\u547D\u540D\u7A7A\u95F4\u4E2D\u542F\u52A8\u8FDB\u7A0B\uFF08\u9ED8\u8BA4\u4E3A <em><code>$SHELL</code></em> \uFF09\u3002\u914D\u7F6E\u7528\u6237\u540D\u79F0\u7A7A\u95F4\uFF0C\u4EE5\u4FBF\u8C03\u7528\u7528\u6237\u7684UID \u548C\u4E3B GID \u5206\u522B\u663E\u793A\u4E3A <code>UID 0</code> \u548C <code>GID 0</code> \u3002\u5728 <code>newuidmap</code>\uFF081\uFF09\u548C<code>newgidmap</code>\uFF081\uFF09\u5E2E\u52A9\u5668\u7684\u5E2E\u52A9\u4E0B\uFF0C<code>/etc/subuid</code>\u548C/etc/subgid\u4E2D\u4E0E\u8BE5\u7528\u6237\u548C\u7EC4\u5339\u914D\u7684\u4EFB\u4F55\u8303\u56F4\u4E5F\u4F1A\u88AB\u6620\u5C04\u4E3A\u5B83\u4EEC\u81EA\u5DF1\u3002</p><p><code>buildah unshare</code> \u5BF9\u4E8E\u6392\u9664\u975E\u7279\u6743\u64CD\u4F5C\u7684\u6545\u969C\u4EE5\u53CA\u624B\u52A8\u6E05\u9664\u4E0E\u6620\u50CF\u548C\u5BB9\u5668\u76F8\u5173\u7684\u5B58\u50A8\u548C\u5176\u4ED6\u6570\u636E\u975E\u5E38\u6709\u7528\u3002</p><p>\u5982\u679C\u8981\u4F7F\u7528 <code>buildah mount</code> \u547D\u4EE4\uFF0C\u6B64\u547D\u4EE4\u4E5F\u5F88\u6709\u7528\u3002\u5982\u679C\u4E00\u4E2A\u975E\u7279\u6743\u7528\u6237\u60F3\u8981\u6302\u8F7D\u548C\u4F7F\u7528\u4E00\u4E2A\u5BB9\u5668\uFF0C\u90A3\u4E48\u4ED6\u4EEC\u9700\u8981\u6267\u884C buildah unshare\u3002\u5BF9\u4E8E\u65E0\u6743\u9650\u7528\u6237\uFF0C\u6267\u884C <code>buildah mount</code> \u5C06\u5931\u8D25\uFF0C\u9664\u975E\u8BE5\u7528\u6237\u5728 <code>buildah unshare</code> \u4F1A\u8BDD\u4E2D\u8FD0\u884C\u3002</p><p><strong>\u53C2\u6570\u9009\u62E9\uFF1A</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>--mount, <span class="token parameter variable">-m</span> <span class="token punctuation">[</span>VARIABLE<span class="token operator">=</span><span class="token punctuation">]</span>containerNameOrID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5728\u8FD0\u884C\u547D\u4EE4\u65F6\u6302\u8F7D <code>containerNameOrID</code> \u5BB9\u5668\uFF0C\u5E76\u5C06\u73AF\u5883\u53D8\u91CFVARIABLE\u8BBE\u7F6E\u4E3A\u6302\u8F7D\u70B9\u7684\u8DEF\u5F84\u3002\u5982\u679C\u672A\u6307\u5B9A <code>VARIABLE</code>\uFF0C\u5219\u9ED8\u8BA4\u4E3AcontainerNameOrID\uFF0C\u8FD9\u53EF\u80FD\u4E0D\u662F\u73AF\u5883\u53D8\u91CF\u7684\u6709\u6548\u540D\u79F0\u3002</p><p><strong>\u{1F4A1}\u7B80\u5355\u7684\u4E00\u4E2A\u6848\u4F8B\u5982\u4E0B\uFF1A</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># mnt=$(buildah mount $ctr)</span>
<span class="token comment"># su sealer </span>
$ <span class="token assign-left variable">mnt</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>buildah <span class="token function">mount</span> $ctr<span class="token variable">)</span></span>
cannot <span class="token function">mount</span> using driver overlay <span class="token keyword">in</span> rootless mode. You need to run it <span class="token keyword">in</span> a <span class="token variable"><span class="token variable">\`</span>buildah unshare<span class="token variable">\`</span></span> session
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5982\u679C\u60A8\u8FD8\u6CA1\u6709\u6267\u884C\uFF0C\u95EE\u9898\u662F<code>mnt=$(buildah mount $ctr)</code>\u62D2\u7EDD\u4F7F\u7528\u8986\u76D6\u9A71\u52A8\u7A0B\u5E8F\u5B89\u88C5\u56FE\u50CF<code>buildah unshare</code>\u3002</p><p>\u5F53\u60A8\u5728\u65E0\u6839\u6A21\u5F0F\u4E0B\u6267\u884C<code>buildah</code>\u8BF8\u5982<code>bud</code>\u548C\u4E4B\u7C7B\u7684\u547D\u4EE4\u65F6\uFF0C\u8BE5\u547D\u4EE4\u4F1A\u8FDB\u5165\u7528\u6237\u548C\u6302\u8F7D\u547D\u540D\u7A7A\u95F4\u3002\u5B83\u53EF\u4EE5\u5F88\u597D\u5730\u6302\u8F7D\u5BB9\u5668\u6587\u4EF6\u7CFB\u7EDF\u5E76\u8FD0\u884C\u547D\u4EE4\u3002\u547D\u4EE4\u5B8C\u6210\u540E\u9000\u51FA\uFF0C\u5BFC\u81F4\u540D\u79F0\u7A7A\u95F4\u88AB\u9500\u6BC1\u3002\u4F7F\u7528\u547D\u4EE4\u6267\u884C\u6B64\u64CD\u4F5C\u65F6\uFF0C\u6302\u8F7D\u7684\u6587\u4EF6\u7CFB\u7EDF\u4ECE\u672A\u51FA\u73B0\u5728\u4E3B\u673A\u6302\u8F7D\u547D\u540D\u7A7A\u95F4\u4E2D\u3002</p><blockquote><p>Buildah\u73B0\u5728\u4F1A\u68C0\u67E5\u8FD9\u79CD\u60C5\u51B5\uFF0C\u5E76\u5411\u7528\u6237\u62A5\u544A\u4ED6\u4EEC\u5FC5\u987B\u9996\u5148\u53D1\u51FABuildah\u53D6\u6D88\u5171\u4EAB\u3002</p><p>Buildah now checks for this situation and reports to the user that they have to issue a <code>buildah unshare</code> first.</p></blockquote><p>Buildah \u6709\u4E00\u4E2A\u7279\u6B8A\u7684\u547D\u4EE4 <code>buildah unshare</code>\uFF0C\u5B83\u5141\u8BB8\u60A8\u8FDB\u5165\u7528\u6237\u547D\u540D\u7A7A\u95F4\u3002\u5982\u679C\u4F60\u4E0D\u4F7F\u7528\u4EFB\u4F55\u547D\u4EE4\u6267\u884C\u5B83\uFF0C\u5B83\u4F1A\u5728\u7528\u6237\u547D\u540D\u7A7A\u95F4\u4E2D\u542F\u52A8\u4E00\u4E2A shell\uFF0C\u4F60\u7684 shell \u770B\u8D77\u6765\u5C31\u50CF\u662F\u4EE5 root \u8EAB\u4EFD\u8FD0\u884C\u7684\uFF0C\u5E76\u4E14\u4E3B\u76EE\u5F55\u7684\u6240\u6709\u5185\u5BB9\u770B\u8D77\u6765\u90FD\u50CF\u662F root \u62E5\u6709\u7684\u3002</p><p>\u5982\u679C\u60A8\u67E5\u770B <code>/usr</code> \u4E2D\u7684\u6240\u6709\u8005\u6216\u6587\u4EF6\uFF0C\u5B83\u4F1A\u5C06\u5B83\u4EEC\u5217\u4E3A <code>nfsnobody</code>\uFF08\u6216\u6CA1\u6709\u4EBA\uFF09\u62E5\u6709\u3002\u8FD9\u662F\u56E0\u4E3A\u60A8\u7684\u7528\u6237 <code>ID (UID)</code> \u73B0\u5728\u662F\u7528\u6237\u547D\u540D\u7A7A\u95F4\u5185\u7684 <code>root</code>\uFF0C\u800C\u771F\u6B63\u7684 <code>root</code> (UID=0) \u672A\u6620\u5C04\u5230\u7528\u6237\u547D\u540D\u7A7A\u95F4\u3002\u5185\u6838\u5C06\u6240\u6709\u672A\u6620\u5C04\u5230\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u7684 UID \u6240\u62E5\u6709\u7684\u6587\u4EF6\u8868\u793A\u4E3A <code>NFSNOBODY</code> \u7528\u6237\u3002</p><p>\u5F53\u60A8\u9000\u51FA shell \u65F6\uFF0C\u60A8\u5C06\u9000\u51FA\u7528\u6237\u547D\u540D\u7A7A\u95F4\uFF0C\u60A8\u5C06\u56DE\u5230\u60A8\u7684\u6B63\u5E38 UID\uFF0C\u5E76\u4E14\u4E3B\u76EE\u5F55\u5C06\u518D\u6B21\u5F52\u60A8\u7684 UID \u6240\u6709\u3002</p><p><strong>example\uFF1A</strong></p><p><code>buildah unshare id buildah</code> \u53D6\u6D88\u5171\u4EABID</p><p><code>buildah unshare pwd buildah</code> \u53D6\u6D88\u5171\u4EAB\u5BC6\u7801</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>buildah unshare <span class="token function">cat</span> /proc/self/uid_map /proc/self/gid_map
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6784\u5EFA\u65F6\u53D6\u6D88 \u5171\u4EAB\u76EE\u5F55/\u8FDB\u7A0B/\u81EA\u8EAB/uid_map /\u8FDB\u7A0B/\u81EA\u8EAB/gid_map</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>buildah unshare <span class="token function">rm</span> <span class="token parameter variable">-fr</span> <span class="token environment constant">$HOME</span>/.local/share/containers/storage /run/user/<span class="token variable"><span class="token variable">\`</span><span class="token function">id</span> <span class="token parameter variable">-u</span><span class="token variable">\`</span></span>/run
buildah unshare <span class="token parameter variable">--mount</span> containerID <span class="token function">sh</span> <span class="token parameter variable">-c</span> <span class="token string">&#39;cat \${containerID}/etc/os-release&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5982\u679C\u4F60\u60F3\u4F7F\u7528buildah\u548Cmount\u547D\u4EE4\uFF0C\u90A3\u4E48\u4F60\u53EF\u4EE5\u521B\u5EFA\u4E00\u4E2A\u811A\u672C\uFF0C\u5982\u4E0B\u6240\u793A\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">cat</span> buildah-script.sh <span class="token operator">&lt;&lt;</span> <span class="token string">_EOF
#!/bin/sh
ctr=<span class="token variable"><span class="token variable">$(</span>buildah from scratch<span class="token variable">)</span></span>
mnt=<span class="token variable"><span class="token variable">$(</span>buildah <span class="token function">mount</span> $ctr<span class="token variable">)</span></span>
dnf -y install --installroot=<span class="token variable">$mnt</span> PACKAGES
dnf -y clean all --installroot=<span class="token variable">$mnt</span>
buildah config --entrypoint=&quot;/bin/PACKAGE&quot; --env &quot;FOO=BAR&quot; <span class="token variable">$ctr</span>
buildah commit <span class="token variable">$ctr</span> imagename
buildah unmount <span class="token variable">$ctr</span>
_EOF</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Then execute it with:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>buildah unshare buildah-script.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Buildah \u548C Podman \u6709\u4E00\u4E2A\u7279\u6B8A\u7684\u547D\u4EE4 \uFF1A <code>unshare</code> \u3002\u6B64\u547D\u4EE4\u5728\u4E0D\u521B\u5EFA\u5BB9\u5668\u6216\u4E0E\u5BB9\u5668\u4EA4\u4E92\u7684\u60C5\u51B5\u4E0B\u521B\u5EFA\u5E76\u8FDB\u5165\u7528\u6237\u547D\u540D\u7A7A\u95F4\u3002\u63A2\u7D22\u8FD9\u79CD\u6A21\u5F0F\u4EE5\u5145\u5206\u7406\u89E3\u7528\u6237\u547D\u540D\u7A7A\u95F4\u5728\u505A\u4EC0\u4E48\u5B9E\u9645\u4E0A\u662F\u76F8\u5F53\u6709\u8DA3\u7684\u3002\u6267\u884C <code>buildah unshare</code> \u547D\u4EE4\u5C06\u5728\u7528\u6237\u547D\u540D\u7A7A\u95F4\u4E2D\u4EE5 root \u8EAB\u4EFD\u8FD0\u884C\u7684\u547D\u540D\u7A7A\u95F4\u4E2D\u8FD0\u884C shell \u547D\u4EE4\u3002\u73B0\u5728\u60A8\u53EF\u4EE5\u8FD0\u884C\u4EFB\u4F55\u547D\u4EE4\uFF0C\u5305\u62EC\u4E0A\u9762\u63CF\u8FF0\u7684 <code>buildah</code> \u547D\u4EE4\u3002\u7531\u4E8E\u8FD9\u4E9B\u547D\u4EE4\u5DF2\u7ECF\u5728\u547D\u540D\u7A7A\u95F4\u4E2D\uFF0C <code>buildah mount</code> \u547D\u4EE4\u5C06\u50CF\u5728 rootful \u6A21\u5F0F\u4E0B\u4E00\u6837\u5DE5\u4F5C\u3002\u4E00\u5207\u90FD\u53D1\u751F\u5728\u547D\u540D\u7A7A\u95F4\u5185\uFF0C\u7528\u6237\u5F97\u5230\u4ED6\u4EEC\u6240\u671F\u671B\u7684\u3002</p><p>\u73B0\u5728\u7528\u6237\u53EF\u4EE5\u6267\u884C\u4E0A\u9762\u5217\u51FA\u7684\u547D\u4EE4\u5E76\u521B\u5EFA\u4E00\u4E2A shell \u811A\u672C\u3002\u7136\u540E\u4F7F\u7528 <code>buildah unshare</code> \u547D\u4EE4\u76F4\u63A5\u6267\u884C\u6B64 shell \u811A\u672C\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&gt;</span> buildahimage.sh <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
ctr=<span class="token variable"><span class="token variable">$(</span>buildah from scratch<span class="token variable">)</span></span>
mnt=<span class="token variable">$buildah</span> mount <span class="token variable">$ctr</span>)
dnf -y --installroot <span class="token variable">$mnt</span> httpd 
buildah config --entrypoint .... <span class="token variable">$ctr</span>
buildah commit <span class="token variable">$ctr</span> IMAGE
buildah push IMAGE REGISTRY
EOF</span>

<span class="token function">chmod</span> +x ./buildahimage.sh
buildah unshare ./buildimage.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u65E0\u6839-buildah-\u7684\u5DE5\u4F5C\u539F\u7406-\u5728\u975E\u7279\u6743\u73AF\u5883\u4E2D\u6784\u5EFA\u5BB9\u5668" tabindex="-1"><a class="header-anchor" href="#\u65E0\u6839-buildah-\u7684\u5DE5\u4F5C\u539F\u7406-\u5728\u975E\u7279\u6743\u73AF\u5883\u4E2D\u6784\u5EFA\u5BB9\u5668" aria-hidden="true">#</a> \u65E0\u6839 Buildah \u7684\u5DE5\u4F5C\u539F\u7406\uFF1A\u5728\u975E\u7279\u6743\u73AF\u5883\u4E2D\u6784\u5EFA\u5BB9\u5668</h2><p>Buildah \u662F\u7528\u4E8E\u6784\u5EFA\u5F00\u653E\u5BB9\u5668\u8BA1\u5212 (OCI) \u5BB9\u5668\u6620\u50CF\u7684\u5DE5\u5177\u548C\u5E93\u3002</p><p>\u6211\u4EEC\u90FD\u77E5\u9053\u5BB9\u5668\u955C\u50CF\u7684\u7279\u5F81\uFF1A</p><ul><li>rootfs \u6587\u4EF6\uFF08etc/usr/bin)</li><li>\u5BB9\u5668\u955C\u50CF\u7684\u7B2C\u4E8C\u90E8\u5206\u662F\u63CF\u8FF0 rootfs \u5185\u5BB9\u7684 JSON \u6587\u4EF6\u3002\u5B83\u5305\u542B\u8FD0\u884C\u5BB9\u5668\u7684\u547D\u4EE4\u3001\u5165\u53E3\u70B9\u3001\u8FD0\u884C\u5BB9\u5668\u6240\u9700\u7684\u73AF\u5883\u53D8\u91CF\u3001\u5BB9\u5668\u7684\u5DE5\u4F5C\u76EE\u5F55\u7B49\u5B57\u6BB5\u3002</li></ul><p>\u57FA\u672C\u4E0A\uFF0C\u8FD9\u4E2A JSON \u6587\u4EF6\u5141\u8BB8\u5BB9\u5668\u955C\u50CF\u7684\u5F00\u53D1\u4EBA\u5458\u63CF\u8FF0\u5BB9\u5668\u955C\u50CF\u7684\u9884\u671F\u4F7F\u7528\u65B9\u5F0F\u3002<strong>\u6B64 JSON \u6587\u4EF6\u4E2D\u7684\u5B57\u6BB5\u5DF2\u5728 OCI \u56FE\u50CF\u683C\u5F0F\u89C4\u8303\u4E2D\u6807\u51C6\u5316\u3002</strong></p><p>\u7136\u540E\u5C06 rootfs \u548C JSON \u6587\u4EF6\u6253\u5305\u5728\u4E00\u8D77\u4EE5\u521B\u5EFA\u5B58\u50A8\u5728\u5BB9\u5668\u6CE8\u518C\u8868\u4E2D\u7684\u6620\u50CF\u5305\u3002\u8981\u521B\u5EFA\u5206\u5C42\u6620\u50CF\uFF0C\u60A8\u9700\u8981\u5728 rootfs \u4E2D\u5B89\u88C5\u66F4\u591A\u8F6F\u4EF6\u5E76\u4FEE\u6539 JSON \u6587\u4EF6\u3002</p><p><strong>\u5728\u5F88\u591A\u5E74\u524D\uFF0CDocker \u63A8\u51FA\u4E86 Dockerfile\uFF0C\u8FD9\u662F\u4E00\u79CD\u7528\u4E8E\u6784\u5EFA\u955C\u50CF\u7684\u811A\u672C\u5316\u8BED\u8A00\uFF0C\u4E0D\u5F97\u4E0D\u8BF4\u8BBE\u8BA1\u7684\u5F88\u6210\u529F\u3002\u4F46\u662F\u5B83\u4E5F\u6709\u5F88\u591A\u7684\u7F3A\u70B9\uFF1A</strong></p><ul><li>Dockerfile \u9F13\u52B1\u5728\u5BB9\u5668\u955C\u50CF\u4E2D\u5305\u542B\u7528\u4E8E\u6784\u5EFA\u5BB9\u5668\u7684\u5DE5\u5177\u3002\u5BB9\u5668\u955C\u50CF\u4E0D\u9700\u8981\u5305\u542B yum/dnf/apt\uFF0C\u4F46\u5927\u591A\u6570\u5305\u542B\u5176\u4E2D\u4E4B\u4E00\u53CA\u5176\u6240\u6709\u4F9D\u8D56\u9879\u3002</li><li>\u6BCF\u884C\u90FD\u4F1A\u521B\u5EFA\u4E00\u4E2A\u56FE\u5C42\u3002\u56E0\u6B64\uFF0C secret \u53EF\u80FD\u4F1A\u88AB\u9519\u8BEF\u5730\u6DFB\u52A0\u5230\u5BB9\u5668\u955C\u50CF\u4E2D\u3002\u5982\u679C\u60A8\u5728 Dockerfile \u7684\u4E00\u884C\u4E2D\u521B\u5EFA\u4E00\u4E2A secret\u5E76\u5728\u4E0B\u4E00\u884C\u4E2D\u5C06\u5176\u5220\u9664\uFF0C\u5219\u8BE5 secret \u4ECD\u5728\u56FE\u50CF\u4E2D\u3002</li></ul>`,58),Be=e("Note that "),Pe={href:"https://github.com/openSUSE/umoci",target:"_blank",rel:"noopener noreferrer"},we=e("umoci"),Ee=e(" is an alternative to "),Ue=n("strong",null,"docker build",-1),$e=e(" that allows you to build container images without Dockerfile."),Oe=n("p",null,[n("strong",null,"\u6211\u4EEC\u4F7F\u7528 buildah \u80FD\u505A\u4EC0\u4E48\uFF1F")],-1),Ce=n("p",null,"\u6211\u4EEC\u4F7F\u7528 Buildah \u7684\u76EE\u6807\u662F\u6784\u5EFA\u4E00\u4E2A\u7B80\u5355\u7684\u5DE5\u5177\uFF0C\u5B83\u53EF\u4EE5\u5728\u78C1\u76D8\u4E0A\u521B\u5EFA\u4E00\u4E2A rootfs \u76EE\u5F55\u5E76\u5141\u8BB8\u5176\u4ED6\u5DE5\u5177\u586B\u5145\u8BE5\u76EE\u5F55\uFF0C\u7136\u540E\u521B\u5EFA JSON \u6587\u4EF6\u3002",-1),qe=e("\u6700\u540E\uFF0CBuildah \u5C06\u521B\u5EFA OCI \u6620\u50CF\u5E76\u5C06\u5176\u63A8\u9001\u5230\u5BB9\u5668\u6CE8\u518C\u8868\uFF0C\u4F9B\u4EFB\u4F55\u5BB9\u5668\u5F15\u64CE\u4F7F\u7528\uFF0C\u4F8B\u5982 "),Re={href:"https://github.com/docker",target:"_blank",rel:"noopener noreferrer"},Ae=e("Docker"),Se=e(", Podman, "),Le={href:"https://cri-o.io/",target:"_blank",rel:"noopener noreferrer"},Ne=e("CRI-O"),Ge=e(", or another "),Fe=n("strong",null,"Buildah",-1),Me=o(`<p>Buildah \u8FD8\u652F\u6301 Dockerfile\uFF0C\u56E0\u4E3A\u6211\u4EEC\u77E5\u9053\u5927\u591A\u6570\u6784\u5EFA\u5BB9\u5668\u7684\u4EBA\u90FD\u521B\u5EFA\u4E86 Dockerfile\u3002</p><h3 id="\u76F4\u63A5\u4F7F\u7528-buildah" tabindex="-1"><a class="header-anchor" href="#\u76F4\u63A5\u4F7F\u7528-buildah" aria-hidden="true">#</a> \u76F4\u63A5\u4F7F\u7528 buildah</h3><p>\u5F88\u591A\u4EBA\u76F4\u63A5\u4F7F\u7528 Buildah\u3002 Buildah \u7684\u4E00\u4E2A\u5F88\u9177\u7684\u529F\u80FD\u662F\u60A8\u53EF\u4EE5\u76F4\u63A5\u5728 Bash \u4E2D\u7F16\u5199\u5BB9\u5668\u6784\u5EFA\u811A\u672C\u3002</p><p>\u4E0B\u9762\u7684\u793A\u4F8B\u521B\u5EFA\u4E86\u4E00\u4E2A\u540D\u4E3A myapp.sh \u7684 Bash \u811A\u672C\uFF0C\u5B83\u4F7F\u7528 Buildah \u6765\u62C9\u4E0B Fedora \u955C\u50CF\uFF0C\u7136\u540E\u5728\u4E00\u53F0\u673A\u5668\u4E0A\u4F7F\u7528 dnf \u548C make \u5C06\u8F6F\u4EF6\u5B89\u88C5\u5230\u5BB9\u5668\u955C\u50CF rootfs\uFF0C <strong>$mnt</strong> \u3002\u7136\u540E\u5B83\u4F7F\u7528 buildah config \u5C06\u4E00\u4E9B\u5B57\u6BB5\u6DFB\u52A0\u5230 JSON \u6587\u4EF6\uFF0C\u5E76\u5C06\u5BB9\u5668\u63D0\u4EA4\u5230\u5BB9\u5668\u955C\u50CF myapp\u3002\u6700\u540E\uFF0C\u5B83\u5C06\u5BB9\u5668\u955C\u50CF\u63A8\u9001\u5230\u5BB9\u5668\u6CE8\u518C\u8868 quay.io\u3002 \uFF08\u5B83\u53EF\u4EE5\u5C06\u5B83\u63A8\u9001\u5230\u4EFB\u4F55\u5BB9\u5668\u6CE8\u518C\u8868\u3002\uFF09\u73B0\u5728\u8FD9\u4E2A OCI \u955C\u50CF\u53EF\u4EE5\u88AB\u4EFB\u4F55\u5BB9\u5668\u5F15\u64CE\u6216 Kubernetes \u4F7F\u7528\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">cat</span> myapp.sh
<span class="token comment">#!/bin/bash</span>
<span class="token assign-left variable">ctr</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>buildah from fedora<span class="token variable">)</span></span>
<span class="token assign-left variable">mnt</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>buildah <span class="token function">mount</span> $ctr<span class="token variable">)</span></span>
dnf <span class="token parameter variable">-y</span> <span class="token function">install</span> <span class="token parameter variable">--installroot</span> <span class="token variable">$mnt</span> httpd
<span class="token function">make</span> <span class="token function">install</span> <span class="token assign-left variable">DESTDIR</span><span class="token operator">=</span><span class="token variable">$mnt</span> myapp
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">$mnt</span>/var/cache <span class="token variable">$mnt</span>/var/log/*
buildah config <span class="token parameter variable">--command</span> /usr/bin/myapp <span class="token parameter variable">-env</span> <span class="token assign-left variable">foo</span><span class="token operator">=</span>bar --working-dir<span class="token operator">=</span>/root <span class="token variable">$ctr</span>
buildah commit <span class="token variable">$ctr</span> myapp
buildah push myapp http://quay.io/username/myapp
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8981\u521B\u5EFA\u975E\u5E38\u5C0F\u7684\u955C\u50CF\uFF0C\u60A8\u53EF\u4EE5\u5C06\u4E0A\u9762\u811A\u672C\u4E2D\u7684 fedora \u66FF\u6362\u4E3A <code>scratch</code>\uFF0CBuildah \u5C06\u6784\u5EFA\u4E00\u4E2A\u5BB9\u5668\u955C\u50CF\uFF0C\u8BE5\u5BB9\u5668\u955C\u50CF\u5185\u4EC5\u5305\u542B httpd \u5305\u7684\u8981\u6C42\u3002\u4E0D\u9700\u8981 Python \u6216 DNF\u3002</p><p>\u{1F914} <strong>\u73B0\u5728\u6211\u4EEC\u80FD\u66F4\u597D\u7684\u7406\u89E3\u4E86 buildah \u548C podman \u533A\u522B\uFF1A</strong></p><blockquote><p>\u501F\u52A9 Buildah\uFF0C\u6211\u4EEC\u62E5\u6709\u4E86\u4E00\u4E2A\u7528\u4E8E\u6784\u5EFA\u5BB9\u5668\u955C\u50CF\u7684\u4F4E\u7EA7\u5DE5\u5177\u3002 Buildah \u8FD8\u4E3A\u5176\u4ED6\u5DE5\u5177\u63D0\u4F9B\u4E86\u4E00\u4E2A\u5E93\u6765\u6784\u5EFA\u5BB9\u5668\u955C\u50CF\u3002 Podman \u65E8\u5728\u53D6\u4EE3 Docker \u547D\u4EE4\u884C\u754C\u9762 (CLI)\u3002 Docker CLI \u547D\u4EE4\u4E4B\u4E00\u662F docker build\u3002\u6211\u4EEC\u9700\u8981 podman build \u6765\u652F\u6301\u4F7F\u7528 Dockerfiles \u6784\u5EFA\u5BB9\u5668\u955C\u50CF\u3002 Podman \u5728 Buildah \u5E93\u4E2D\u51FA\u552E\uFF0C\u4EE5\u5141\u8BB8\u5B83\u8FDB\u884C podman \u6784\u5EFA\u3002\u6BCF\u6B21\u8FDB\u884C podman \u6784\u5EFA\u65F6\uFF0C\u60A8\u90FD\u5728\u6267\u884C Buildah \u4EE3\u7801\u6765\u6784\u5EFA\u5BB9\u5668\u955C\u50CF\u3002\u5982\u679C\u60A8\u53EA\u6253\u7B97\u4F7F\u7528 Dockerfiles \u6784\u5EFA\u5BB9\u5668\u955C\u50CF\uFF0C\u6211\u4EEC\u5EFA\u8BAE\u60A8\u53EA\u4F7F\u7528 Podman\uFF1B\u6839\u672C\u4E0D\u9700\u8981 Buildah\u3002</p></blockquote><h3 id="buildah-problems-whit-rootless" tabindex="-1"><a class="header-anchor" href="#buildah-problems-whit-rootless" aria-hidden="true">#</a> buildah problems whit rootless</h3><p><strong>buildah \u914D\u7F6E\u540E\u652F\u6301 rootless \uFF0C\u9ED8\u8BA4\u4E0B</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>bash-4.2$ buildah
Error during unshare<span class="token punctuation">(</span>CLONE_NEWUSER<span class="token punctuation">)</span>: Invalid argument
User namespaces are not enabled <span class="token keyword">in</span> /proc/sys/user/max_user_namespaces.
ERRO error parsing PID <span class="token string">&quot;&quot;</span><span class="token builtin class-name">:</span> strconv.Atoi: parsing <span class="token string">&quot;&quot;</span><span class="token builtin class-name">:</span> invalid syntax 
ERRO <span class="token punctuation">(</span>unable to determine <span class="token builtin class-name">exit</span> status<span class="token punctuation">)</span>  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Buildah \u5728\u65E0\u6839\u6A21\u5F0F\u4E0B\u8FD0\u884C\u826F\u597D\u3002\u5B83\u4EE5\u4E0E Podman \u76F8\u540C\u7684\u65B9\u5F0F\u4F7F\u7528\u7528\u6237\u547D\u540D\u7A7A\u95F4\u3002\u5982\u679C\u4F60\u6267\u884C\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>buildah bud <span class="token parameter variable">--tag</span> myapp <span class="token parameter variable">-f</span> Dockerfile <span class="token builtin class-name">.</span>
buildah push myapp http://quay.io/username/myapp
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728\u60A8\u7684\u4E3B\u76EE\u5F55\u4E2D\uFF0C\u4E00\u5207\u6B63\u5E38\u3002\u4F46\u662F\uFF0C\u5982\u679C\u4F60\u5728\u666E\u901A\u7528\u6237\u6267\u884C\u4E0A\u9762\u63CF\u8FF0\u7684\u811A\u672C\uFF0C\u5B83\u5C31\u4F1A\u5931\u8D25\uFF01</p><p><strong>\u95EE\u9898\u5728\u4E8E\uFF0C\u5728\u65E0\u6839\u6A21\u5F0F\u4E0B\u8FD0\u884C buildah mount \u547D\u4EE4\u65F6\uFF0Cbuildah \u547D\u4EE4\u5FC5\u987B\u5C06\u5176\u81EA\u8EAB\u653E\u5165\u7528\u6237\u547D\u540D\u7A7A\u95F4\u5E76\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u6302\u8F7D\u547D\u540D\u7A7A\u95F4\u3002\u5F53\u4E0D\u5728\u7528\u6237\u547D\u540D\u7A7A\u95F4\u4E2D\u8FD0\u884C\u65F6\uFF0C\u65E0\u6839\u7528\u6237\u4E0D\u5141\u8BB8\u6302\u8F7D\u6587\u4EF6\u7CFB\u7EDF\u3002</strong></p><p>Podman \u548C Buildah \u7B49\u65E0\u6839\u5BB9\u5668\u5F15\u64CE\u5728\u6267\u884C\u65F6\u4F1A\u81EA\u52A8\u521B\u5EFA\u81EA\u5DF1\u7684\u7528\u6237\u547D\u540D\u7A7A\u95F4\u548C\u6302\u8F7D\u547D\u540D\u7A7A\u95F4\u3002\u5F53\u5BB9\u5668\u5F15\u64CE\u8FDB\u7A0B\u9000\u51FA\u65F6\uFF0C\u7528\u6237\u548C\u6302\u8F7D\u547D\u540D\u7A7A\u95F4\u6D88\u5931\uFF0C\u7528\u6237\u8FDB\u7A0B\u56DE\u5230\u4E3B\u673A\u6302\u8F7D\u547D\u540D\u7A7A\u95F4\u3002\u6B64\u65F6\uFF0C\u8FD0\u884C\u5DE5\u5177\u65F6\u521B\u5EFA\u7684\u6302\u8F7D\u4E0D\u518D\u5BF9\u4E3B\u673A\u4E0A\u7684\u5176\u4ED6\u8FDB\u7A0B\u53EF\u89C1\u6216\u65E0\u6CD5\u4F7F\u7528\u3002</p><p>\u5F53 Buildah \u53EF\u6267\u884C\u6587\u4EF6\u9000\u51FA\u65F6\uFF0C\u7528\u6237\u547D\u540D\u7A7A\u95F4\u548C\u6302\u8F7D\u547D\u540D\u7A7A\u95F4\u6D88\u5931\uFF0C\u56E0\u6B64\u6302\u8F7D\u70B9\u4E0D\u518D\u5B58\u5728\u3002\u8FD9\u610F\u5473\u7740\u5728 buildah mount \u4E4B\u540E\u5C1D\u8BD5\u5199\u5165 <strong><code>$mnt</code></strong> \u7684\u547D\u4EE4\u5C06\u5931\u8D25\uFF0C\u56E0\u4E3A <strong><code>$mnt</code></strong> \u4E0D\u518D\u88AB\u6302\u8F7D\u3002</p><p>\u6211\u4EEC\u600E\u6837\u624D\u80FD\u4F7F\u811A\u672C\u5728\u65E0\u6839\u6A21\u5F0F\u4E0B\u5DE5\u4F5C\uFF1F</p><h2 id="fuse-overlayfs" tabindex="-1"><a class="header-anchor" href="#fuse-overlayfs" aria-hidden="true">#</a> fuse-overlayfs</h2><p>FUSE \u4E2D\u7528\u4E8E\u65E0\u6839\u5BB9\u5668\u7684 overlay+shiftfs \u7684\u5B9E\u73B0\u3002</p><h3 id="\u542F\u7528\u652F\u6301\u4EE5\u6784\u5EFA\u975E\u7279\u6743\u5BB9\u5668" tabindex="-1"><a class="header-anchor" href="#\u542F\u7528\u652F\u6301\u4EE5\u6784\u5EFA\u975E\u7279\u6743\u5BB9\u5668" aria-hidden="true">#</a> \u542F\u7528\u652F\u6301\u4EE5\u6784\u5EFA\u975E\u7279\u6743\u5BB9\u5668</h3><p>\u5E0C\u671B\u4F7F\u7528 Buildah \u6784\u5EFA\u975E\u7279\u6743\u5BB9\u5668\u7684\u7528\u6237\u9700\u8981\u5728\u9996\u6B21\u8FD0\u884C podman \u4E4B\u524D\u5B8C\u6210\u989D\u5916\u7684\u8BBE\u7F6E\u6B65\u9AA4\u3002</p><p>\u6CE8\u610F\uFF1A\u5982\u679C\u60A8\u6B63\u5728\u6784\u5EFA\u4E13\u7528\u4E8E\u8FD0\u884C\u975E\u7279\u6743\u5BB9\u5668\u7684\u7CFB\u7EDF\uFF0C\u8BF7\u5728\u6DFB\u52A0\u4EFB\u4F55\u7528\u6237\u4E4B\u524D\u6309\u7167\u4EE5\u4E0B\u6B65\u9AA4\u64CD\u4F5C\u3002\u8FD9\u6837\u60A8\u5C31\u4E0D\u5FC5\u7F16\u8F91 <code>/etc/subuid</code> \u548C <code>/etc/subgid</code> \uFF1Auseradd \u4F1A\u4E3A\u60A8\u505A\u8FD9\u4E9B\uFF0C\u60A8\u53EA\u9700\u8981\u4EE5root \u8EAB\u4EFD\u8FD0\u884C <code>touch /etc/subgid</code> \u548C <code>touch /etc/subuid</code> \u3002</p><p>\u6700\u540E\uFF0C\u521B\u5EFA <code>/etc/subuid</code> \u548C <code>/etc/subgid</code> \u4EE5\u5305\u542B\u5230\u6BCF\u4E2A\u80FD\u591F\u8FD0\u884C\u5BB9\u5668\u7684\u7528\u6237\u7684\u5BB9\u5668\u5316 UID/GID \u5BF9\u7684\u6620\u5C04\u3002 \u4EE5\u4E0B\u793A\u4F8B\u9002\u7528\u4E8E root \u7528\u6237\uFF08\u548C systemd \u7CFB\u7EDF\u5355\u5143\uFF09\u548C\u793A\u4F8B\u7528\u6237 <code>buildah</code> \uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;buildah:100000:65536&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/subuid
<span class="token builtin class-name">echo</span> <span class="token string">&quot;buildah:100000:65536&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/subgid 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5982\u679C\u60A8\u5728\u5E94\u7528\u4E0A\u8FF0\u66F4\u6539\u4E4B\u524D\u786E\u5B9E\u8FD0\u884C\u4E86 podman\uFF0C\u5219\u5728\u5C1D\u8BD5\u4EE5\u975E\u7279\u6743\u7528\u6237\u8EAB\u4EFD\u62C9\u53D6\u56FE\u50CF\u65F6\u4F1A\u51FA\u73B0\u9519\u8BEF\u3002\u8FD0\u884C <code>podman system migrate</code> \u6765\u4FEE\u590D\u5B83\u3002</p><p>\u5982\u679C\u4E00\u5207\u987A\u5229\uFF0C\u90A3\u4E48\u5728\u6CE8\u9500\u5E76\u91CD\u65B0\u767B\u5F55 <code>buildah images</code> \u540E\u5E94\u8BE5\u4E0D\u4F1A\u5BFC\u81F4\u9519\u8BEF</p><p>\u26A0\uFE0F \u6CE8\u610F\uFF1A\u5982\u679C\u60A8\u770B\u5230\u8BBF\u95EE <code>/run/user/0</code> \u65F6\u51FA\u73B0\u9519\u8BEF\uFF0C\u90A3\u4E48\u60A8\u53EF\u80FD\u5DF2\u7ECF\u4F7F\u7528 su \u6210\u4E3A\u60A8\u7528\u4E8E\u6D4B\u8BD5\u7684\u7528\u6237 \u2014 \u60A8\u5E94\u8BE5\u4EE5\u8FD9\u6837\u7684\u7528\u6237\u8EAB\u4EFD\u767B\u5F55\uFF0C\u56E0\u4E3A\u6CA1\u6709 <code>--login</code> \u6807\u5FD7\u7684 su \u4E0D\u4F1A\u8BBE\u7F6E <code>XDG_RUNTIME_DIR</code> \u548C\u5176\u4ED6\u73AF\u5883\u53D8\u91CF\u6765\u4FEE\u6B63\u503C\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># mount --make-shared /</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,29),Te=n("strong",null,"\u8981\u6C38\u4E45",-1),He=e("\u8BBE\u7F6E\u5B83\uFF0C\u7F16\u8F91"),je={href:"https://wiki.archlinux.org/title/Fstab#Usage",target:"_blank",rel:"noopener noreferrer"},Ve=e("/etc/fstab"),ze=e("\u5E76\u5C06"),Je=n("em",null,"\u5171\u4EAB",-1),Xe=e("\u9009\u9879\u6DFB\u52A0\u5230\u6240\u9700\u7684\u6302\u8F7D\u5E76\u91CD\u65B0\u542F\u52A8\u3002\u5B83\u5C06\u4EA7\u751F\u5982\u4E0B\u6761\u76EE\uFF1A"),Ke=o(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># &lt;\u8BBE\u5907&gt; &lt;\u76EE\u5F55&gt; &lt;\u7C7B\u578B&gt; &lt;\u9009\u9879&gt; &lt;\u8F6C\u50A8&gt; &lt;fsck&gt; </span>
<span class="token assign-left variable">UUID</span><span class="token operator">=</span>0a3407de-014b-458b-b5c1-848e92a327a3 /     ext4   defaults,shared   <span class="token number">0</span>      <span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="podman-1" tabindex="-1"><a class="header-anchor" href="#podman-1" aria-hidden="true">#</a> Podman</h2><p>\u5728\u5141\u8BB8\u6CA1\u6709 root \u6743\u9650\u7684\u7528\u6237\u8FD0\u884C Podman \u4E4B\u524D\uFF0C\u7BA1\u7406\u5458\u5FC5\u987B\u5B89\u88C5\u6216\u6784\u5EFA Podman \u5E76\u5B8C\u6210\u4EE5\u4E0B\u914D\u7F6E\u3002</p><h3 id="install" tabindex="-1"><a class="header-anchor" href="#install" aria-hidden="true">#</a> install</h3><p><strong>centos\uFF1A</strong></p><p>Podman \u5728 CentOS 7 \u7684\u9ED8\u8BA4 Extras \u5B58\u50A8\u5E93\u548C CentOS 8 \u548C Stream \u7684 AppStream \u5B58\u50A8\u5E93\u4E2D\u53EF\u7528\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> yum <span class="token parameter variable">-y</span> <span class="token function">install</span> <span class="token function">podman</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>ubuntu\uFF1A</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token parameter variable">-y</span> update
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token parameter variable">-y</span> <span class="token function">install</span> <span class="token function">podman</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u6784\u5EFA" tabindex="-1"><a class="header-anchor" href="#\u6784\u5EFA" aria-hidden="true">#</a> \u6784\u5EFA</h3><p><strong>\u5FC5\u987B\u7684\uFF1A</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> yum <span class="token function">install</span> <span class="token parameter variable">-y</span> <span class="token punctuation">\\</span>
  btrfs-progs-devel <span class="token punctuation">\\</span>
  conmon <span class="token punctuation">\\</span>
  containernetworking-plugins <span class="token punctuation">\\</span>
  containers-common <span class="token punctuation">\\</span>
  crun <span class="token punctuation">\\</span>
  device-mapper-devel <span class="token punctuation">\\</span>
  <span class="token function">git</span> <span class="token punctuation">\\</span>
  glib2-devel <span class="token punctuation">\\</span>
  glibc-devel <span class="token punctuation">\\</span>
  glibc-static <span class="token punctuation">\\</span>
  go <span class="token punctuation">\\</span>
  golang-github-cpuguy83-md2man <span class="token punctuation">\\</span>
  gpgme-devel <span class="token punctuation">\\</span>
  iptables <span class="token punctuation">\\</span>
  libassuan-devel <span class="token punctuation">\\</span>
  libgpg-error-devel <span class="token punctuation">\\</span>
  libseccomp-devel <span class="token punctuation">\\</span>
  libselinux-devel <span class="token punctuation">\\</span>
  <span class="token function">make</span> <span class="token punctuation">\\</span>
  pkgconfig
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>crun \u5B89\u88C5\u5931\u8D25\uFF0C\u4ECE\u6E90\u7801\u5B89\u88C5\uFF1A</strong></p><blockquote><p>\u6D4B\u8BD5\u8FC7\u90E8\u5206\u673A\u5668\uFF0CUbuntu\uFF1A<code>apt install crun -y</code> \uFF0CCentOs\uFF1A<code>yum install -y crun</code>\u3002\u4E5F\u4F1A\u51FA\u73B0\u6CA1\u6709\u5305\u7684\u73B0\u8C61\uFF0C\u4E24\u79CD\u65B9\u5F0F\uFF0C1. \u7F16\u8BD1\u5B89\u88C5\uFF1B 2. \u4FEE\u6539\u6E90</p></blockquote>`,14),Ye={href:"https://github.com/containers/crun",target:"_blank",rel:"noopener noreferrer"},Ze=e("https://github.com/containers/crun"),We=o(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> clone https://github.com/containers/crun <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> crun
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Tumbleweed \u8981\u6C42\u60A8\u5C06 libseccomp \u7684\u5934\u6587\u4EF6\u4F4D\u7F6E\u6307\u5B9A\u4E3A\u7F16\u8BD1\u5668\u6807\u5FD7\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># ./autogen.sh</span>
<span class="token comment"># ./configure CFLAGS=&#39;-I/usr/include/libseccomp&#39;</span>
<span class="token comment"># make</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>root \u6A21\u5F0F \u548C rootless \u6A21\u5F0F\uFF1A</p><p>\u9664\u975E\u4F60\u4E5F\u5728\u6784\u5EFA Python \u7ED1\u5B9A\uFF0C\u5426\u5219 python \u53EA\u9700\u8981 libocispec \u5728\u6784\u5EFA\u65F6\u751F\u6210 C \u89E3\u6790\u5668\uFF0C\u4E4B\u540E\u4E0D\u4F1A\u4F7F\u7528\u5B83\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ./autogen.sh
$ ./configure
$ <span class="token function">make</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8981\u5B89\u88C5\u5230\u9ED8\u8BA4\u524D\u7F00 ( <code>/usr/local</code>)\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">make</span> <span class="token function">install</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>**\u26A0\uFE0F \u53D1\u73B0\u9519\u8BEF\uFF0C\u53C2\u8003 https://github.com/containers/crun/issues/359 **</p><h3 id="\u67E5\u770B\u955C\u50CF" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B\u955C\u50CF" aria-hidden="true">#</a> \u67E5\u770B\u955C\u50CF</h3><p><strong>\u53D1\u73B0\u4E00\u4E2A\u9519\u8BEF\uFF1A</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@iZuf68xky083mr0yy6q37lZ ~<span class="token punctuation">]</span><span class="token comment"># podman image list</span>
Error: Could not get runtime: default OCI runtime <span class="token string">&quot;runc&quot;</span> not found: invalid argument
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u{1F4DC} \u5BF9\u4E0A\u9762\u7684\u89E3\u91CA\uFF1A</strong></p><p>cgroup V2 Linux \u5185\u6838\u529F\u80FD\u5141\u8BB8\u7528\u6237\u9650\u5236\u65E0\u6839\u5BB9\u5668\u53EF\u4EE5\u4F7F\u7528\u7684\u8D44\u6E90\u91CF\u3002\u5982\u679C\u8FD0\u884C Podman \u7684 Linux \u53D1\u884C\u7248\u542F\u7528\u4E86 cgroup V2\uFF0C\u90A3\u4E48\u60A8\u53EF\u80FD\u9700\u8981\u66F4\u6539\u9ED8\u8BA4\u7684 OCI \u8FD0\u884C\u65F6\u3002\u4E00\u4E9B\u65E7\u7248\u672C<code>runc</code>\u4E0D\u80FD\u4E0E cgroup V2 \u4E00\u8D77\u4F7F\u7528\uFF0C\u60A8\u53EF\u80FD\u5FC5\u987B\u5207\u6362\u5230\u66FF\u4EE3\u7684 OCI \u8FD0\u884C\u65F6<code>crun</code>\u3002</p><p><code>--runtime</code>\u4E5F\u53EF\u4EE5\u4F7F\u7528\u4EE5\u4E0B\u9009\u9879\u5728\u547D\u4EE4\u884C\u4E2D\u6253\u5F00\u5BF9 cgroup V2 \u7684\u66FF\u4EE3 OCI \u8FD0\u884C\u65F6\u652F\u6301\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">podman</span> <span class="token parameter variable">--runtime</span> crun
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,16),Qe=n("code",null,"containers.conf",-1),ns=e("\u6216\u8005\u5BF9\u4E8E\u6240\u6709\u547D\u4EE4\uFF0C\u901A\u8FC7\u5728\u7CFB\u7EDF\u7EA7\u522B\u6216"),es={href:"https://github.com/containers/podman/blob/main/docs/tutorials/rootless_tutorial.md#user-configuration-files",target:"_blank",rel:"noopener noreferrer"},ss=e("\u7528\u6237\u7EA7\u522B"),as=e("\u5C06\u6587\u4EF6\u4E2D\u201C\u9ED8\u8BA4 OCI \u8FD0\u884C\u65F6\u201D\u7684\u503C\u4ECE"),os=n("code",null,'runtime = "runc"',-1),is=e("\u66F4\u6539\u4E3A"),ts=n("code",null,'runtime = "crun"',-1),ds=e("."),ls=n("h3",{id:"\u5B89\u88C5-slirp4netns",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u5B89\u88C5-slirp4netns","aria-hidden":"true"},"#"),e(" \u5B89\u88C5 "),n("code",null,"slirp4netns")],-1),cs=e("slirp4netns\u5305"),rs={href:"https://github.com/rootless-containers/slirp4netns",target:"_blank",rel:"noopener noreferrer"},ps=e("\u4E3A\u975E\u7279\u6743"),us=e("\u7F51\u7EDC\u547D\u540D\u7A7A\u95F4\u63D0\u4F9B\u7528\u6237\u6A21\u5F0F\u7F51\u7EDC\uFF0C\u5FC5\u987B\u5B89\u88C5\u5728\u673A\u5668\u4E0A\u624D\u80FD\u8BA9 Podman \u5728\u65E0\u6839\u73AF\u5883\u4E2D\u8FD0\u884C\u3002\u5927\u591A\u6570 Linux \u53D1\u884C\u7248\u90FD\u53EF\u4EE5\u901A\u8FC7\u5B83\u4EEC\u7684\u8F6F\u4EF6\u5305\u5206\u53D1\u8F6F\u4EF6\uFF08\u4F8B\u5982"),hs=n("code",null,"yum",-1),bs=e("\u3001"),ms=n("code",null,"dnf",-1),vs=e("\u3001"),gs=n("code",null,"apt",-1),ks=e("\u3001"),_s=n("code",null,"zypper",-1),fs=e("\u7B49\uFF09\u83B7\u5F97\u8BE5\u8F6F\u4EF6\u5305\u3002\u5982\u679C\u8BE5\u8F6F\u4EF6\u5305\u4E0D\u53EF\u7528\uFF0C\u60A8\u53EF\u4EE5"),xs=n("code",null,"slirp4netns",-1),Ds=e("\u4ECE"),Is={href:"https://github.com/rootless-containers/slirp4netns",target:"_blank",rel:"noopener noreferrer"},ys=e("GitHub"),Bs=e("\u6784\u5EFA\u548C\u5B89\u88C5\u3002"),Ps=n("h3",{id:"\u786E\u4FDDfuse-overlayfs\u5DF2\u5B89\u88C5",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u786E\u4FDDfuse-overlayfs\u5DF2\u5B89\u88C5","aria-hidden":"true"},"#"),e(" \u786E\u4FDD"),n("code",null,"fuse-overlayfs"),e("\u5DF2\u5B89\u88C5")],-1),ws=n("p",null,[e("\u5728\u65E0\u6839\u73AF\u5883\u4E0B\u4F7F\u7528 Podman \u65F6\uFF0C\u5EFA\u8BAE\u4F7F\u7528"),n("code",null,"fuse-overlayfs"),e("\u800C\u4E0D\u662F VFS \u6587\u4EF6\u7CFB\u7EDF\u3002\u4E3A\u6B64\uFF0C\u60A8"),n("code",null,"fuse-overlayfs"),e("\u9700\u8981"),n("code",null,"$PATH"),e(".")],-1),Es={href:"https://github.com/containers/fuse-overlayfs",target:"_blank",rel:"noopener noreferrer"},Us=e("https://github.com/containers/fuse-overlayfs"),$s=n("p",null,[e("\u60A8\u7684\u53D1\u884C\u7248\u53EF\u80FD\u5DF2\u7ECF\u5728"),n("code",null,"fuse-overlayfs"),e("\u5305\u4E2D\u63D0\u4F9B\u4E86\u5B83\uFF0C\u4F46\u8BF7\u6CE8\u610F\u60A8\u81F3\u5C11\u9700\u8981"),n("strong",null,"0.7.6"),e("\u7248\u3002\u8FD9\u5C24\u5176\u9700\u8981\u5728 Ubuntu \u53D1\u884C\u7248\u4E0A\u68C0\u67E5\uFF0C\u56E0\u4E3A"),n("code",null,"fuse-overlayfs"),e("\u9ED8\u8BA4\u60C5\u51B5\u4E0B\u901A\u5E38\u4E0D\u4F1A\u5B89\u88C5 0.7.6 \u7248\u672C\u5728 "),n("strong",null,"20.04"),e(" \u4E4B\u524D\u7684 Ubuntu \u7248\u672C\u4E0A\u672C\u673A\u4E0D\u53EF\u7528\u3002")],-1),Os=e("\u8BE5"),Cs=n("code",null,"fuse-overlayfs",-1),qs=e("\u9879\u76EE\u53EF\u4ECE"),Rs={href:"https://github.com/containers/fuse-overlayfs",target:"_blank",rel:"noopener noreferrer"},As=e("GitHub"),Ss=e("\u83B7\u5F97\uFF0C\u5E76\u63D0\u4F9B\u4E86\u8F7B\u677E\u6784\u5EFA\u9759\u6001"),Ls=n("code",null,"fuse-overlayfs",-1),Ns=e("\u53EF\u6267\u884C\u6587\u4EF6\u7684\u8BF4\u660E\u3002"),Gs=o(`<p>\u5982\u679C\u5728\u5B89\u88C5\u4E4B\u524D\u4F7F\u7528 Podman <code>fuse-overlayfs</code>\uFF0C\u53EF\u80FD\u9700\u8981\u8C03\u6574<code>storage.conf</code>\u6587\u4EF6\uFF08\u8BF7\u53C2\u9605\u4E0B\u9762\u7684\u201C\u7528\u6237\u914D\u7F6E\u6587\u4EF6\u201D\uFF09\u4EE5\u66F4\u6539 to \u4E0B\u7684\u9009\u9879<code>driver</code>\u5E76\u5C06\u9009\u9879\u6307\u5411\u53EF\u6267\u884C\u6587\u4EF6\u7684\u8DEF\u5F84\uFF1A</p><p><code>[storage]</code> <code>&quot;overlay&quot;</code> <code>mount_program</code> <code>[storage.options.overlay]</code> <code>fuse-overlayfs</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>storage<span class="token punctuation">]</span>
  driver <span class="token operator">=</span> <span class="token string">&quot;overlay&quot;</span>

  <span class="token punctuation">(</span><span class="token punctuation">..</span>.<span class="token punctuation">)</span>

<span class="token punctuation">[</span>storage.options.overlay<span class="token punctuation">]</span>

  <span class="token punctuation">(</span><span class="token punctuation">..</span>.<span class="token punctuation">)</span>

  mount_program <span class="token operator">=</span> <span class="token string">&quot;/usr/bin/fuse-overlayfs&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u542F\u7528\u7528\u6237\u547D\u540D\u7A7A\u95F4-centos-7-8-\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#\u542F\u7528\u7528\u6237\u547D\u540D\u7A7A\u95F4-centos-7-8-\u6D4B\u8BD5" aria-hidden="true">#</a> \u542F\u7528\u7528\u6237\u547D\u540D\u7A7A\u95F4 \uFF08centos 7/8 \u6D4B\u8BD5\uFF09</h3><p>\u6587\u4EF6\u4E2D\u6307\u5B9A\u4E86\u7CFB\u7EDF\u5141\u8BB8\u7684\u7528\u6237\u547D\u540D\u7A7A\u95F4\u6570<code>/proc/sys/user/max_user_namespaces</code>\u3002\u5728\u5927\u591A\u6570 Linux \u5E73\u53F0\u4E0A\uFF0C\u8FD9\u662F\u9ED8\u8BA4\u9884\u8BBE\u7684\uFF0C\u65E0\u9700\u8C03\u6574\u3002\u4F46\u662F\uFF0C\u5728 RHEL7 \u673A\u5668\u4E0A\uFF0C\u5177\u6709 root \u6743\u9650\u7684\u7528\u6237\u53EF\u80FD\u9700\u8981\u4F7F\u7528\u4EE5\u4E0B\u547D\u4EE4\u5C06\u5176\u8BBE\u7F6E\u4E3A\u5408\u7406\u7684\u503C\uFF1A <code>sysctl user.max_user_namespaces=15000</code>\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># cat /proc/sys/user/max_user_namespaces</span>
<span class="token number">0</span>

<span class="token comment"># sysctl user.max_user_namespaces=15000</span>
user.max_user_namespaces <span class="token operator">=</span> <span class="token number">15000</span>

<span class="token comment"># cat /proc/sys/user/max_user_namespaces</span>
<span class="token number">15000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>Ubuntu 20.04 test\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>root@cubmaster01:~/workspces<span class="token comment"># cat /proc/sys/user/max_user_namespaces</span>
<span class="token number">15251</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="etc-subuid\u548C-etc-subgid\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#etc-subuid\u548C-etc-subgid\u914D\u7F6E" aria-hidden="true">#</a> <code>/etc/subuid</code>\u548C<code>/etc/subgid</code>\u914D\u7F6E</h3><p>Rootless Podman \u8981\u6C42\u8FD0\u884C\u5B83\u7684\u7528\u6237\u5728\u6587\u4EF6<code>/etc/subuid</code>\u548C<code>/etc/subgid</code>. <code>shadow-utils</code>\u6216\u5305\u5728\u4E0D\u540C\u7684<code>newuid</code>\u53D1\u884C\u7248\u4E0A\u63D0\u4F9B\u8FD9\u4E9B\u6587\u4EF6\uFF0C\u5B83\u4EEC\u5FC5\u987B\u5B89\u88C5\u5728\u7CFB\u7EDF\u4E0A\u3002\u6DFB\u52A0\u6216\u66F4\u65B0\u8FD9\u4E9B\u6587\u4EF6\u4E2D\u7684\u6761\u76EE\u9700\u8981\u6839\u6743\u9650\u3002</p><p>\u5BF9\u4E8E\u5C06\u88AB\u5141\u8BB8\u521B\u5EFA\u5BB9\u5668\u7684\u6BCF\u4E2A\u7528\u6237\uFF0C\u4F7F\u7528\u5982\u4E0B\u6240\u793A\u7684\u5B57\u6BB5\u66F4\u65B0<code>/etc/subuid</code>\u548C<code>/etc/subgid</code>\u4E3A\u7528\u6237\u66F4\u65B0\u3002\u8BF7\u6CE8\u610F\uFF0C\u6BCF\u4E2A\u7528\u6237\u7684\u503C\u5FC5\u987B\u662F\u552F\u4E00\u7684\u3002\u5982\u679C\u5B58\u5728\u91CD\u53E0\uFF0C\u5219\u7528\u6237\u6709\u53EF\u80FD\u4F7F\u7528\u53E6\u4E00\u4E2A\u7528\u6237\u7684\u547D\u540D\u7A7A\u95F4\uFF0C\u4ED6\u4EEC\u53EF\u80FD\u4F1A\u7834\u574F\u5B83\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">cat</span> /etc/subuid
sealos:100000:65536
sealer:165536:65536
root:200000:1001
buildah:100000:65536

$ <span class="token function">cat</span> /etc/subgid
sealos:100000:65536
sealer:165536:65536
root:200000:1001
buildah:100000:65536
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u4E2A\u6587\u4EF6\u7684\u683C\u5F0F\u662F<code>USERNAME:UID:RANGE</code></p>`,12),Fs=n("code",null,"/etc/passwd",-1),Ms=e("\u4E2D\u6216\u8F93\u51FA\u4E2D\u5217\u51FA\u7684\u7528\u6237\u540D"),Ts={href:"https://man7.org/linux/man-pages/man3/getpwent.3.html",target:"_blank",rel:"noopener noreferrer"},Hs=n("code",null,"getpwent",-1),js=e("\u3002"),Vs=n("li",null,"\u4E3A\u7528\u6237\u5206\u914D\u7684\u521D\u59CB UID\u3002",-1),zs=n("li",null,"\u4E3A\u7528\u6237\u5206\u914D\u7684 UID \u8303\u56F4\u7684\u5927\u5C0F\u3002",-1),Js=n("p",null,[e("\u8FD9\u610F\u5473\u7740\u4E3A\u7528\u6237"),n("code",null,"sealer"),e("\u5206\u914D\u4E86 UID 100000-165535 \u4EE5\u53CA"),n("code",null,"/etc/passwd"),e("\u6587\u4EF6\u4E2D\u7684\u6807\u51C6 UID\u3002\u6CE8\u610F\uFF1A\u7F51\u7EDC\u5B89\u88C5\u76EE\u524D\u4E0D\u652F\u6301\u6B64\u529F\u80FD\uFF1B\u8FD9\u4E9B\u6587\u4EF6\u5FC5\u987B\u5728\u4E3B\u673A\u672C\u5730\u53EF\u7528\u3002\u65E0\u6CD5\u4F7F\u7528 LDAP \u6216 Active Directory \u8FDB\u884C\u914D\u7F6E\u3002")],-1),Xs=e("\u5982\u679C\u66F4\u65B0"),Ks=n("code",null,"/etc/subuid",-1),Ys=e("\u6216"),Zs=n("code",null,"/etc/subgid",-1),Ws=e("\uFF0C\u5219\u9700\u8981\u505C\u6B62\u8BE5\u7528\u6237\u62E5\u6709\u7684\u6240\u6709\u6B63\u5728\u8FD0\u884C\u7684\u5BB9\u5668\uFF0C\u5E76\u7EC8\u6B62\u8BE5\u7528\u6237\u5728\u7CFB\u7EDF\u4E0A\u8FD0\u884C\u7684\u6682\u505C\u8FDB\u7A0B\u3002\u8FD9\u53EF\u4EE5\u901A\u8FC7\u4F7F\u7528\u547D\u4EE4\u81EA\u52A8\u5B8C\u6210\uFF0C\u8BE5"),Qs={href:"https://github.com/containers/podman/blob/main/docs/source/markdown/podman-system-migrate.1.md",target:"_blank",rel:"noopener noreferrer"},na=n("code",null,"podman system migrate",-1),ea=e("\u547D\u4EE4\u5C06\u4E3A\u7528\u6237\u505C\u6B62\u6240\u6709\u5BB9\u5668\u5E76\u7EC8\u6B62\u6682\u505C\u8FDB\u7A0B\u3002"),sa=o(`<p><code>usermod</code>\u8BE5\u7A0B\u5E8F\u53EF\u7528\u4E8E\u5C06 UID \u548C GID \u5206\u914D\u7ED9\u7528\u6237\uFF0C\u800C\u4E0D\u662F\u76F4\u63A5\u66F4\u65B0\u6587\u4EF6:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">usermod</span> --add-subuids <span class="token number">100000</span>-165535 --add-subgids <span class="token number">100000</span>-165535 johndoe
<span class="token function">grep</span> johndoe /etc/subuid /etc/subgid
/etc/subuid:johndoe:100000:65536
/etc/subgid:johndoe:100000:65536
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u542F\u52A8\u975E\u7279\u6743-ping" tabindex="-1"><a class="header-anchor" href="#\u542F\u52A8\u975E\u7279\u6743-ping" aria-hidden="true">#</a> \u542F\u52A8\u975E\u7279\u6743 ping</h3><p><strong>\u5728\u975E\u7279\u6743\u5BB9\u5668\u4E2D\u8FD0\u884C\u7684\u7528\u6237\u53EF\u80FD\u65E0\u6CD5\u4F7F\u7528\u8BE5<code>ping</code>\u5BB9\u5668\u4E2D\u7684\u5B9E\u7528\u7A0B\u5E8F\u3002</strong></p><p>\u5982\u679C\u9700\u8981\uFF0C\u7BA1\u7406\u5458\u5FC5\u987B\u9A8C\u8BC1\u7528\u6237\u7684 UID \u662F\u5426\u5728<code>/proc/sys/net/ipv4/ping_group_range</code>\u6587\u4EF6\u8303\u56F4\u5185\u3002</p><p>\u8981\u66F4\u6539\u5176\u503C\uFF0C\u7BA1\u7406\u5458\u53EF\u4EE5\u4F7F\u7528\u7C7B\u4F3C\u4E8E\u4EE5\u4E0B\u7684\u8C03\u7528\uFF1A<code>sysctl -w &quot;net.ipv4.ping_group_range=0 2000000&quot;</code>\u3002</p><p>\u4E3A\u4E86\u4F7F\u66F4\u6539\u6301\u4E45\u5316\uFF0C\u7BA1\u7406\u5458\u5C06\u9700\u8981\u6DFB\u52A0\u4E00\u4E2A<code>.conf</code>\u6587\u4EF6\u6269\u5C55\u540D\uFF0C<code>/etc/sysctl.d</code>\u5176\u4E2D\u5305\u542B<code>net.ipv4.ping_group_range=0 $MAX_GID</code>\uFF0C\u5176\u4E2D<code>$MAX_GID</code>\u662F\u8FD0\u884C\u5BB9\u5668\u7684\u7528\u6237\u7684\u6700\u9AD8\u53EF\u5206\u914D GID\u3002</p><h3 id="\u7528\u6237\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#\u7528\u6237\u64CD\u4F5C" aria-hidden="true">#</a> \u7528\u6237\u64CD\u4F5C</h3><p>\u5728\u65E0\u6839\u73AF\u5883\u4E2D\u8FD0\u884C <code>Podman</code> \u6240\u9700\u7684\u5927\u90E8\u5206\u5DE5\u4F5C\u90FD\u843D\u5728\u673A\u5668\u7BA1\u7406\u5458\u7684\u80A9\u4E0A\u3002</p><p>\u4E00\u65E6\u7BA1\u7406\u5458\u5728\u673A\u5668\u4E0A\u5B8C\u6210\u8BBE\u7F6E\uFF0C\u7136\u540E\u5728<code>/etc/subuid</code>\u548C\u4E2D\u4E3A\u7528\u6237\u5B8C\u6210\u914D\u7F6E<code>/etc/subgid</code>\uFF0C\u7528\u6237\u5C31\u53EF\u4EE5\u5F00\u59CB\u4F7F\u7528\u4ED6\u4EEC\u5E0C\u671B\u4F7F\u7528\u7684\u4EFB\u4F55 <code>Podman</code> \u547D\u4EE4\u3002</p><h3 id="\u7528\u6237\u914D\u7F6E\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u7528\u6237\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a> \u7528\u6237\u914D\u7F6E\u6587\u4EF6</h3><p>root \u7684 Podman \u914D\u7F6E\u6587\u4EF6\u4F4D\u4E8E<code>/usr/share/containers</code>\u3001<code>/etc/containers</code>. \u5728\u65E0\u6839\u73AF\u5883\u4E2D\uFF0C\u5B83\u4EEC\u4F4D\u4E8E<code>\${XDG_CONFIG_HOME}/containers</code>\uFF08\u901A\u5E38<code>~/.config/containers</code>\uFF09\u5E76\u7531\u6BCF\u4E2A\u7528\u6237\u62E5\u6709\u3002</p>`,12),aa=e("\u4E09\u4E2A\u4E3B\u8981\u914D\u7F6E\u6587\u4EF6\u662F"),oa={href:"https://github.com/containers/common/blob/main/docs/containers.conf.5.md",target:"_blank",rel:"noopener noreferrer"},ia=e("containers.conf"),ta=e("\u3001"),da={href:"https://github.com/containers/storage/blob/main/docs/containers-storage.conf.5.md",target:"_blank",rel:"noopener noreferrer"},la=e("storage.conf"),ca=e("\u548C"),ra={href:"https://github.com/containers/image/blob/main/docs/containers-registries.conf.5.md",target:"_blank",rel:"noopener noreferrer"},pa=e("registries.conf"),ua=e("\u3002\u7528\u6237\u53EF\u4EE5\u968F\u610F\u4FEE\u6539\u8FD9\u4E9B\u6587\u4EF6\u3002"),ha=o(`<h4 id="\u5BB9\u5668\u914D\u7F6E\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u5BB9\u5668\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a> \u5BB9\u5668\u914D\u7F6E\u6587\u4EF6</h4><p>Podman \u8BFB\u53D6</p><ol><li><code>/usr/share/containers/containers.conf</code></li><li><code>/etc/containers/containers.conf</code></li><li><code>$HOME/.config/containers/containers.conf</code></li></ol><p>\u5982\u679C\u5B83\u4EEC\u6309\u8BE5\u987A\u5E8F\u5B58\u5728\u3002\u6BCF\u4E2A\u6587\u4EF6\u90FD\u53EF\u4EE5\u8986\u76D6\u7279\u5B9A\u5B57\u6BB5\u7684\u524D\u4E00\u4E2A\u6587\u4EF6\u3002</p><h4 id="\u5B58\u50A8\u914D\u7F6E\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u5B58\u50A8\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a> \u5B58\u50A8\u914D\u7F6E\u6587\u4EF6</h4><p>\u56E0\u4E3A<code>storage.conf</code>\u8BA2\u5355\u662F</p><ol><li><code>/etc/containers/storage.conf</code></li><li><code>$HOME/.config/containers/storage.conf</code></li></ol><p>\u5728\u65E0\u6839 Podman \u4E2D\uFF0C\u67D0\u4E9B\u5B57\u6BB5<code>/etc/containers/storage.conf</code>\u88AB\u5FFD\u7565\u3002\u8FD9\u4E9B\u5B57\u6BB5\u662F\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">graphroot</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>
 container storage graph <span class="token function">dir</span> <span class="token punctuation">(</span>default: <span class="token string">&quot;/var/lib/containers/storage&quot;</span><span class="token punctuation">)</span>
 Default directory to store all writable content created by container storage programs.

<span class="token assign-left variable">runroot</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>
 container storage run <span class="token function">dir</span> <span class="token punctuation">(</span>default: <span class="token string">&quot;/run/containers/storage&quot;</span><span class="token punctuation">)</span>
 Default directory to store all temporary writable content created by container storage programs.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728\u65E0\u6839 Podman \u4E2D\uFF0C\u8FD9\u4E9B\u5B57\u6BB5\u9ED8\u8BA4\u4E3A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">graphroot</span><span class="token operator">=</span><span class="token string">&quot;<span class="token environment constant">$HOME</span>/.local/share/containers/storage&quot;</span>
<span class="token assign-left variable">runroot</span><span class="token operator">=</span><span class="token string">&quot;<span class="token environment constant">$XDG_RUNTIME_DIR</span>/containers&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,11),ba={href:"https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html#variables",target:"_blank",rel:"noopener noreferrer"},ma=e("$XDG_RUNTIME_DIR"),va=e("\u5728\u5927\u591A\u6570\u7CFB\u7EDF\u4E0A\u9ED8\u8BA4\u4E3A"),ga=n("code",null,"/run/user/$UID",-1),ka=e("."),_a=o(`<h4 id="\u6CE8\u518C\u914D\u7F6E\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u6CE8\u518C\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a> \u6CE8\u518C\u914D\u7F6E\u6587\u4EF6</h4><p>\u6CE8\u518C\u8868\u914D\u7F6E\u6309\u6B64\u987A\u5E8F\u8BFB\u5165</p><ol><li><code>/etc/containers/registries.conf</code></li><li><code>/etc/containers/registries.d/*</code></li><li><code>HOME/.config/containers/registries.conf</code></li></ol><p>\u4E3B\u76EE\u5F55\u4E2D\u7684\u6587\u4EF6\u5E94\u8BE5\u7528\u4E8E\u6839\u636E\u4E2A\u4EBA\u9700\u8981\u914D\u7F6E\u65E0\u6839 Podman\u3002\u9ED8\u8BA4\u60C5\u51B5\u4E0B\u4E0D\u521B\u5EFA\u8FD9\u4E9B\u6587\u4EF6\u3002\u7528\u6237\u53EF\u4EE5\u590D\u5236<code>/usr/share/containers</code>\u6216<code>/etc/containers</code>\u4FEE\u6539\u6587\u4EF6\u3002</p><h4 id="\u6388\u6743\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u6388\u6743\u6587\u4EF6" aria-hidden="true">#</a> \u6388\u6743\u6587\u4EF6</h4><p><code>podman login</code>\u548C\u547D\u4EE4\u4F7F\u7528\u7684\u9ED8\u8BA4\u6388\u6743\u6587\u4EF6<code>podman logout</code>\u4F4D\u4E8E<code>\${XDG_RUNTIME_DIR}/containers/auth.json</code>.</p><h3 id="\u4F7F\u7528\u5377" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528\u5377" aria-hidden="true">#</a> \u4F7F\u7528\u5377</h3><p>Rootless Podman \u4E0D\u662F\uFF0C\u4E5F\u6C38\u8FDC\u4E0D\u4F1A\u662F root\uFF1B\u5B83\u4E0D\u662F<code>setuid</code>\u4E8C\u8FDB\u5236\u6587\u4EF6\uFF0C\u8FD0\u884C\u65F6\u4E0D\u4F1A\u83B7\u5F97\u4EFB\u4F55\u7279\u6743\u3002\u76F8\u53CD\uFF0CPodman \u4F7F\u7528\u7528\u6237\u547D\u540D\u7A7A\u95F4\u6765\u8F6C\u79FB\u5B83\u5728\u4E3B\u673A\u4E0A\uFF08\u901A\u8FC7<code>newuidmap</code>\u548C<code>newgidmap</code>\u53EF\u6267\u884C\u6587\u4EF6\uFF09\u8BBF\u95EE\u7684\u4E00\u7EC4\u7528\u6237\u7684 UID \u548C GID\uFF0C\u4EE5\u53CA Podman \u521B\u5EFA\u7684\u5BB9\u5668\u4E2D\u60A8\u81EA\u5DF1\u7684\u7528\u6237\u3002</p><p>\u5982\u679C\u60A8\u7684\u5BB9\u5668\u4EE5 root \u7528\u6237\u8FD0\u884C\uFF0C\u90A3\u4E48<code>root</code>\u5BB9\u5668\u4E2D\u5B9E\u9645\u4E0A\u662F\u60A8\u5728\u4E3B\u673A\u4E0A\u7684\u7528\u6237\u3002<code>UID/GID 1</code> \u662F\u7528\u6237\u5728<code>/etc/subuid</code>\u548C<code>/etc/subgid</code>\u7B49\u4E2D\u7684\u6620\u5C04\u4E2D\u6307\u5B9A\u7684\u7B2C\u4E00\u4E2A <code>UID/GID</code>\u3002\u5982\u679C\u60A8\u4EE5\u65E0\u6839\u7528\u6237\u8EAB\u4EFD\u5C06\u4E3B\u673A\u4E2D\u7684\u76EE\u5F55\u6302\u8F7D\u5230\u5BB9\u5668\u4E2D\uFF0C\u5E76\u5728\u5BB9\u5668\u4E2D\u4EE5\u6839\u7528\u6237\u8EAB\u4EFD\u5728\u8BE5\u76EE\u5F55\u4E2D\u521B\u5EFA\u6587\u4EF6\uFF0C\u5219\u60A8\u4F1A\u770B\u5230\u5B83\u5B9E\u9645\u4E0A\u7531\u60A8\u7684\u7528\u6237\u5728\u4E3B\u673A\u4E0A\u62E5\u6709\u3002</p><p>\u{1F4A1}\u7B80\u5355\u7684\u4E00\u4E2A\u6848\u4F8B\u5982\u4E0B\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token function">whoami</span>
john

<span class="token comment"># a folder which is empty</span>
host<span class="token operator">&gt;</span> <span class="token function">ls</span> /home/john/folder
host<span class="token operator">&gt;</span> <span class="token function">podman</span> run <span class="token parameter variable">-v</span> /home/john/folder:/container/volume mycontainer /bin/bash

<span class="token comment"># Now I&#39;m in the container</span>
root@container<span class="token operator">&gt;</span> <span class="token function">whoami</span>
root
root@container<span class="token operator">&gt;</span> <span class="token function">touch</span> /container/volume/test
root@container<span class="token operator">&gt;</span> <span class="token function">ls</span> <span class="token parameter variable">-l</span> /container/volume
total <span class="token number">0</span>
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">20</span> <span class="token number">21</span>:47 <span class="token builtin class-name">test</span>
root@container<span class="token operator">&gt;</span> <span class="token builtin class-name">exit</span>

<span class="token comment"># I check again</span>
host<span class="token operator">&gt;</span> <span class="token function">ls</span> <span class="token parameter variable">-l</span> /home/john/folder
total <span class="token number">0</span>
-rw-r--r-- <span class="token number">1</span> john john <span class="token number">0</span> May <span class="token number">20</span> <span class="token number">21</span>:47 <span class="token builtin class-name">test</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6211\u4EEC\u786E\u5B9E\u8BA4\u8BC6\u5230\uFF0C\u8FD9\u5E76\u4E0D\u771F\u6B63\u7B26\u5408\u6709\u591A\u5C11\u4EBA\u6253\u7B97\u4F7F\u7528\u65E0\u6839Podman -\u4ED6\u4EEC\u5E0C\u671B\u4ED6\u4EEC\u7684UID\u5728\u5BB9\u5668\u5185\u5916\u76F8\u5339\u914D\u3002\u56E0\u6B64\uFF0C\u6211\u4EEC\u63D0\u4F9B\u4E86 <code>--userns=keep-id</code> \u6807\u5FD7\uFF0C\u5B83\u786E\u4FDD\u60A8\u7684\u7528\u6237\u6620\u5C04\u5230\u5BB9\u5668\u5185\u81EA\u5DF1\u7684UID\u548CGID\u3002</p><p>\u533A\u5206\u4F5C\u4E3A\u65E0\u6839\u7528\u6237\u8FD0\u884CPodman\u548C\u4E3A\u8FD0\u884C\u65E0\u6839\u7528\u6237\u800C\u6784\u5EFA\u7684\u5BB9\u5668\u4E5F\u5F88\u6709\u5E2E\u52A9\u3002\u5982\u679C\u60A8\u5C1D\u8BD5\u8FD0\u884C\u7684\u5BB9\u5668\u6709\u4E00\u4E2A <code>USER</code> \uFF0C\u800C\u4E0D\u662F\u6839\u76EE\u5F55\uFF0C\u90A3\u4E48\u5728\u6302\u8F7D\u5377\u65F6\uFF0C\u60A8\u5FC5\u987B\u4F7F\u7528 <code>--userns=keep-id</code> \u3002\u8FD9\u662F\u56E0\u4E3A\u5BB9\u5668\u7528\u6237\u5C06\u65E0\u6CD5\u6210\u4E3A <code>root</code> \u5E76\u8BBF\u95EE\u88C5\u8F7D\u7684\u5377\u3002</p><ul><li>\u5728\u63D0\u4F9B\u8981\u7ED1\u5B9A\u88C5\u8F7D\u7684\u76EE\u5F55\u7684\u8DEF\u5F84\u65F6\uFF0C\u9700\u8981\u63D0\u4F9B\u7EDD\u5BF9\u8DEF\u5F84\u6216\u4EE5 <code>.</code> \uFF08\u70B9\uFF09\u5F00\u5934\u7684\u76F8\u5BF9\u8DEF\u5F84\uFF0C\u5426\u5219\u5B57\u7B26\u4E32\u5C06\u88AB\u89E3\u91CA\u4E3A\u5DF2\u547D\u540D\u5377\u7684\u540D\u79F0\u3002</li></ul><h2 id="podman-\u5728-rootless-\u4E0B\u662F\u5982\u4F55\u5DE5\u4F5C\u7684" tabindex="-1"><a class="header-anchor" href="#podman-\u5728-rootless-\u4E0B\u662F\u5982\u4F55\u5DE5\u4F5C\u7684" aria-hidden="true">#</a> Podman \u5728 rootless \u4E0B\u662F\u5982\u4F55\u5DE5\u4F5C\u7684</h2><p>Podman\u662Flibpod\u5E93\u7684\u4E00\u90E8\u5206\uFF0C\u4F7F\u7528\u6237\u80FD\u591F\u7BA1\u7406pod\u3001\u5BB9\u5668\u548C\u5BB9\u5668\u6620\u50CF\u3002</p>`,16),fa=e("\u6211\u4EEC\u5728 "),xa={href:"https://docker.nsddd.top",target:"_blank",rel:"noopener noreferrer"},Da=e("docker "),Ia=e(" \u4E2D\u4E86\u89E3\u5230\uFF0C\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u662F\u5206\u9694\u5BB9\u5668\u7684\u4E00\u4E2A\u5F88\u597D\u7684\u7279\u6027\u3002"),ya=n("strong",null,"\u7528\u6237\u547D\u540D\u7A7A\u95F4\u5141\u8BB8\u6307\u5B9A\u7528\u6237\u6807\u8BC6\u7B26\uFF08UID\uFF09\u548C\u7EC4\u6807\u8BC6\u7B26\uFF08GID\uFF09\u6620\u5C04\u4EE5\u8FD0\u884C\u5BB9\u5668\u3002",-1),Ba=o(`<p>\u8FD9\u610F\u5473\u7740\u60A8\u53EF\u4EE5\u5728\u5BB9\u5668\u5185\u4EE5 <code>UID 0</code> \u8FD0\u884C\uFF0C\u5728\u5BB9\u5668\u5916\u4EE5 <code>UID 100000</code> \u8FD0\u884C\u3002\u5982\u679C\u5BB9\u5668\u8FDB\u7A0B\u8131\u79BB\u5BB9\u5668\uFF0C<strong>\u5185\u6838</strong> \u4F1A\u5C06\u5B83\u4EEC\u89C6\u4E3A <code>UID 100000</code>\u3002</p><p>\u4E0D\u4EC5\u5982\u6B64\uFF0CUID \u62E5\u6709\u7684\u4EFB\u4F55\u6587\u4EF6\u5BF9\u8C61\u5982\u679C\u6CA1\u6709\u6620\u5C04\u5230\u7528\u6237\u540D\u79F0\u7A7A\u95F4\uFF0C\u90FD\u5C06\u88AB\u89C6\u4E3A&quot;nobody&quot;\uFF0865534\uFF0Ckernel. overflowuid\uFF09\u62E5\u6709\uFF0C\u5E76\u4E14\u5BB9\u5668\u8FDB\u7A0B\u5C06\u4E0D\u88AB\u5141\u8BB8\u8BBF\u95EE\uFF0C\u9664\u975E\u8BE5\u5BF9\u8C61\u53EF\u4EE5\u88AB&quot;other&quot;\uFF08\u5B8C\u5168\u53EF\u8BFB/\u53EF\u5199\uFF09\u8BBF\u95EE\u3002</p><p>\u5982\u679C\u60A8\u6709\u4E00\u4E2A\u7531&quot;\u771F\u5B9E&quot;\u6839\u62E5\u6709\u6743\u9650 <code>660</code> \u7684\u6587\u4EF6\uFF0C\u5E76\u4E14\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u4E2D\u7684\u5BB9\u5668\u8FDB\u7A0B\u8BD5\u56FE\u8BFB\u53D6\u5B83\uFF0C\u5219\u5B83\u4EEC\u5C06\u88AB\u963B\u6B62\u8BBF\u95EE\u5B83\uFF0C\u5E76\u5C06\u770B\u5230\u8BE5\u6587\u4EF6\u4E0D\u4E3A\u4EFB\u4F55\u4EBA\u62E5\u6709\u3002</p><p><strong>work theory\uFF1A</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">sudo</span> <span class="token function">bash</span> <span class="token parameter variable">-c</span> <span class="token string">&quot;echo Test &gt; /tmp/test&quot;</span>
$ <span class="token function">sudo</span> <span class="token function">chmod</span> <span class="token number">600</span> /tmp/test 
$ <span class="token function">sudo</span> <span class="token function">ls</span> <span class="token parameter variable">-l</span> /tmp/test 
-rw-------. <span class="token number">1</span> root root <span class="token number">5</span> Dec <span class="token number">17</span> <span class="token number">16</span>:40 /tmp/test
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u63A5\u4E0B\u6765\uFF0C\u6211\u5C06\u6587\u4EF6\u5377\u88C5\u8F7D\u5230\u4E00\u4E2A\u4F7F\u7528\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u6620\u5C04 <code>0\uFF1A100000\uFF1A5000</code> \u8FD0\u884C\u7684\u5BB9\u5668\u4E2D\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>sealer@iZuf~<span class="token punctuation">]</span>$ <span class="token function">sudo</span> <span class="token function">podman</span> run <span class="token parameter variable">-ti</span> <span class="token parameter variable">-v</span> /tmp/test:/tmp/test:Z <span class="token parameter variable">--uidmap</span> <span class="token number">0</span>:100000:5000 fedora <span class="token function">sh</span>
sh-5.2<span class="token comment"># id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span>
sh-5.2<span class="token comment"># ls -al /tmp/test</span>
-rw------- <span class="token number">1</span> nobody nobody <span class="token number">5</span> Feb <span class="token number">10</span> 05:42 /tmp/test
sh-5.2<span class="token comment"># cat /tmp/test</span>
cat: /tmp/test: Permission denied
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>\u5BF9\u4E8E <code>podman</code> \u7684\u547D\u4EE4\u7684\u89E3\u91CA\u8BF4\u660E\uFF1A</p><p>\u4E0A\u9762\u7684 <code>--uidmap</code> \u8BBE\u7F6E\u544A\u8BC9Podman\u5C06\u5BB9\u5668\u5185\u76845000\u4E2AUID\u6620\u5C04\u5230\u5BB9\u5668\u5916\u7684UID 100000\uFF08\u56E0\u6B64\u8303\u56F4\u662F100000 - 104999\uFF09\u5230\u5BB9\u5668\u5185\u7684UID 0\uFF08\u56E0\u6B64\u8303\u56F4\u662F0 - 4999\uFF09\u3002</p></blockquote><p>\u5728\u5BB9\u5668\u5185\uFF0C\u5982\u679C\u6211\u7684\u8FDB\u7A0B\u4EE5UID 1\u8FD0\u884C\uFF0C\u5219\u5B83\u5728\u4E3B\u673A\u4E0A\u4E3A100001</p><p>\u56E0\u4E3A\u771F\u5B9E\u7684\u7684 <code>UID=0</code> \u6CA1\u6709\u6620\u5C04\u5230\u5BB9\u5668\u4E2D\uFF0C\u6240\u4EE5root\u62E5\u6709\u7684\u4EFB\u4F55\u6587\u4EF6\u90FD\u5C06\u88AB\u89C6\u4E3A\u65E0\u4EBA\u62E5\u6709\u3002\u5373\u4F7F\u5BB9\u5668\u5185\u7684\u8FDB\u7A0B\u5177\u6709CAP_DAC_OVERRIDE\uFF0C\u5B83\u4E5F\u4E0D\u80FD\u8986\u76D6\u6B64\u4FDD\u62A4\u3002DAC_OVERRIDE\u4F7F\u6839\u8FDB\u7A0B\u80FD\u591F\u8BFB/\u5199\u7CFB\u7EDF\u4E0A\u7684\u4EFB\u4F55\u6587\u4EF6\uFF0C\u5373\u4F7F\u8BE5\u8FDB\u7A0B\u4E0D\u5F52\u6839\u6240\u6709\u6216\u5B8C\u5168\u4E0D\u53EF\u8BFB\u6216\u53EF\u5199\u3002</p><p>\u7528\u6237\u547D\u540D\u7A7A\u95F4\u6743\u80FD\u4E0E\u4E3B\u673A\u4E0A\u7684\u6743\u80FD\u4E0D\u540C\u3002\u5B83\u4EEC\u662F\u547D\u540D\u7A7A\u95F4\u6743\u80FD\u3002\u8FD9\u610F\u5473\u7740\u6211\u7684\u5BB9\u5668\u6839\u76EE\u5F55\uFF08rootfs)\u4EC5\u5728\u5BB9\u5668\u5185\u5177\u6709\u529F\u80FD-\u5B9E\u9645\u4E0A\u4EC5\u5728\u6620\u5C04\u5230\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u7684UID\u8303\u56F4\u5185\u5177\u6709\u529F\u80FD\u3002</p><p>\u5982\u679C\u4E00\u4E2A\u5BB9\u5668\u8FDB\u7A0B\u8131\u79BB\u4E86\u5BB9\u5668\uFF0C\u90A3\u4E48\u5B83\u5C06\u4E0D\u5177\u6709\u4EFB\u4F55\u9488\u5BF9\u672A\u6620\u5C04\u5230\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u7684UID\uFF08\u5305\u62ECUID=0\uFF09\u7684\u529F\u80FD\u3002</p><p>\u5373\u4F7F\u8FDB\u7A0B\u53EF\u4EE5\u4EE5\u67D0\u79CD\u65B9\u5F0F\u8FDB\u5165\u53E6\u4E00\u4E2A\u5BB9\u5668\uFF0C\u5982\u679C\u5BB9\u5668\u4F7F\u7528\u4E0D\u540C\u8303\u56F4\u7684UID\uFF0C\u5B83\u4EEC\u4E5F\u4E0D\u4F1A\u5177\u6709\u8FD9\u4E9B\u529F\u80FD\u3002</p><h3 id="\u4F7F\u7528-podman-top-\u663E\u793A\u7528\u6237\u540D\u79F0\u7A7A\u95F4" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528-podman-top-\u663E\u793A\u7528\u6237\u540D\u79F0\u7A7A\u95F4" aria-hidden="true">#</a> \u4F7F\u7528\u201Cpodman top\u201D\u663E\u793A\u7528\u6237\u540D\u79F0\u7A7A\u95F4</h3><p>\u4F7F\u7528UID\u6620\u5C04\u8FD0\u884C\u4E00\u4E2A\u4F11\u7720\u5BB9\u5668\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">sudo</span> <span class="token function">podman</span> run <span class="token parameter variable">--uidmap</span> <span class="token number">0</span>:100000:5000 <span class="token parameter variable">-d</span> fedora <span class="token function">sleep</span> <span class="token number">1000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u73B0\u5728\u5C31\u53EF\u4EE5 \u8FD0\u884C <code>podman</code> :</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$  <span class="token function">sudo</span> <span class="token function">podman</span> <span class="token function">top</span> <span class="token parameter variable">--latest</span> user huser
<span class="token environment constant">USER</span>   HUSER
root   ?

$ <span class="token function">ps</span> <span class="token parameter variable">-ef</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token function">sleep</span>
sealer    <span class="token number">1513</span> <span class="token number">30899</span>  <span class="token number">0</span> <span class="token number">14</span>:00 pts/1    00:00:00 <span class="token function">grep</span> <span class="token parameter variable">--color</span><span class="token operator">=</span>auto <span class="token function">sleep</span>
<span class="token number">100000</span>   <span class="token number">31026</span> <span class="token number">31014</span>  <span class="token number">0</span> <span class="token number">13</span>:58 ?        00:00:00 <span class="token function">sleep</span> <span class="token number">1000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6CE8\u610F\uFF0C<code>podman top</code> \u62A5\u544A\u7528\u6237\u8FDB\u7A0B\u5728\u5BB9\u5668\u5185\u4EE5root\u8EAB\u4EFD\u8FD0\u884C\uFF0C\u4F46\u5728\u4E3B\u673A\uFF08HUSER\uFF09\u4E0A\u4EE5<code>UID 100000</code> \u8FD0\u884C\u3002ps\u547D\u4EE4\u8FD8\u786E\u8BA4\u4F11\u7720\u8FDB\u7A0B\u6B63\u5728\u4EE5 <code>UID 100000 </code>\u8FD0\u884C\u3002</p><p>\u73B0\u5728\u8BA9\u6211\u4EEC\u8FD0\u884C\u7B2C\u4E8C\u4E2A\u5BB9\u5668\uFF0C\u4F46\u8FD9\u6B21\u6211\u4EEC\u5C06\u9009\u62E9\u4E00\u4E2A\u4ECE <code>200000</code> \u5F00\u59CB\u7684\u5355\u72ECUID\u6620\u5C04\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">sudo</span> <span class="token function">podman</span> run <span class="token parameter variable">--uidmap</span> <span class="token number">0</span>:200000:5000 <span class="token parameter variable">-d</span> fedora <span class="token function">sleep</span> <span class="token number">1000</span>
b5d72d262f89d1db0bc60ebdd2ef3ddc425932c593e83d2991f5921f563d9766

$ <span class="token function">sudo</span> <span class="token function">podman</span> <span class="token function">top</span> <span class="token parameter variable">--latest</span> user huser
<span class="token environment constant">USER</span>   HUSER
root   ?

$ <span class="token function">ps</span> <span class="token parameter variable">-ef</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token function">sleep</span>
<span class="token number">200000</span>    <span class="token number">6466</span>  <span class="token number">6454</span>  <span class="token number">0</span> <span class="token number">14</span>:04 ?        00:00:00 <span class="token function">sleep</span> <span class="token number">1000</span>
sealer    <span class="token number">6985</span> <span class="token number">30899</span>  <span class="token number">0</span> <span class="token number">14</span>:05 pts/1    00:00:00 <span class="token function">grep</span> <span class="token parameter variable">--color</span><span class="token operator">=</span>auto <span class="token function">sleep</span>
<span class="token number">100000</span>   <span class="token number">31026</span> <span class="token number">31014</span>  <span class="token number">0</span> <span class="token number">13</span>:58 ?        00:00:00 <span class="token function">sleep</span> <span class="token number">1000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u26A0\uFE0F \u6CE8\u610F\uFF0C<code>podman top</code> \u62A5\u544A\u7B2C\u4E8C\u4E2A\u5BB9\u5668\u5728\u5BB9\u5668\u5185\u4EE5root\u7528\u6237\u8EAB\u4EFD\u8FD0\u884C\uFF0C\u4F46\u5728\u4E3B\u673A\u4E0A\u7684<code>UID=200000</code>\u3002</p><p>\u8FD8\u53EF\u4EE5\u67E5\u770Bps\u547D\u4EE4-\u5B83\u663E\u793A\u4E24\u4E2A\u4F11\u7720\u8FDB\u7A0B\u90FD\u5728\u8FD0\u884C\uFF1A\u4E00\u4E2A\u4E3A100000\uFF0C\u53E6\u4E00\u4E2A\u4E3A200000\u3002</p><p>\u8FD9\u610F\u5473\u7740\u5728\u5355\u72EC\u7684\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u4E2D\u8FD0\u884C\u5BB9\u5668\u53EF\u4EE5\u5728\u8FDB\u7A0B\u4E4B\u95F4\u63D0\u4F9B\u4F20\u7EDF\u7684UID\u5206\u79BB\uFF0C\u8FD9\u4ECE\u4E00\u5F00\u59CB\u5C31\u662F Linux/Unix \u7684\u6807\u51C6\u5B89\u5168\u5DE5\u5177\u3002</p><h3 id="user-namaspace" tabindex="-1"><a class="header-anchor" href="#user-namaspace" aria-hidden="true">#</a> user namaspace</h3><p>\u5728\u5BB9\u5668\u4E2D\uFF0C\u60A8\u5E0C\u671B\u5728\u591A\u4E2A\u5BB9\u5668\u4E4B\u95F4\u5171\u4EAB\u57FA\u672C\u6620\u50CF\u3002\u4E0A\u9762\u7684\u4F8B\u5B50\u5728\u6BCF\u4E2A\u4F8B\u5B50\u4E2D\u90FD\u4F7F\u7528\u4E86Fedora\u57FA\u7840\u6620\u50CF\u3002Fedora\u6620\u50CF\u4E2D\u7684\u5927\u591A\u6570\u6587\u4EF6\u90FD\u662F\u771F\u5B9E\u7684 <code>UID=0</code> \u7684\u6587\u4EF6\u3002</p><p>\u5982\u679C\u6211\u5728\u8FD9\u4E2A\u6620\u50CF\u4E0A\u8FD0\u884C\u4E00\u4E2A\u5BB9\u5668\uFF0C\u5176\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u4E3A <code>0\uFF1A100000\uFF1A5000</code>\uFF0C\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u5B83\u4F1A\u5C06\u6240\u6709\u8FD9\u4E9B\u6587\u4EF6\u89C6\u4E3A\u65E0\u4EBA\u62E5\u6709\uFF0C\u56E0\u6B64\u6211\u4EEC\u9700\u8981\u79FB\u52A8\u6240\u6709\u8FD9\u4E9BUID\u4EE5\u5339\u914D\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u3002</p><p>Podman\u53EF\u4EE5\u5728\u540C\u4E00\u4E2A\u6620\u50CF\u4E0A\u4F7F\u7528\u4E0D\u540C\u7684\u7528\u6237\u540D\u79F0\u7A7A\u95F4\uFF0C\u56E0\u4E3ANalin Dahyabhai\u9886\u5BFC\u7684\u56E2\u961F\u5728\u5BB9\u5668/\u5B58\u50A8\u4E2D\u5185\u7F6E\u4E86\u81EA\u52A8<code>chowning</code>\u3002Podman\u4F7F\u7528\u5BB9\u5668/\u5B58\u50A8\uFF0C\u5E76\u4E14Podman\u7B2C\u4E00\u6B21\u5728\u65B0\u7528\u6237\u547D\u540D\u7A7A\u95F4\u4E2D\u4F7F\u7528\u5BB9\u5668\u6620\u50CF\u65F6\uFF0C\u5BB9\u5668/\u5B58\u50A8\u201Cchowns\u201D\uFF08\u5373\u6539\u53D8\u6240\u6709\u6743\uFF09\u6620\u50CF\u4E2D\u7684\u6240\u6709\u6587\u4EF6\u6620\u5C04\u5230\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u4E2D\u6620\u5C04\u7684UID\uFF0C\u5E76\u521B\u5EFA\u65B0\u6620\u50CF\u3002\u5C06\u6B64\u56FE\u50CF\u89C6\u4E3A\uFF1A<code>0\uFF1A100000\uFF1A5000</code> \u56FE\u50CF\u3002</p><p>\u5F53Podman\u5728\u5177\u6709\u76F8\u540CUID\u6620\u5C04\u7684\u6620\u50CF\u4E0A\u8FD0\u884C\u53E6\u4E00\u4E2A\u5BB9\u5668\u65F6\uFF0C\u5B83\u4F7F\u7528\u201C\u9884chowned\u201D\u6620\u50CF\u3002\u5F53\u6211\u5728 <code>0\uFF1A200000\uFF1A5000</code>\u4E0A\u8FD0\u884C\u7B2C\u4E8C\u4E2A\u5BB9\u5668\u65F6\uFF0C<code>containers/storage</code> \u4F1A\u521B\u5EFA\u7B2C\u4E8C\u4E2A\u6620\u50CF\uFF0C\u6211\u4EEC\u5C06\u5176\u547D\u540D\u4E3A<code>fedora\uFF1A0\uFF1A200000\uFF1A5000</code>\u3002</p><p>\u6CE8\u610F\uFF0C\u5982\u679C\u60A8\u6B63\u5728\u6267\u884Cpodman\u6784\u5EFA\u6216podman\u63D0\u4EA4\uFF0C\u5E76\u5C06\u65B0\u521B\u5EFA\u7684\u6620\u50CF\u63A8\u9001\u5230\u5BB9\u5668\u6CE8\u518C\u8868\u4E2D\uFF0C\u5219Podman\u5C06\u4F7F\u7528\u5BB9\u5668/\u5B58\u50A8\u6765\u53CD\u5411\u8F6C\u6362\uFF0C\u5E76\u5C06\u5305\u542B\u6240\u6709\u6587\u4EF6\u7684\u6620\u50CF\u63A8\u56DE\u771F\u5B9E\u7684UID=0\u3002</p><p>\u8FD9\u53EF\u80FD\u4F1A\u5BFC\u81F4\u5728\u65B0UID\u6620\u5C04\u4E2D\u521B\u5EFA\u5BB9\u5668\u7684\u771F\u5B9E\u7684\u6162\uFF0C\u56E0\u4E3Achown\u53EF\u80FD\u4F1A\u5F88\u6162\uFF0C\u5177\u4F53\u53D6\u51B3\u4E8E\u6620\u50CF\u4E2D\u7684\u6587\u4EF6\u6570\u91CF\u3002\u540C\u6837\uFF0C\u5728\u666E\u901A\u7684 <code>OverlayFS</code> \u4E0A\uFF0C\u6620\u50CF\u4E2D\u7684\u6BCF\u4E2A\u6587\u4EF6\u90FD\u88AB\u590D\u5236\u3002\u6B63\u5E38\u7684Fedora\u6620\u50CF\u53EF\u80FD\u9700\u898130\u79D2\u6765\u5B8C\u6210chown\u5E76\u542F\u52A8\u5BB9\u5668\u3002</p><h3 id="going-forward" tabindex="-1"><a class="header-anchor" href="#going-forward" aria-hidden="true">#</a> going forward</h3><p>\u6211\u60F3\u7ED9Podman\u6DFB\u52A0\u4E00\u4E2A\u65B0\u7684\u6807\u5FD7\uFF0C\u6BD4\u5982 <code>--userns=auto</code>\uFF0C\u544A\u8BC9\u5B83\u4E3A\u60A8\u8FD0\u884C\u7684\u6BCF\u4E2A\u5BB9\u5668\u81EA\u52A8\u9009\u62E9\u4E00\u4E2A\u552F\u4E00\u7684\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u3002\u8FD9\u7C7B\u4F3C\u4E8ESELinux\u4F7F\u7528\u5355\u72EC\u7684\u591A\u7C7B\u522B\u5B89\u5168\uFF08MCS\uFF09\u6807\u7B7E\u7684\u65B9\u5F0F\u3002\u5982\u679C\u8BBE\u7F6E\u73AF\u5883\u53D8\u91CF <code>PODMAN_USERNS=auto</code>\uFF0C\u5219\u751A\u81F3\u4E0D\u9700\u8981\u8BBE\u7F6E\u6807\u5FD7\u3002</p><p>Podman\u7EC8\u4E8E\u5141\u8BB8\u7528\u6237\u5728\u5355\u72EC\u7684\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u4E2D\u8FD0\u884C\u5BB9\u5668\u3002\u50CF<code>Buildah</code>\u548C<code>CRI-O</code>\u8FD9\u6837\u7684\u5DE5\u5177\u4E5F\u5C06\u80FD\u591F\u5229\u7528\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u3002\u4F46\u662F\u5BF9\u4E8E CRI-O\uFF0CKubernetes\u9700\u8981\u4E86\u89E3\u54EA\u4E2A\u7528\u6237\u547D\u540D\u7A7A\u95F4\u5C06\u8FD0\u884C\u5BB9\u5668\u5F15\u64CE\uFF0C\u4E0A\u6E38\u6B63\u5728\u5904\u7406\u8FD9\u4E2A\u95EE\u9898\u3002</p><p>\u5728\u6211\u770B\u6765\uFF0C\u6700\u597D\u7684\u7279\u6027\u662F\u4EE5\u975Eroot\u7528\u6237\u8EAB\u4EFD\u8FD0\u884CPodman\u548Ccontainers\u3002\u8FD9\u610F\u5473\u7740\u60A8\u4ECE\u672A\u5728\u4E3B\u673A\u4E0A\u7ED9\u4E88\u7528\u6237root\u6743\u9650\uFF0C\u800C\u5728\u5BA2\u6237\u673A/\u670D\u52A1\u5668\u6A21\u578B\u4E2D\uFF08\u5982Docker\u4F7F\u7528\u7684\uFF09\uFF0C\u60A8\u5FC5\u987B\u6253\u5F00\u4E00\u4E2A\u5957\u63A5\u5B57\uFF0C\u8FDE\u63A5\u5230\u4EE5root\u8EAB\u4EFD\u8FD0\u884C\u7684\u7279\u6743\u5B88\u62A4\u8FDB\u7A0B\u4EE5\u542F\u52A8\u5BB9\u5668\u3002\u8FD9\u6837\uFF0C\u60A8\u5C31\u5904\u4E8E\u5B88\u62A4\u8FDB\u7A0B\u4E2D\u5B9E\u73B0\u7684\u5B89\u5168\u673A\u5236\u4E0E\u4E3B\u673A\u64CD\u4F5C\u7CFB\u7EDF\u4E2D\u5B9E\u73B0\u7684\u5B89\u5168\u673A\u5236\u4E4B\u95F4--\u8FD9\u662F\u4E00\u4E2A\u5371\u9669\u7684\u547D\u9898\u3002</p><h3 id="podman-\u5982\u4F55\u521B\u5EFA\u7528\u6237\u540D\u79F0\u7A7A\u95F4" tabindex="-1"><a class="header-anchor" href="#podman-\u5982\u4F55\u521B\u5EFA\u7528\u6237\u540D\u79F0\u7A7A\u95F4" aria-hidden="true">#</a> Podman \u5982\u4F55\u521B\u5EFA\u7528\u6237\u540D\u79F0\u7A7A\u95F4</h3><p>\u5927\u591A\u6570\u5F53\u524D\u7684Linux\u53D1\u884C\u7248\u90FD\u5305\u542B\u4E00\u4E2A <code>shadow-utils</code> \u7248\u672C\uFF0C\u8BE5\u7248\u672C\u4F7F\u7528/etc/subuid\u548C <code>/etc/subgid</code> \u6587\u4EF6\u6765\u786E\u5B9A\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u4E2D\u7684\u7528\u6237\u53EF\u7528\u7684UID\u548CGID\u3002</p><p><strong>\u6211\u4EEC\u521B\u5EFA\u7528\u6237\u7684\u7528\u6237\u7EC4\u7684\u547D\u4EE4\u5F88\u719F\u7EC3\u4E86\uFF1A</strong></p><p><code>useradd</code>\u7A0B\u5E8F\u4E3A\u6DFB\u52A0\u5230\u7CFB\u7EDF\u7684\u6BCF\u4E2A\u7528\u6237\u81EA\u52A8\u5206\u914D<code>65536</code>\u4E2A<code>UID</code>\u3002\u5982\u679C <strong>\u7CFB\u7EDF\u4E0A\u5DF2\u6709\u7528\u6237\uFF0C\u5219\u9700\u8981\u81EA\u5DF1\u5206\u914DUID</strong>\u3002\u8FD9\u4E9B\u6587\u4EF6\u7684\u683C\u5F0F\u4E3A\u7528\u6237\u540D\uFF1A<code>STARTUID\uFF1ATOTALUIDS</code>\u3002</p><p>\u8FD9\u610F\u5473\u7740<code>dwalsh</code>\u88AB\u5206\u914D\u4E86 <code>UID 100000</code> \u5230 <code>165535</code> \u6CBF\u7740\u6211\u7684\u9ED8\u8BA4<code>UID</code>\uFF0C\u5B83\u6070\u597D\u662F\u5728 <code>/etc/passwd</code> \u4E2D\u5B9A\u4E49\u76843265\u3002\u5728\u5206\u914D\u8FD9\u4E9BUID\u8303\u56F4\u65F6\u9700\u8981\u5C0F\u5FC3\uFF0C\u4E0D\u8981\u4E0E\u7CFB\u7EDF\u4E0A\u7684\u4EFB\u4F55realUID\u91CD\u53E0\u3002\u5982\u679C\u60A8\u6709\u4E00\u4E2A\u7528\u6237\u88AB\u5217\u4E3A <code>UID 100001</code>\uFF0C\u73B0\u5728\u6211\uFF08dwalsh\uFF09\u5C06\u80FD\u591F\u6210\u4E3A\u8FD9\u4E2AUID\uFF0C\u5E76\u53EF\u80FD\u8BFB\u53D6/\u5199\u5165/\u6267\u884C\u8BE5UID\u6240\u62E5\u6709\u7684\u6587\u4EF6\u3002</p><p><code>Shadow-utils</code> \u8FD8\u6DFB\u52A0\u4E86\u4E24\u4E2A<code>setuid</code>\u7A0B\u5E8F\uFF08\u6216<code>setfilecap</code>\uFF09\u3002\u5728Fedora\u4E0A\u6211\u6709\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># getcap /usr/bin/newuidmap</span>
/usr/bin/newuidmap <span class="token operator">=</span> cap_setuid+ep
<span class="token comment"># getcap /usr/bin/newgidmap</span>
/usr/bin/newgidmap <span class="token operator">=</span> cap_setgid+ep
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Podman\u6267\u884C\u8FD9\u4E9B\u6587\u4EF6\u6765\u8BBE\u7F6E\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u3002\u60A8\u53EF\u4EE5\u901A\u8FC7\u4ECE\u65E0\u6839\u5BB9\u5668\u5185\u90E8\u68C0\u67E5 <code>/proc/self/uid_map</code> \u548C <code>/proc/self/gid_map</code> \u6765\u67E5\u770B\u6620\u5C04\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">podman</span> run alpine <span class="token function">cat</span> /proc/self/uid_map /proc/self/gid_map
     	<span class="token number">0</span>   	<span class="token number">3267</span>      	<span class="token number">1</span>
     	<span class="token number">1</span> 	<span class="token number">100000</span>  	<span class="token number">65536</span>
     	<span class="token number">0</span>   	<span class="token number">3267</span>      	<span class="token number">1</span>
     	<span class="token number">1</span> 	<span class="token number">100000</span>  	<span class="token number">65536</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5982\u4E0A\u6240\u8FF0\uFF0CPodman\u9ED8\u8BA4\u5C06\u5BB9\u5668\u4E2D\u7684\u6839\u6620\u5C04\u5230\u60A8\u5F53\u524D\u7684UID\uFF083267\uFF09\uFF0C\u7136\u540E\u6620\u5C04 <code>/etc/subuid</code> \u548C <code>/etc/subgid</code> \u4E2D\u4ECE1\u5F00\u59CB\u7684\u5DF2\u5206\u914DUID/GID\u7684\u8303\u56F4\u3002</p><p>UID=1\u7684\u5BB9\u5668\u662FUID 100000\uFF0CUID=2\u7684\u5BB9\u5668\u662FUID 100001\uFF0C\u4E00\u76F4\u523065536\uFF0C\u5373165535\u3002</p><p>\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u4E4B\u5916\u7684\u4EFB\u4F55\u9879\uFF0C\u5982\u679C\u7531\u672A\u6620\u5C04\u5230\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u7684UID\u6216GID\u62E5\u6709\uFF0C\u5219\u770B\u8D77\u6765\u5C5E\u4E8E\u5728\u5185\u6838\u4E2D\u914D\u7F6E\u7684\u7528\u6237\u3002overflowuid sysctl\uFF0C\u9ED8\u8BA4\u503C\u4E3A35534\uFF0C\u6211\u7684/etc/passwd\u6587\u4EF6\u5C06\u5176\u547D\u540D\u4E3Anobody\u3002\u7531\u4E8E\u60A8\u7684\u8FDB\u7A0B\u4E0D\u80FD\u4EE5\u672A\u6620\u5C04\u7684ID\u8FD0\u884C\uFF0C\u56E0\u6B64\u6240\u6709\u8005\u548C\u7EC4\u6743\u9650\u4E0D\u9002\u7528\uFF0C\u56E0\u6B64\u60A8\u53EA\u80FD\u57FA\u4E8E\u5B83\u4EEC\u7684\u201C\u5176\u4ED6\u201D\u6743\u9650\u8BBF\u95EE\u8FD9\u4E9B\u6587\u4EF6\u3002\u8FD9\u5305\u62EC\u8FD0\u884C\u5BB9\u5668\u7684\u7CFB\u7EDF\u4E0A\u771F\u5B9E\u7684root\u62E5\u6709\u7684\u6240\u6709\u6587\u4EF6\uFF0C\u56E0\u4E3Aroot\u6CA1\u6709\u6620\u5C04\u5230\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u3002</p>`,47),Pa={href:"https://github.com/containers/buildah/blob/main/docs/buildah-unshare.1.md",target:"_blank",rel:"noopener noreferrer"},wa=e("buildah unshare"),Ea=e("\u4F1A\u5C06\u60A8\u7F6E\u4E8EPodman\u8FD0\u884C\u6240\u5728\u7684\u7528\u6237 (sealer) \u540D\u79F0\u7A7A\u95F4\u4E2D\uFF0C\u4F46\u4E0D\u9700\u8981\u8FDB\u5165\u5BB9\u5668\u7684\u6587\u4EF6\u7CFB\u7EDF\uFF0C\u56E0\u6B64\u60A8\u53EF\u4EE5\u5217\u51FA\u4E3B\u76EE\u5F55\u7684\u5185\u5BB9\u3002"),Ua=o(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">ls</span> <span class="token parameter variable">-ild</span> /home/sealer 
<span class="token number">131079</span> drwx------ <span class="token number">10</span> sealer root <span class="token number">4096</span> Feb <span class="token number">10</span> <span class="token number">13</span>:46 /home/sealer

$ buildah unshare <span class="token function">ls</span> <span class="token parameter variable">-ld</span> /home/sealer 
drwx------ <span class="token number">10</span> root root <span class="token number">4096</span> Feb <span class="token number">10</span> <span class="token number">13</span>:46 /home/sealer
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6CE8\u610F\uFF0C\u5F53\u5217\u51FA\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u4E4B\u5916\u7684 <code>home dir</code> \u5C5E\u6027\u65F6\uFF0C\u5185\u6838\u5C06\u6240\u6709\u6743\u62A5\u544A\u4E3A <code>sealer</code>\uFF0C\u800C\u5728\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u4E4B\u5185\uFF0C\u5B83\u5C06\u76EE\u5F55\u62A5\u544A\u4E3A <code>root</code>\u6240\u6709\u3002</p><p>\u8FD9\u662F\u56E0\u4E3A\u4E3B\u76EE\u5F55\u5F523267\u6240\u6709\uFF0C\u5E76\u4E14\u5728\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u4E2D\uFF0C\u6211\u4EEC\u5C06\u8BE5UID\u89C6\u4E3A <code>rootfs</code> \u3002</p><h3 id="\u8BBE\u7F6E\u547D\u540D\u7A7A\u95F4\u540E-podman-\u63A5\u4E0B\u6765\u4F1A\u53D1\u751F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u8BBE\u7F6E\u547D\u540D\u7A7A\u95F4\u540E-podman-\u63A5\u4E0B\u6765\u4F1A\u53D1\u751F\u4EC0\u4E48" aria-hidden="true">#</a> \u8BBE\u7F6E\u547D\u540D\u7A7A\u95F4\u540E\uFF0Cpodman \u63A5\u4E0B\u6765\u4F1A\u53D1\u751F\u4EC0\u4E48</h3><p><code>Podman</code>\u4F7F\u7528 <code>containers/storage</code> \u6765\u62C9\u53D6\u5BB9\u5668\u6620\u50CF\uFF0C<code>containers/storage</code> \u975E\u5E38\u667A\u80FD\uFF0C<strong>\u53EF\u4EE5\u5C06\u6620\u50CF\u4E2D <code>root</code> \u62E5\u6709\u7684\u6240\u6709\u6587\u4EF6\u6620\u5C04\u5230\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u7684 \u6839\uFF08rootfs)</strong>\uFF0C\u5E76\u5C06\u4E0D\u540C UID \u62E5\u6709\u7684\u4EFB\u4F55\u5176\u4ED6\u6587\u4EF6\u6620\u5C04\u5230\u5B83\u4EEC\u7684\u7528\u6237\u540D\u79F0\u7A7A\u95F4 UID\u3002\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u6B64\u5185\u5BB9\u5C06\u5199\u5165 <code>~/</code>\u3002</p><p><strong>\u672C\u5730/\u5171\u4EAB/\u5BB9\u5668/\u5B58\u50A8</strong>\u3002\u5BB9\u5668\u5B58\u50A8\u5728 <code>vfs</code> \u6A21\u5F0F\u6216<code>Overlay</code>\u4E0B\u7684 rootless (non root) \u4E0B\u5DE5\u4F5C\u3002\u6CE8\uFF1A\u53EA\u6709\u5B89\u88C5\u4E86<code>fuse-overlayfs</code>\u53EF\u6267\u884C\u6587\u4EF6\uFF0C\u624D\u652F\u6301\u8986\u76D6\u3002</p><p>\u5185\u6838\u53EA\u5141\u8BB8\u7528\u6237\u547D\u540D\u7A7A\u95F4\u6839\u6302\u8F7D\u67D0\u4E9B\u7C7B\u578B\u7684\u6587\u4EF6\u7CFB\u7EDF\uFF1B\u73B0\u5728\u5B83\u5141\u8BB8\u6302\u8F7D<code>procfs</code>\uFF0C<code>sysfs</code>\uFF0C<code>tmpfs</code>\uFF0C<code>fusefs</code>\u548C<code>bind</code>\u6302\u8F7D\uFF08\u53EA\u8981\u6E90\u548C\u76EE\u6807\u662F\u7531\u8FD0\u884CPodman\u7684\u7528\u6237\u62E5\u6709\u7684\u3002</p><p>\u5982\u679C\u96C6\u88C5\u7BB1\u4F7F\u7528\u4FDD\u9669\u4E1D\u8986\u76D6\uFF0C\u5219<code>Podman</code>\u5B89\u88C5\u96C6\u88C5\u7BB1\u7684\u5B58\u50A8\u5668;\u5982\u679C\u5B58\u50A8\u9A71\u52A8\u5668\u4F7F\u7528vfs\uFF0C\u5219\u4E0D\u9700\u8981\u5B89\u88C5\u3002vfs\u4E0A\u7684<code>podman</code>\u9700\u8981\u5927\u91CF\u7684\u7A7A\u95F4\uFF0C\u56E0\u4E3A\u6BCF\u4E2A\u5BB9\u5668\u590D\u5236\u6574\u4E2A\u5E95\u5C42\u6587\u4EF6\u7CFB\u7EDF\u3002</p><p>\u7136\u540E\uFF0CPodman\u6302\u8F7D <code>/proc</code>\u548C <code>/sys</code>\u6CBF\u7740\u4E00\u4E9B<code>tmpfs</code>\uFF0C\u5E76\u5728\u5BB9\u5668\u4E2D\u521B\u5EFA\u8BBE\u5907\u3002</p><p>\u4E3A\u4E86\u4F7F\u7528\u4E3B\u673A\u7F51\u7EDC\u4EE5\u5916\u7684\u7F51\u7EDC\uFF0C<strong>Podman \u4F7F\u7528 slirp 4 netns \u7A0B\u5E8F\u4E3A\u975E\u7279\u6743\u7F51\u7EDC\u540D\u79F0\u7A7A\u95F4\u8BBE\u7F6E\u7528\u6237\u6A21\u5F0F\u7F51\u7EDC</strong>\u3002Slirp 4 netns\u5141\u8BB8 Podman \u5411\u4E3B\u673A\u516C\u5F00\u5BB9\u5668\u5185\u7684\u7AEF\u53E3\u3002\u6CE8\u610F\uFF0C\u5185\u6838\u4ECD\u7136\u4E0D\u5141\u8BB8\u975E\u7279\u6743\u8FDB\u7A0B\u7ED1\u5B9A\u5230\u5C0F\u4E8E1024\u7684\u7AEF\u53E3\u3002\u9700\u8981Podman-1.1\u6216\u66F4\u9AD8\u7248\u672C\u624D\u80FD\u7ED1\u5B9A\u5230\u7AEF\u53E3\u3002</p><p>Rootless Podman\u53EF\u4EE5\u4F7F\u7528\u7528\u6237\u540D\u79F0\u7A7A\u95F4\u8FDB\u884C\u5BB9\u5668\u5206\u79BB\uFF0C\u4F46\u662F\u60A8\u53EA\u80FD\u8BBF\u95EE <code>/etc/subuid</code> \u6587\u4EF6\u4E2D\u5B9A\u4E49\u7684UID\u3002</p><h2 id="links" tabindex="-1"><a class="header-anchor" href="#links" aria-hidden="true">#</a> Links</h2>`,12),$a={href:"https://github.com/containers/podman/blob/main/docs/tutorials/rootless_tutorial.md",target:"_blank",rel:"noopener noreferrer"},Oa=e("Podman \u5728\u65E0\u6839\u73AF\u5883\u4E2D\u7684\u57FA\u672C\u8BBE\u7F6E\u548C\u4F7F\u7528\u3002"),Ca={href:"https://github.com/containers/buildah/issues/2325",target:"_blank",rel:"noopener noreferrer"},qa=e("\u975Eroot\u7528\u6237\u5982\u4F55\u4F7F\u7528buildah"),Ra={href:"https://github.com/containers/buildah/blob/main/install.md",target:"_blank",rel:"noopener noreferrer"},Aa=e("\u5B89\u88C5\u6587\u6863"),Sa={href:"https://opensource.com/article/19/2/how-does-rootless-podman-work",target:"_blank",rel:"noopener noreferrer"},La=e("Podman \u5728 rootless \u6A21\u5F0F\u4E0B\u662F\u5982\u4F55\u5DE5\u4F5C\u7684"),Na={href:"https://opensource.com/article/18/12/podman-and-user-namespaces",target:"_blank",rel:"noopener noreferrer"},Ga=e("Podman \u5728\u5355\u72EC\u7684\u540D\u79F0\u7A7A\u95F4\u4E2D\u8FD0\u884C\u5BB9\u5668\u7684"),Fa={href:"https://github.com/containers/buildah/blob/main/docs/buildah-unshare.1.md",target:"_blank",rel:"noopener noreferrer"},Ma=e('buildah-unshare "1" "June 2018" "buildah"'),Ta={href:"https://github.com/containers/buildah/blob/main/docs/buildah-mount.1.md",target:"_blank",rel:"noopener noreferrer"},Ha=e('buildah-mount "1" "March 2017" "buildah"'),ja=n("hr",null,null,-1),Va=n("ul",null,[n("li",null,[n("div",null,[n("a",{href:"24.md",style:{float:"left"}},"\u2B06\uFE0F\u4E0A\u4E00\u8282\u{1F517} "),n("a",{href:"26.md",style:{float:"right"}}," \uFE0F\u4E0B\u4E00\u8282\u{1F517}")])])],-1),za=e("\u24C2\uFE0F\u56DE\u5230\u76EE\u5F55\u{1F3E0}"),Ja={href:"https://nsddd.top/archives/contributors",target:"_blank",rel:"noopener noreferrer"},Xa=n("strong",null,"\u{1FAF5}\u53C2\u4E0E\u8D21\u732E\u{1F49E}\u2764\uFE0F\u200D\u{1F525}\u{1F496}",-1),Ka=e(")"),Ya=e("\u2734\uFE0F\u7248\u6743\u58F0\u660E \xA9 \uFF1A\u672C\u4E66\u6240\u6709\u5185\u5BB9\u9075\u5FAA"),Za={href:"http://zh.wikipedia.org/wiki/Wikipedia:CC-by-sa-3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC",target:"_blank",rel:"noopener noreferrer"},Wa=e("CC-BY-SA 3.0\u534F\u8BAE\uFF08\u7F72\u540D-\u76F8\u540C\u65B9\u5F0F\u5171\u4EAB\uFF09\xA9");function Qa(no,eo){const a=i("ExternalLinkIcon"),t=i("RouterLink");return l(),c("div",null,[n("ul",null,[n("li",null,[n("a",u,[h,s(a)])])]),b,m,v,n("blockquote",null,[n("p",null,[g,n("a",k,[_,s(a)]),f,n("a",x,[D,s(a)]),I,n("a",y,[B,s(a)])])]),P,w,E,n("ul",null,[n("li",null,[n("a",U,[$,s(a)])])]),n("p",null,[O,n("a",C,[q,s(a)]),R,n("a",A,[S,s(a)]),L,n("a",N,[G,s(a)]),F]),M,n("p",null,[T,n("a",H,[j,s(a)]),V]),z,J,X,K,n("p",null,[Y,n("a",Z,[W,s(a)]),Q,n("a",nn,[en,s(a)]),sn,n("a",an,[on,s(a)]),tn]),dn,n("p",null,[ln,n("a",cn,[rn,s(a)]),pn]),un,n("p",null,[n("a",hn,[bn,s(a)])]),mn,n("p",null,[vn,n("a",gn,[kn,s(a)]),_n,n("a",fn,[xn,s(a)]),Dn]),In,n("p",null,[yn,n("a",Bn,[Pn,s(a)]),wn,En]),n("ul",null,[n("li",null,[n("a",Un,[$n,s(a)])])]),On,n("p",null,[Cn,qn,Rn,n("a",An,[Sn,s(a)]),Ln]),Nn,n("p",null,[Gn,Fn,Mn,n("a",Tn,[Hn,s(a)]),jn]),Vn,n("p",null,[zn,Jn,Xn,Kn,Yn,Zn,n("a",Wn,[Qn,s(a)]),ne]),ee,n("blockquote",null,[n("p",null,[se,ae,oe,ie,n("a",te,[de,s(a)]),le,n("a",ce,[re,s(a)]),pe,n("a",ue,[he,s(a)]),be,n("a",me,[ve,s(a)]),ge,n("a",ke,[_e,s(a)]),fe,n("a",xe,[De,s(a)]),Ie])]),ye,n("blockquote",null,[n("p",null,[Be,n("a",Pe,[we,s(a)]),Ee,Ue,$e])]),Oe,Ce,n("p",null,[qe,n("a",Re,[Ae,s(a)]),Se,n("a",Le,[Ne,s(a)]),Ge,Fe]),Me,n("p",null,[Te,He,n("a",je,[Ve,s(a)]),ze,Je,Xe]),Ke,n("ul",null,[n("li",null,[n("a",Ye,[Ze,s(a)])])]),We,n("p",null,[Qe,ns,n("a",es,[ss,s(a)]),as,os,is,ts,ds]),ls,n("p",null,[cs,n("a",rs,[ps,s(a)]),us,hs,bs,ms,vs,gs,ks,_s,fs,xs,Ds,n("a",Is,[ys,s(a)]),Bs]),Ps,ws,n("ul",null,[n("li",null,[n("a",Es,[Us,s(a)])])]),$s,n("p",null,[Os,Cs,qs,n("a",Rs,[As,s(a)]),Ss,Ls,Ns]),Gs,n("ul",null,[n("li",null,[Fs,Ms,n("a",Ts,[Hs,s(a)]),js]),Vs,zs]),Js,n("p",null,[Xs,Ks,Ys,Zs,Ws,n("a",Qs,[na,s(a)]),ea]),sa,n("p",null,[aa,n("a",oa,[ia,s(a)]),ta,n("a",da,[la,s(a)]),ca,n("a",ra,[pa,s(a)]),ua]),ha,n("p",null,[n("a",ba,[ma,s(a)]),va,ga,ka]),_a,n("p",null,[fa,n("a",xa,[Da,s(a)]),Ia,ya]),Ba,n("p",null,[n("a",Pa,[wa,s(a)]),Ea]),Ua,n("ul",null,[n("li",null,[n("a",$a,[Oa,s(a)])]),n("li",null,[n("a",Ca,[qa,s(a)])]),n("li",null,[n("a",Ra,[Aa,s(a)])]),n("li",null,[n("a",Sa,[La,s(a)])]),n("li",null,[n("a",Na,[Ga,s(a)])]),n("li",null,[n("a",Fa,[Ma,s(a)])]),n("li",null,[n("a",Ta,[Ha,s(a)])])]),ja,Va,n("ul",null,[n("li",null,[n("p",null,[s(t,{to:"/"},{default:r(()=>[za]),_:1})])]),n("li",null,[n("p",null,[n("a",Ja,[Xa,s(a)]),Ka])]),n("li",null,[n("p",null,[Ya,n("a",Za,[Wa,s(a)])])])])])}const ao=d(p,[["render",Qa],["__file","25.html.vue"]]);export{ao as default};
