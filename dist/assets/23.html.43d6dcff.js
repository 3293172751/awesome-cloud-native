import{_ as r,r as o,o as d,c as u,a as n,b as s,w as a,e,d as l}from"./app.6a4cbc08.js";const p={},v={href:"http://nsddd.top",target:"_blank",rel:"noopener noreferrer"},b=e("author"),k=n("h1",{id:"\u7B2C23\u8282-kubeconfig-token",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u7B2C23\u8282-kubeconfig-token","aria-hidden":"true"},"#"),e(" \u7B2C23\u8282 Kubeconfig && token")],-1),m=n("div",null,[n("a",{href:"22.md",style:{float:"left"}},"\u2B06\uFE0F\u4E0A\u4E00\u8282\u{1F517} "),n("a",{href:"24.md",style:{float:"right"}}," \u2B07\uFE0F\u4E0B\u4E00\u8282\u{1F517}")],-1),h=n("br",null,null,-1),g=e("\u2764\uFE0F\u{1F495}\u{1F495}\u65B0\u65F6\u4EE3\u62E5\u62B1\u4E91\u539F\u751F\uFF0C\u4E91\u539F\u751F\u5177\u6709\u73AF\u5883\u7EDF\u4E00\u3001\u6309\u9700\u4ED8\u8D39\u3001\u5373\u5F00\u5373\u7528\u3001\u7A33\u5B9A\u6027\u5F3A\u7279\u70B9\u3002Myblog:"),f={href:"http://nsddd.top/",target:"_blank",rel:"noopener noreferrer"},_=e("http://nsddd.top"),y=n("hr",null,null,-1),x=n("p",null,"[TOC]",-1),q={class:"table-of-contents"},E=e("\u524D\u8A00"),w=e("\u547D\u4EE4\u53C2\u6570"),C=e("\u4F7F\u7528 kubeconfig \u6587\u4EF6\u7EC4\u7EC7\u96C6\u7FA4\u8BBF\u95EE"),I=e("\u652F\u6301\u591A\u96C6\u7FA4\u3001\u591A\u7528\u6237\u3001\u591A\u8BA4\u8BC1\u673A\u5236"),K=e("\u4E0A\u4E0B\u6587\uFF08Context\uFF09"),N=e("KUBECONFIG \u73AF\u5883\u53D8\u91CF"),B=e("\u5408\u5E76 kubeconfig \u6587\u4EF6"),O=e("\u6587\u4EF6\u5F15\u7528"),A=e("kubeconfig \u4E24\u79CD\u5B9E\u73B0\u65B9\u5F0F"),T=e("\u4EE3\u7406"),S=e("\u5B9A\u4E49\u96C6\u7FA4\uFF0C\u7528\u6237\u548C context"),F=e("\u751F\u6210kubeconfig\u7684\u914D\u7F6E\u6B65\u9AA4"),U=e("END \u94FE\u63A5"),G=n("h2",{id:"\u524D\u8A00",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u524D\u8A00","aria-hidden":"true"},"#"),e(" \u524D\u8A00")],-1),L={class:"custom-container tip"},D=n("p",{class:"custom-container-title"},"\u63D0\u793A",-1),M=n("p",null,"\u5728\u524D\u9762\u5B89\u88C5k3s & k8s \u4E2D\uFF0C\u6211\u4EEC\u8BA4\u8BC6\u4E86 kubeconfig\uFF0C\u4F46\u662F\u6211\u4EEC\u4F9D\u65E7\u5BF9\u8FD9\u4E2A\u4E1C\u897F\u5F88\u964C\u751F",-1),P=n("p",null,"\u6216\u8BB8\uFF0C\u6211\u4EEC\u5FC5\u987B\u719F\u6089\u4ED6\u624D\u53EF\u4EE5\u505A\u66F4\u591A\u6709\u610F\u4E49\u7684work",-1),V=e("\u5728\u5F00\u542F\u4E86 TLS \u7684\u96C6\u7FA4\u4E2D\uFF0C\u6BCF\u5F53\u4E0E\u96C6\u7FA4\u4EA4\u4E92\u7684\u65F6\u5019\u5C11\u4E0D\u4E86\u7684\u662F"),z={href:"https://cloud.tencent.com/solution/tb-digitalid?from=10680",target:"_blank",rel:"noopener noreferrer"},R=e("\u8EAB\u4EFD\u8BA4\u8BC1"),H=e("\uFF0C\u4F7F\u7528 kubeconfig\uFF08\u5373\u8BC1\u4E66\uFF09 \u548C token \u4E24\u79CD\u8BA4\u8BC1\u65B9\u5F0F\u662F\u6700\u7B80\u5355\u4E5F\u6700\u901A\u7528\u7684\u8BA4\u8BC1\u65B9\u5F0F\u3002"),W={class:"custom-container details"},$=n("summary",null,"\u9488\u5BF9\u4E00\u6B21 Kubeconfig \u95EE\u9898\u7684\u8BB0\u5F55",-1),Z={href:"https://headworq.org/en/how-to-connect-to-kubernetes/#",target:"_blank",rel:"noopener noreferrer"},j=e("\u5173\u4E8E\u8FD9\u6B21\u95EE\u9898\u7684\u89E3\u51B3\u65B9\u6848"),J=l(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>\u8D75\u4E3D\u9896
 \u4ECA\u5929 \u4E2D\u5348 <span class="token number">12</span>:18
Ladies and gentlemen, after the agent <span class="token function">node</span> deployment, my k3s prompts such an error. What is the cause




<span class="token number">23</span> \u6761\u56DE\u590D
\u65B0\u589E\u529F\u80FD


icsy7867
  <span class="token number">26</span> \u5206\u949F\u524D
It shouldn<span class="token string">&#39;t be talking to port 8080.  But 6443.  This usually means kubectl doesn&#39;</span>t have access to the yaml conf.
\u540C\u65F6\u53D1\u9001\u81F3\u9891\u9053


\u8D75\u4E3D\u9896
  <span class="token number">25</span> \u5206\u949F\u524D
Sorry, I don<span class="token string">&#39;t quite understand the k3s configuration, which files should I modify?


icsy7867
  25 \u5206\u949F\u524D
Did you move the config to the location you specified?


icsy7867
  25 \u5206\u949F\u524D
And check the permissions
\u4EC5\u5BF9\u4F60\u53EF\u89C1


Slackbot
  24 \u5206\u949F\u524D
/etc/rancher/k3s/config.yaml\u975E\u6709\u6548\u547D\u4EE4\u3002\u5728 Slack \u4E2D\uFF0C\u6240\u6709\u4EE5 &quot;/&quot; \u5B57\u7B26\u5F00\u59CB\u7684\u6D88\u606F\u90FD\u88AB\u89E3\u6790\u4E3A\u547D\u4EE4\u3002
\u5982\u679C\u4F60\u5C1D\u8BD5\u53D1\u9001\u6D88\u606F\u800C\u4E0D\u662F\u8FD0\u884C\u547D\u4EE4\uFF0C\u8BF7\u5C1D\u8BD5\u5728 &quot;/&quot; \u524D\u52A0\u7A7A\u683C\u3002


\u8D75\u4E3D\u9896
  24 \u5206\u949F\u524D
/etc/rancher/k3s/config.yaml 


\u8D75\u4E3D\u9896
  24 \u5206\u949F\u524D
This is the position?


icsy7867
  20 \u5206\u949F\u524D
Or k3s.yaml.  not next to a computer


icsy7867
  19 \u5206\u949F\u524D
Or is it in that directory you specified?  If so try to export that path so kubectl knows where to look


\u8D75\u4E3D\u9896
  19 \u5206\u949F\u524D
image.png
 
image.png




\u8D75\u4E3D\u9896
  18 \u5206\u949F\u524D
I didn&#39;</span>t use <span class="token string">&#39;K3S_CONFIG_FILE&#39;</span> to specify it


\u8D75\u4E3D\u9896
  <span class="token number">18</span> \u5206\u949F\u524D
Where should it go?


\u8D75\u4E3D\u9896
  <span class="token number">16</span> \u5206\u949F\u524D
Even though I specify its location, it seems to be blank
image.png
 
image.png


icsy7867
  <span class="token number">16</span> \u5206\u949F\u524D
<span class="token builtin class-name">export</span> <span class="token assign-left variable">KUBECONFIG</span><span class="token operator">=</span>/etc/rancher/k3s/k3s.yaml


icsy7867
  <span class="token number">16</span> \u5206\u949F\u524D
Try running this


icsy7867
  <span class="token number">14</span> \u5206\u949F\u524D
And <span class="token keyword">then</span> kubectl get nodes


\u8D75\u4E3D\u9896
  <span class="token number">13</span> \u5206\u949F\u524D
Thank you very much <span class="token keyword">for</span> your answer. Are you the maintainer of the k3s community


icsy7867
  <span class="token number">11</span> \u5206\u949F\u524D
Nope.  Just someone <span class="token function">who</span> has stumbled around playing with k3s and happened to see your message :\u5FAE\u7B11:


\u8D75\u4E3D\u9896
  <span class="token number">9</span> \u5206\u949F\u524D
Nice to meet you. What you met is a junior undergraduate student from China. There is an assignment about k3s


icsy7867
  <span class="token number">5</span> \u5206\u949F\u524D
Neat<span class="token operator">!</span>


icsy7867
  <span class="token number">5</span> \u5206\u949F\u524D
Nice to meet you


icsy7867
  <span class="token number">5</span> \u5206\u949F\u524D
And here<span class="token string">&#39;s a good link
https://headworq.org/en/how-to-connect-to-kubernetes/
headworqheadworq
3 ways to connect to your K3s Kubernetes Cluster
In this article I&#39;</span>ll show you three Kubernetes Clients \u2013 Kubectl, Lens and Kubenav.
<span class="token number">2021</span> \u5E74 <span class="token number">1</span> \u6708 <span class="token number">18</span> \u65E5 <span class="token punctuation">(</span><span class="token number">557</span> kB<span class="token punctuation">)</span>
https://headworq.org/en/how-to-connect-to-kubernetes/



icsy7867
  <span class="token number">4</span> \u5206\u949F\u524D
The problem was kubectl was looking <span class="token keyword">for</span> a config file, couldn&#39;t <span class="token function">find</span> one and tried a basic setup.


\u8D75\u4E3D\u9896
  <span class="token operator">&lt;</span> <span class="token number">1</span> \u5206\u949F\u524D
yep, great article, thanks so much <span class="token keyword">for</span> your <span class="token builtin class-name">help</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),Y=l(`<h2 id="\u547D\u4EE4\u53C2\u6570" tabindex="-1"><a class="header-anchor" href="#\u547D\u4EE4\u53C2\u6570" aria-hidden="true">#</a> \u547D\u4EE4\u53C2\u6570</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubectl config SUBCOMMAND

\u9009\u9879
      <span class="token parameter variable">--kubeconfig</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token builtin class-name">:</span> \u4F7F\u7528\u7279\u5B9A\u7684\u914D\u7F6E\u6587\u4EF6\u3002

\u7EE7\u627F\u81EA\u7236\u547D\u4EE4\u7684\u9009\u9879
      --alsologtostderr<span class="token punctuation">[</span><span class="token operator">=</span>false<span class="token punctuation">]</span>: \u540C\u65F6\u8F93\u51FA\u65E5\u5FD7\u5230\u6807\u51C6\u9519\u8BEF\u63A7\u5236\u53F0\u548C\u6587\u4EF6\u3002
      --api-version<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token builtin class-name">:</span> \u548C\u670D\u52A1\u7AEF\u4EA4\u4E92\u4F7F\u7528\u7684API\u7248\u672C\u3002
      --certificate-authority<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token builtin class-name">:</span> \u7528\u4EE5\u8FDB\u884C\u8BA4\u8BC1\u6388\u6743\u7684.cert\u6587\u4EF6\u8DEF\u5F84\u3002
      --client-certificate<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token builtin class-name">:</span> TLS\u4F7F\u7528\u7684\u5BA2\u6237\u7AEF\u8BC1\u4E66\u8DEF\u5F84\u3002
      --client-key<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token builtin class-name">:</span> TLS\u4F7F\u7528\u7684\u5BA2\u6237\u7AEF\u5BC6\u94A5\u8DEF\u5F84\u3002
      <span class="token parameter variable">--cluster</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token builtin class-name">:</span> \u6307\u5B9A\u4F7F\u7528\u7684kubeconfig\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684\u96C6\u7FA4\u540D\u3002
      <span class="token parameter variable">--context</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token builtin class-name">:</span> \u6307\u5B9A\u4F7F\u7528\u7684kubeconfig\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684\u73AF\u5883\u540D\u3002
      --insecure-skip-tls-verify<span class="token punctuation">[</span><span class="token operator">=</span>false<span class="token punctuation">]</span>: \u5982\u679C\u4E3Atrue\uFF0C\u5C06\u4E0D\u4F1A\u68C0\u67E5\u670D\u52A1\u5668\u51ED\u8BC1\u7684\u6709\u6548\u6027\uFF0C\u8FD9\u4F1A\u5BFC\u81F4\u4F60\u7684HTTPS\u94FE\u63A5\u53D8\u5F97\u4E0D\u5B89\u5168\u3002
      <span class="token parameter variable">--kubeconfig</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token builtin class-name">:</span> \u547D\u4EE4\u884C\u8BF7\u6C42\u4F7F\u7528\u7684\u914D\u7F6E\u6587\u4EF6\u8DEF\u5F84\u3002
      --log-backtrace-at<span class="token operator">=</span>:0: \u5F53\u65E5\u5FD7\u957F\u5EA6\u8D85\u8FC7\u5B9A\u4E49\u7684\u884C\u6570\u65F6\uFF0C\u5FFD\u7565\u5806\u6808\u4FE1\u606F\u3002
      --log-dir<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token builtin class-name">:</span> \u5982\u679C\u4E0D\u4E3A\u7A7A\uFF0C\u5C06\u65E5\u5FD7\u6587\u4EF6\u5199\u5165\u6B64\u76EE\u5F55\u3002
      --log-flush-frequency<span class="token operator">=</span>5s: \u5237\u65B0\u65E5\u5FD7\u7684\u6700\u5927\u65F6\u95F4\u95F4\u9694\u3002
      --logtostderr<span class="token punctuation">[</span><span class="token operator">=</span>true<span class="token punctuation">]</span>: \u8F93\u51FA\u65E5\u5FD7\u5230\u6807\u51C6\u9519\u8BEF\u63A7\u5236\u53F0\uFF0C\u4E0D\u8F93\u51FA\u5230\u6587\u4EF6\u3002
      --match-server-version<span class="token punctuation">[</span><span class="token operator">=</span>false<span class="token punctuation">]</span>: \u8981\u6C42\u670D\u52A1\u7AEF\u548C\u5BA2\u6237\u7AEF\u7248\u672C\u5339\u914D\u3002
      <span class="token parameter variable">--namespace</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token builtin class-name">:</span> \u5982\u679C\u4E0D\u4E3A\u7A7A\uFF0C\u547D\u4EE4\u5C06\u4F7F\u7528\u6B64namespace\u3002
      <span class="token parameter variable">--password</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token builtin class-name">:</span> API Server\u8FDB\u884C\u7B80\u5355\u8BA4\u8BC1\u4F7F\u7528\u7684\u5BC6\u7801\u3002
  -s, <span class="token parameter variable">--server</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token builtin class-name">:</span> Kubernetes API Server\u7684\u5730\u5740\u548C\u7AEF\u53E3\u53F7\u3002
      <span class="token parameter variable">--stderrthreshold</span><span class="token operator">=</span><span class="token number">2</span>: \u9AD8\u4E8E\u6B64\u7EA7\u522B\u7684\u65E5\u5FD7\u5C06\u88AB\u8F93\u51FA\u5230\u9519\u8BEF\u63A7\u5236\u53F0\u3002
      <span class="token parameter variable">--token</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token builtin class-name">:</span> \u8BA4\u8BC1\u5230API Server\u4F7F\u7528\u7684\u4EE4\u724C\u3002
      <span class="token parameter variable">--user</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token builtin class-name">:</span> \u6307\u5B9A\u4F7F\u7528\u7684kubeconfig\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684\u7528\u6237\u540D\u3002
      <span class="token parameter variable">--username</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token builtin class-name">:</span> API Server\u8FDB\u884C\u7B80\u5355\u8BA4\u8BC1\u4F7F\u7528\u7684\u7528\u6237\u540D\u3002
      <span class="token parameter variable">--v</span><span class="token operator">=</span><span class="token number">0</span>: \u6307\u5B9A\u8F93\u51FA\u65E5\u5FD7\u7684\u7EA7\u522B\u3002
      <span class="token parameter variable">--vmodule</span><span class="token operator">=</span>: \u6307\u5B9A\u8F93\u51FA\u65E5\u5FD7\u7684\u6A21\u5757\uFF0C\u683C\u5F0F\u5982\u4E0B\uFF1Apattern<span class="token operator">=</span>N\uFF0C\u4F7F\u7528\u9017\u53F7\u5206\u9694\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u4F7F\u7528-kubeconfig-\u6587\u4EF6\u7EC4\u7EC7\u96C6\u7FA4\u8BBF\u95EE" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528-kubeconfig-\u6587\u4EF6\u7EC4\u7EC7\u96C6\u7FA4\u8BBF\u95EE" aria-hidden="true">#</a> \u4F7F\u7528 kubeconfig \u6587\u4EF6\u7EC4\u7EC7\u96C6\u7FA4\u8BBF\u95EE</h2><p>\u4F7F\u7528 kubeconfig \u6587\u4EF6\u6765\u7EC4\u7EC7\u6709\u5173\u96C6\u7FA4\u3001\u7528\u6237\u3001\u547D\u540D\u7A7A\u95F4\u548C\u8EAB\u4EFD\u9A8C\u8BC1\u673A\u5236\u7684\u4FE1\u606F\u3002<code>kubectl</code>\u547D\u4EE4\u884C\u5DE5\u5177\u4F7F\u7528 kubeconfig \u6587\u4EF6\u6765\u67E5\u627E\u9009\u62E9\u96C6\u7FA4\u548C\u4E0E\u96C6\u7FA4\u7684 API \u670D\u52A1\u5668\u901A\u4FE1\u6240\u9700\u7684\u4FE1\u606F\u3002</p><div class="custom-container danger"><p class="custom-container-title">\u8B66\u544A</p><p>**\u6CE8\u610F\uFF1A**\u7528\u4E8E\u914D\u7F6E\u5BF9\u96C6\u7FA4\u7684\u8BBF\u95EE\u7684\u6587\u4EF6\u79F0\u4E3A<em>kubeconfig \u6587\u4EF6</em>\u3002\u8FD9\u662F\u5F15\u7528\u914D\u7F6E\u6587\u4EF6\u7684\u901A\u7528\u65B9\u5F0F\u3002\u8FD9\u5E76\u4E0D\u610F\u5473\u7740\u6709\u4E00\u4E2A\u540D\u4E3A<code>kubeconfig</code>.</p><p>**\u8B66\u544A\uFF1A**\u4EC5\u4F7F\u7528\u6765\u81EA\u53EF\u4FE1\u6765\u6E90\u7684 kubeconfig \u6587\u4EF6\u3002\u4F7F\u7528\u7279\u5236\u7684 kubeconfig \u6587\u4EF6\u53EF\u80FD\u4F1A\u5BFC\u81F4\u6076\u610F\u4EE3\u7801\u6267\u884C\u6216\u6587\u4EF6\u66B4\u9732\u3002\u5982\u679C\u60A8\u5FC5\u987B\u4F7F\u7528\u4E0D\u53D7\u4FE1\u4EFB\u7684 kubeconfig \u6587\u4EF6\uFF0C\u8BF7\u5148\u4ED4\u7EC6\u68C0\u67E5\u5B83\uFF0C\u5C31\u50CF\u68C0\u67E5 shell \u811A\u672C\u4E00\u6837\u3002</p></div>`,5),Q=e("\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C"),X=n("code",null,"kubectl",-1),nn=e("\u67E5\u627E\u76EE\u5F55\u4E2D\u547D\u540D"),en=n("code",null,"config",-1),sn=e("\u7684"),an=n("code",null,"$HOME/.kube",-1),tn=e("\u6587\u4EF6\u3002"),ln=n("code",null,"KUBECONFIG",-1),on=e("\u60A8\u53EF\u4EE5\u901A\u8FC7\u8BBE\u7F6E\u73AF\u5883\u53D8\u91CF\u6216\u8BBE\u7F6E "),cn={href:"https://kubernetes.io/docs/reference/generated/kubectl/kubectl/",target:"_blank",rel:"noopener noreferrer"},rn=n("code",null,"--kubeconfig",-1),dn=e("\u6807\u5FD7\u6765\u6307\u5B9A\u5176\u4ED6 kubeconfig \u6587\u4EF6\u3002"),un={id:"\u652F\u6301\u591A\u96C6\u7FA4\u3001\u591A\u7528\u6237\u3001\u591A\u8BA4\u8BC1\u673A\u5236",tabindex:"-1"},pn=n("a",{class:"header-anchor",href:"#\u652F\u6301\u591A\u96C6\u7FA4\u3001\u591A\u7528\u6237\u3001\u591A\u8BA4\u8BC1\u673A\u5236","aria-hidden":"true"},"#",-1),vn=e(" \u652F\u6301\u591A\u96C6\u7FA4\u3001\u591A\u7528\u6237\u3001\u591A\u8BA4\u8BC1\u673A\u5236"),bn={href:"https://kubernetes.io/docs/concepts/configuration/organize-cluster-access-kubeconfig/#supporting-multiple-clusters-users-and-authentication-mechanisms",target:"_blank",rel:"noopener noreferrer"},kn=l(`<p>\u5047\u8BBE\u60A8\u6709\u591A\u4E2A\u96C6\u7FA4\uFF0C\u5E76\u4E14\u60A8\u7684\u7528\u6237\u548C\u7EC4\u4EF6\u4EE5\u591A\u79CD\u65B9\u5F0F\u8FDB\u884C\u8EAB\u4EFD\u9A8C\u8BC1\u3002\u4F8B\u5982\uFF1A</p><ul><li>\u6B63\u5728\u8FD0\u884C\u7684 kubelet \u53EF\u80FD\u4F1A\u4F7F\u7528\u8BC1\u4E66\u8FDB\u884C\u8EAB\u4EFD\u9A8C\u8BC1\u3002</li><li>\u7528\u6237\u53EF\u4EE5\u4F7F\u7528\u4EE4\u724C\u8FDB\u884C\u8EAB\u4EFD\u9A8C\u8BC1\u3002</li><li>\u7BA1\u7406\u5458\u53EF\u80FD\u62E5\u6709\u4ED6\u4EEC\u63D0\u4F9B\u7ED9\u5404\u4E2A\u7528\u6237\u7684\u8BC1\u4E66\u96C6\u3002</li></ul><p>\u4F7F\u7528 kubeconfig \u6587\u4EF6\uFF0C\u60A8\u53EF\u4EE5\u7EC4\u7EC7\u96C6\u7FA4\u3001\u7528\u6237\u548C\u547D\u540D\u7A7A\u95F4\u3002\u60A8\u8FD8\u53EF\u4EE5\u5B9A\u4E49\u4E0A\u4E0B\u6587\u4EE5\u5728\u96C6\u7FA4\u548C\u540D\u79F0\u7A7A\u95F4\u4E4B\u95F4\u5FEB\u901F\u8F7B\u677E\u5730\u5207\u6362\u3002</p><blockquote><p><code>kubectl config use-context</code> \u547D\u4EE4\u5FEB\u901F\u5730\u5728\u96C6\u7FA4\u4E4B\u95F4\u8FDB\u884C\u5207\u6362\u3002</p></blockquote><h2 id="\u4E0A\u4E0B\u6587-context" tabindex="-1"><a class="header-anchor" href="#\u4E0A\u4E0B\u6587-context" aria-hidden="true">#</a> \u4E0A\u4E0B\u6587\uFF08Context\uFF09</h2><p>\u901A\u8FC7 kubeconfig \u6587\u4EF6\u4E2D\u7684 <em>context</em> \u5143\u7D20\uFF0C\u4F7F\u7528\u7B80\u4FBF\u7684\u540D\u79F0\u6765\u5BF9\u8BBF\u95EE\u53C2\u6570\u8FDB\u884C\u5206\u7EC4\u3002 \u6BCF\u4E2A context \u90FD\u6709\u4E09\u4E2A\u53C2\u6570\uFF1Acluster\u3001namespace \u548C user\u3002 \u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C<code>kubectl</code> \u547D\u4EE4\u884C\u5DE5\u5177\u4F7F\u7528 <strong>\u5F53\u524D\u4E0A\u4E0B\u6587</strong> \u4E2D\u7684\u53C2\u6570\u4E0E\u96C6\u7FA4\u8FDB\u884C\u901A\u4FE1\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubectl config use-context
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="kubeconfig-\u73AF\u5883\u53D8\u91CF" tabindex="-1"><a class="header-anchor" href="#kubeconfig-\u73AF\u5883\u53D8\u91CF" aria-hidden="true">#</a> KUBECONFIG \u73AF\u5883\u53D8\u91CF</h2><p><code>KUBECONFIG</code> \u73AF\u5883\u53D8\u91CF\u5305\u542B\u4E00\u4E2A kubeconfig \u6587\u4EF6\u5217\u8868\u3002 \u5BF9\u4E8E Linux \u548C Mac\uFF0C\u5217\u8868\u4EE5\u5192\u53F7\u5206\u9694\u3002\u5BF9\u4E8E Windows\uFF0C\u5217\u8868\u4EE5\u5206\u53F7\u5206\u9694\u3002 <code>KUBECONFIG</code> \u73AF\u5883\u53D8\u91CF\u4E0D\u662F\u5FC5\u8981\u7684\u3002 \u5982\u679C <code>KUBECONFIG</code> \u73AF\u5883\u53D8\u91CF\u4E0D\u5B58\u5728\uFF0C<code>kubectl</code> \u4F7F\u7528\u9ED8\u8BA4\u7684 kubeconfig \u6587\u4EF6\uFF0C<code>$HOME/.kube/config</code>\u3002</p><p>\u5982\u679C <code>KUBECONFIG</code> \u73AF\u5883\u53D8\u91CF\u5B58\u5728\uFF0C<code>kubectl</code> \u4F7F\u7528 <code>KUBECONFIG</code> \u73AF\u5883\u53D8\u91CF\u4E2D\u5217\u4E3E\u7684\u6587\u4EF6\u5408\u5E76\u540E\u7684\u6709\u6548\u914D\u7F6E\u3002</p><h2 id="\u5408\u5E76-kubeconfig-\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u5408\u5E76-kubeconfig-\u6587\u4EF6" aria-hidden="true">#</a> \u5408\u5E76 kubeconfig \u6587\u4EF6</h2><p>\u8981\u67E5\u770B\u914D\u7F6E\uFF0C\u8F93\u5165\u4EE5\u4E0B\u547D\u4EE4\uFF1A</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@iZbp1evo5cnwagauz3w188Z ~<span class="token punctuation">]</span><span class="token comment"># kubectl config view</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">clusters</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">cluster</span><span class="token punctuation">:</span>
    <span class="token key atrule">certificate-authority-data</span><span class="token punctuation">:</span> DATA+OMITTED
    <span class="token key atrule">server</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//apiserver.cluster.local<span class="token punctuation">:</span><span class="token number">6443</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> kubernetes
<span class="token key atrule">contexts</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">context</span><span class="token punctuation">:</span>
    <span class="token key atrule">cluster</span><span class="token punctuation">:</span> kubernetes
    <span class="token key atrule">user</span><span class="token punctuation">:</span> kubernetes<span class="token punctuation">-</span>admin
  <span class="token key atrule">name</span><span class="token punctuation">:</span> kubernetes<span class="token punctuation">-</span>admin@kubernetes
<span class="token key atrule">current-context</span><span class="token punctuation">:</span> kubernetes<span class="token punctuation">-</span>admin@kubernetes
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Config
<span class="token key atrule">preferences</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token key atrule">users</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> kubernetes<span class="token punctuation">-</span>admin
  <span class="token key atrule">user</span><span class="token punctuation">:</span>
    <span class="token key atrule">client-certificate-data</span><span class="token punctuation">:</span> REDACTED
    <span class="token key atrule">client-key-data</span><span class="token punctuation">:</span> REDACTED
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5982\u524D\u6240\u8FF0\uFF0C\u8F93\u51FA\u53EF\u80FD\u6765\u81EA kubeconfig \u6587\u4EF6\uFF0C\u4E5F\u53EF\u80FD\u662F\u5408\u5E76\u591A\u4E2A kubeconfig \u6587\u4EF6\u7684\u7ED3\u679C\u3002</p><p><strong>\u4EE5\u4E0B\u662F <code>kubectl</code> \u5728\u5408\u5E76 kubeconfig \u6587\u4EF6\u65F6\u4F7F\u7528\u7684\u89C4\u5219\u3002</strong></p><p>\u5982\u679C\u8BBE\u7F6E\u4E86 <code>--kubeconfig</code> \u53C2\u6570\uFF0C\u5219\u4EC5\u4F7F\u7528\u6307\u5B9A\u7684\u6587\u4EF6\u3002\u4E0D\u8FDB\u884C\u5408\u5E76\u3002\u6B64\u53C2\u6570\u53EA\u80FD\u4F7F\u7528\u4E00\u6B21\u3002</p><p>\u5426\u5219\uFF0C\u5982\u679C\u8BBE\u7F6E\u4E86 <code>KUBECONFIG</code> \u73AF\u5883\u53D8\u91CF\uFF0C\u5C06\u5B83\u7528\u4F5C\u5E94\u5408\u5E76\u7684\u6587\u4EF6\u5217\u8868\u3002\u6839\u636E\u4EE5\u4E0B\u89C4\u5219\u5408\u5E76 <code>KUBECONFIG</code> \u73AF\u5883\u53D8\u91CF\u4E2D\u5217\u51FA\u7684\u6587\u4EF6\uFF1A</p><ul><li>\u5FFD\u7565\u7A7A\u6587\u4EF6\u540D\u3002</li><li>\u5BF9\u4E8E\u5185\u5BB9\u65E0\u6CD5\u53CD\u5E8F\u5217\u5316\u7684\u6587\u4EF6\uFF0C\u4EA7\u751F\u9519\u8BEF\u4FE1\u606F\u3002</li><li>\u7B2C\u4E00\u4E2A\u8BBE\u7F6E\u7279\u5B9A\u503C\u6216\u8005\u6620\u5C04\u952E\u7684\u6587\u4EF6\u5C06\u751F\u6548\u3002</li><li>\u6C38\u8FDC\u4E0D\u4F1A\u66F4\u6539\u503C\u6216\u8005\u6620\u5C04\u952E\u3002\u793A\u4F8B\uFF1A\u4FDD\u7559\u7B2C\u4E00\u4E2A\u6587\u4EF6\u7684\u4E0A\u4E0B\u6587\u4EE5\u8BBE\u7F6E <code>current-context</code>\u3002\u793A\u4F8B\uFF1A\u5982\u679C\u4E24\u4E2A\u6587\u4EF6\u90FD\u6307\u5B9A\u4E86 <code>red-user</code>\uFF0C\u5219\u4EC5\u4F7F\u7528\u7B2C\u4E00\u4E2A\u6587\u4EF6\u7684 <code>red-user</code> \u4E2D\u7684\u503C\u3002\u5373\u4F7F\u7B2C\u4E8C\u4E2A\u6587\u4EF6\u5728 <code>red-user</code> \u4E0B\u6709\u975E\u51B2\u7A81\u6761\u76EE\uFF0C\u4E5F\u8981\u4E22\u5F03\u5B83\u4EEC\u3002</li></ul>`,18),mn=e("\u6709\u5173\u8BBE\u7F6E "),hn=n("code",null,"KUBECONFIG",-1),gn=e(" \u73AF\u5883\u53D8\u91CF\u7684\u793A\u4F8B\uFF0C\u8BF7\u53C2\u9605 "),fn={href:"https://kubernetes.io/zh-cn/docs/tasks/access-application-cluster/configure-access-multiple-clusters/#set-the-kubeconfig-environment-variable",target:"_blank",rel:"noopener noreferrer"},_n=e("\u8BBE\u7F6E KUBECONFIG \u73AF\u5883\u53D8\u91CF"),yn=e("\u3002"),xn=l(`<p>\u5426\u5219\uFF0C\u4F7F\u7528\u9ED8\u8BA4\u7684 kubeconfig \u6587\u4EF6\uFF0C <code>$HOME/.kube/config</code>\uFF0C\u4E0D\u8FDB\u884C\u5408\u5E76\u3002</p><p><strong>\u6839\u636E\u6B64\u94FE\u4E2D\u7684\u7B2C\u4E00\u4E2A\u5339\u914D\u786E\u5B9A\u8981\u4F7F\u7528\u7684\u4E0A\u4E0B\u6587:</strong></p><ol><li>\u5982\u679C\u5B58\u5728\uFF0C\u4F7F\u7528 <code>--context</code> \u547D\u4EE4\u884C\u53C2\u6570\u3002</li><li>\u4F7F\u7528\u5408\u5E76\u7684 kubeconfig \u6587\u4EF6\u4E2D\u7684 <code>current-context</code>\u3002</li></ol><p><strong>\u8FD9\u79CD\u573A\u666F\u4E0B\u5141\u8BB8\u7A7A\u4E0A\u4E0B\u6587:</strong></p><p>\u786E\u5B9A\u96C6\u7FA4\u548C\u7528\u6237\u3002\u6B64\u65F6\uFF0C\u53EF\u80FD\u6709\u4E5F\u53EF\u80FD\u6CA1\u6709\u4E0A\u4E0B\u6587\u3002\u6839\u636E\u6B64\u94FE\u4E2D\u7684\u7B2C\u4E00\u4E2A\u5339\u914D\u786E\u5B9A\u96C6\u7FA4\u548C\u7528\u6237\uFF0C\u8FD9\u5C06\u8FD0\u884C\u4E24\u6B21\uFF1A\u4E00\u6B21\u7528\u4E8E\u7528\u6237\uFF0C\u4E00\u6B21\u7528\u4E8E\u96C6\u7FA4\u3002</p><ol><li>\u5982\u679C\u5B58\u5728\uFF0C\u4F7F\u7528\u547D\u4EE4\u884C\u53C2\u6570\uFF1A<code>--user</code> \u6216\u8005 <code>--cluster</code>\u3002</li><li>\u5982\u679C\u4E0A\u4E0B\u6587\u975E\u7A7A\uFF0C\u4ECE\u4E0A\u4E0B\u6587\u4E2D\u83B7\u53D6\u7528\u6237\u6216\u96C6\u7FA4\u3002</li></ol><p><strong>\u8FD9\u79CD\u573A\u666F\u4E0B\u7528\u6237\u548C\u96C6\u7FA4\u53EF\u4EE5\u4E3A\u7A7A:</strong></p><p>\u786E\u5B9A\u8981\u4F7F\u7528\u7684\u5B9E\u9645\u96C6\u7FA4\u4FE1\u606F\u3002\u6B64\u65F6\uFF0C\u53EF\u80FD\u6709\u4E5F\u53EF\u80FD\u6CA1\u6709\u96C6\u7FA4\u4FE1\u606F\u3002\u57FA\u4E8E\u6B64\u94FE\u6784\u5EFA\u6BCF\u4E2A\u96C6\u7FA4\u4FE1\u606F\uFF1B\u7B2C\u4E00\u4E2A\u5339\u914D\u9879\u4F1A\u88AB\u91C7\u7528\uFF1A</p><ol><li>\u5982\u679C\u5B58\u5728\uFF1A<code>--server</code>\u3001<code>--certificate-authority</code> \u548C <code>--insecure-skip-tls-verify</code>\uFF0C\u4F7F\u7528\u547D\u4EE4\u884C\u53C2\u6570\u3002</li><li>\u5982\u679C\u5408\u5E76\u7684 kubeconfig \u6587\u4EF6\u4E2D\u5B58\u5728\u96C6\u7FA4\u4FE1\u606F\u5C5E\u6027\uFF0C\u5219\u4F7F\u7528\u5B83\u4EEC\u3002</li><li>\u5982\u679C\u6CA1\u6709 server \u914D\u7F6E\uFF0C\u5219\u914D\u7F6E\u65E0\u6548\u3002</li></ol><p>\u786E\u5B9A\u8981\u4F7F\u7528\u7684\u5B9E\u9645\u7528\u6237\u4FE1\u606F\u3002\u4F7F\u7528\u4E0E\u96C6\u7FA4\u4FE1\u606F\u76F8\u540C\u7684\u89C4\u5219\u6784\u5EFA\u7528\u6237\u4FE1\u606F\uFF0C\u4F46\u6BCF\u4E2A\u7528\u6237\u53EA\u5141\u8BB8\u4E00\u79CD\u8EAB\u4EFD\u8BA4\u8BC1\u6280\u672F\uFF1A</p><ol><li>\u5982\u679C\u5B58\u5728\uFF1A<code>--client-certificate</code>\u3001<code>--client-key</code>\u3001<code>--username</code>\u3001<code>--password</code> \u548C <code>--token</code>\uFF0C\u4F7F\u7528\u547D\u4EE4\u884C\u53C2\u6570\u3002</li><li>\u4F7F\u7528\u5408\u5E76\u7684 kubeconfig \u6587\u4EF6\u4E2D\u7684 <code>user</code> \u5B57\u6BB5\u3002</li><li>\u5982\u679C\u5B58\u5728\u4E24\u79CD\u51B2\u7A81\u6280\u672F\uFF0C\u5219\u914D\u7F6E\u65E0\u6548\u3002</li><li>\u5BF9\u4E8E\u4ECD\u7136\u7F3A\u5931\u7684\u4EFB\u4F55\u4FE1\u606F\uFF0C\u4F7F\u7528\u5176\u5BF9\u5E94\u7684\u9ED8\u8BA4\u503C\uFF0C\u5E76\u53EF\u80FD\u63D0\u793A\u8F93\u5165\u8EAB\u4EFD\u8BA4\u8BC1\u4FE1\u606F\u3002</li></ol><h2 id="\u6587\u4EF6\u5F15\u7528" tabindex="-1"><a class="header-anchor" href="#\u6587\u4EF6\u5F15\u7528" aria-hidden="true">#</a> \u6587\u4EF6\u5F15\u7528</h2><p>kubeconfig \u6587\u4EF6\u4E2D\u7684\u6587\u4EF6\u548C\u8DEF\u5F84\u5F15\u7528\u662F\u76F8\u5BF9\u4E8E kubeconfig \u6587\u4EF6\u7684\u4F4D\u7F6E\u3002 \u547D\u4EE4\u884C\u4E0A\u7684\u6587\u4EF6\u5F15\u7528\u662F\u76F8\u5BF9\u4E8E\u5F53\u524D\u5DE5\u4F5C\u76EE\u5F55\u7684\u3002 \u5728 <code>$HOME/.kube/config</code> \u4E2D\uFF0C\u76F8\u5BF9\u8DEF\u5F84\u6309\u76F8\u5BF9\u8DEF\u5F84\u5B58\u50A8\uFF0C\u7EDD\u5BF9\u8DEF\u5F84\u6309\u7EDD\u5BF9\u8DEF\u5F84\u5B58\u50A8\u3002</p><h2 id="kubeconfig-\u4E24\u79CD\u5B9E\u73B0\u65B9\u5F0F" tabindex="-1"><a class="header-anchor" href="#kubeconfig-\u4E24\u79CD\u5B9E\u73B0\u65B9\u5F0F" aria-hidden="true">#</a> kubeconfig \u4E24\u79CD\u5B9E\u73B0\u65B9\u5F0F</h2><ol><li>\u521B\u5EFA Kubeconfig \u6587\u4EF6 <ol><li>\u7533\u8BF7\u8BC1\u4E66</li><li>\u521B\u5EFA kuberconfig \u6587\u4EF6</li><li>\u9A8C\u8BC1 kuberconfig \u6587\u4EF6</li></ol></li><li>\u624B\u52A8\u590D\u5236\u8BC1\u4E66 <ol><li>\u96C6\u7FA4\u73AF\u5883</li><li>\u914D\u7F6E\u65B9\u6CD5</li></ol></li></ol><h2 id="\u4EE3\u7406" tabindex="-1"><a class="header-anchor" href="#\u4EE3\u7406" aria-hidden="true">#</a> \u4EE3\u7406</h2><p>\u4F60\u53EF\u4EE5\u5728 <code>kubeconfig</code> \u6587\u4EF6\u4E2D\uFF0C\u4E3A\u6BCF\u4E2A\u96C6\u7FA4\u914D\u7F6E <code>proxy-url</code> \u6765\u8BA9 <code>kubectl</code> \u4F7F\u7528\u4EE3\u7406\uFF0C\u4F8B\u5982\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>apiVersion: v1
kind: Config

clusters:
- cluster:
    proxy-url: http://proxy.example.org:3128
    server: https://k8s.example.org/k8s/clusters/c-xxyyzz
  name: development

users:
- name: developer

contexts:
- context:
  name: development
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u5B9A\u4E49\u96C6\u7FA4-\u7528\u6237\u548C-context" tabindex="-1"><a class="header-anchor" href="#\u5B9A\u4E49\u96C6\u7FA4-\u7528\u6237\u548C-context" aria-hidden="true">#</a> \u5B9A\u4E49\u96C6\u7FA4\uFF0C\u7528\u6237\u548C context</h2><p>\u5047\u8BBE\u7528\u6237\u6709\u4E24\u4E2A\u96C6\u7FA4\uFF0C\u4E00\u4E2A\u7528\u4E8E\u6B63\u5F0F\u5F00\u53D1\u5DE5\u4F5C\uFF0C\u4E00\u4E2A\u7528\u4E8E\u5176\u5B83\u4E34\u65F6\u7528\u9014\uFF08scratch\uFF09\u3002 \u5728 <code>development</code> \u96C6\u7FA4\u4E2D\uFF0C\u524D\u7AEF\u5F00\u53D1\u8005\u5728\u540D\u4E3A <code>frontend</code> \u7684\u540D\u5B57\u7A7A\u95F4\u4E0B\u5DE5\u4F5C\uFF0C \u5B58\u50A8\u5F00\u53D1\u8005\u5728\u540D\u4E3A <code>storage</code> \u7684\u540D\u5B57\u7A7A\u95F4\u4E0B\u5DE5\u4F5C\u3002\u5728 <code>scratch</code> \u96C6\u7FA4\u4E2D\uFF0C \u5F00\u53D1\u4EBA\u5458\u53EF\u80FD\u5728\u9ED8\u8BA4\u540D\u5B57\u7A7A\u95F4\u4E0B\u5DE5\u4F5C\uFF0C\u4E5F\u53EF\u80FD\u89C6\u60C5\u51B5\u521B\u5EFA\u9644\u52A0\u7684\u540D\u5B57\u7A7A\u95F4\u3002 \u8BBF\u95EE\u5F00\u53D1\u96C6\u7FA4\u9700\u8981\u901A\u8FC7\u8BC1\u4E66\u8FDB\u884C\u8BA4\u8BC1\u3002 \u8BBF\u95EE\u5176\u5B83\u4E34\u65F6\u7528\u9014\u7684\u96C6\u7FA4\u9700\u8981\u901A\u8FC7\u7528\u6237\u540D\u548C\u5BC6\u7801\u8FDB\u884C\u8BA4\u8BC1\u3002</p><p>\u521B\u5EFA\u540D\u4E3A <code>config-exercise</code> \u7684\u76EE\u5F55\u3002\u5728 <code>config-exercise</code> \u76EE\u5F55\u4E2D\uFF0C\u521B\u5EFA\u540D\u4E3A <code>config-demo</code> \u7684\u6587\u4EF6\uFF0C\u5176\u5185\u5BB9\u4E3A\uFF1A</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Config
<span class="token key atrule">preferences</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token key atrule">clusters</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">cluster</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> development
<span class="token punctuation">-</span> <span class="token key atrule">cluster</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> scratch

<span class="token key atrule">users</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> developer
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> experimenter

<span class="token key atrule">contexts</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">context</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> dev<span class="token punctuation">-</span>frontend
<span class="token punctuation">-</span> <span class="token key atrule">context</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> dev<span class="token punctuation">-</span>storage
<span class="token punctuation">-</span> <span class="token key atrule">context</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> exp<span class="token punctuation">-</span>scratch
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u914D\u7F6E\u6587\u4EF6\u63CF\u8FF0\u4E86\u96C6\u7FA4\u3001\u7528\u6237\u540D\u548C\u4E0A\u4E0B\u6587\u3002<code>config-demo</code> \u6587\u4EF6\u4E2D\u542B\u6709\u63CF\u8FF0\u4E24\u4E2A\u96C6\u7FA4\u3001 \u4E24\u4E2A\u7528\u6237\u548C\u4E09\u4E2A\u4E0A\u4E0B\u6587\u7684\u6846\u67B6\u3002</p><p>\u8FDB\u5165 <code>config-exercise</code> \u76EE\u5F55\u3002\u8F93\u5165\u4EE5\u4E0B\u547D\u4EE4\uFF0C\u5C06\u96C6\u7FA4\u8BE6\u7EC6\u4FE1\u606F\u6DFB\u52A0\u5230\u914D\u7F6E\u6587\u4EF6\u4E2D\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubectl config <span class="token parameter variable">--kubeconfig</span><span class="token operator">=</span>config-demo set-cluster development <span class="token parameter variable">--server</span><span class="token operator">=</span>https://1.2.3.4 --certificate-authority<span class="token operator">=</span>fake-ca-file
kubectl config <span class="token parameter variable">--kubeconfig</span><span class="token operator">=</span>config-demo set-cluster scratch <span class="token parameter variable">--server</span><span class="token operator">=</span>https://5.6.7.8 --insecure-skip-tls-verify
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,25),qn={class:"custom-container warning"},En=n("p",{class:"custom-container-title"},"**\u6CE8\u610F\uFF1A**",-1),wn=e("\u5C06\u5BC6\u7801\u4FDD\u5B58\u5230 Kubernetes \u5BA2\u6237\u7AEF\u914D\u7F6E\u4E2D\u6709\u98CE\u9669\u3002 \u4E00\u4E2A\u8F83\u597D\u7684\u66FF\u4EE3\u65B9\u5F0F\u662F\u4F7F\u7528\u51ED\u636E\u63D2\u4EF6\u5E76\u5355\u72EC\u4FDD\u5B58\u8FD9\u4E9B\u51ED\u636E\u3002 \u53C2\u9605 "),Cn={href:"https://kubernetes.io/zh-cn/docs/reference/access-authn-authz/authentication/#client-go-credential-plugins",target:"_blank",rel:"noopener noreferrer"},In=e("client-go \u51ED\u636E\u63D2\u4EF6"),Kn=l(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubectl config <span class="token parameter variable">--kubeconfig</span><span class="token operator">=</span>config-demo set-credentials developer --client-certificate<span class="token operator">=</span>fake-cert-file --client-key<span class="token operator">=</span>fake-key-seefile
kubectl config <span class="token parameter variable">--kubeconfig</span><span class="token operator">=</span>config-demo set-credentials experimenter <span class="token parameter variable">--username</span><span class="token operator">=</span>exp <span class="token parameter variable">--password</span><span class="token operator">=</span>some-password
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>::: tip<strong>\u8BF4\u660E\uFF1A</strong></p><ul><li>\u8981\u5220\u9664\u7528\u6237\uFF0C\u53EF\u4EE5\u8FD0\u884C <code>kubectl --kubeconfig=config-demo config unset users.&lt;name&gt;</code></li><li>\u8981\u5220\u9664\u96C6\u7FA4\uFF0C\u53EF\u4EE5\u8FD0\u884C <code>kubectl --kubeconfig=config-demo config unset clusters.&lt;name&gt;</code></li><li>\u8981\u5220\u9664\u4E0A\u4E0B\u6587\uFF0C\u53EF\u4EE5\u8FD0\u884C <code>kubectl --kubeconfig=config-demo config unset contexts.&lt;name&gt;</code> :::</li></ul><h2 id="\u751F\u6210kubeconfig\u7684\u914D\u7F6E\u6B65\u9AA4" tabindex="-1"><a class="header-anchor" href="#\u751F\u6210kubeconfig\u7684\u914D\u7F6E\u6B65\u9AA4" aria-hidden="true">#</a> \u751F\u6210kubeconfig\u7684\u914D\u7F6E\u6B65\u9AA4</h2><p><strong>\u5B9A\u4E49\u53D8\u91CF\uFF1A</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>export KUBE_APISERVER=&quot;https://172.20.0.2:6443&quot; 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>\u8BBE\u7F6E\u96C6\u7FA4\u53C2\u6570\uFF1A</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubectl config set-cluster kubernetes   --certificate-authority<span class="token operator">=</span>/etc/kubernetes/ssl/ca.pem   --embed-certs<span class="token operator">=</span>true   <span class="token parameter variable">--server</span><span class="token operator">=</span><span class="token variable">\${KUBE_APISERVER}</span>   <span class="token comment">#\u53EF\u4EE5\u6307\u5B9A\u8DEF\u5F84kubeconfig=/root/config.conf</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>\u8BF4\u660E\uFF1A\u96C6\u7FA4\u53C2\u6570\u4E3B\u8981\u8BBE\u7F6E\u4E86\u6240\u9700\u8981\u8BBF\u95EE\u7684\u96C6\u7FA4\u7684\u4FE1\u606F\u3002\u4F7F\u7528 <code>set-cluster</code> \u8BBE\u7F6E\u4E86\u9700\u8981\u8BBF\u95EE\u7684\u96C6\u7FA4\uFF0C\u5982\u4E0A\u4E3A <code>kubernetes</code>\uFF1B<code>--certificate-authority</code>\u8BBE\u7F6E\u4E86\u8BE5\u96C6\u7FA4\u7684\u516C\u94A5\uFF1B<code>--embed-certs</code>\u4E3A <code>true</code> \u8868\u793A\u5C06 <code>--certificate-authority</code> \u8BC1\u4E66\u5199\u5165\u5230 <code>kubeconfig</code> \u4E2D\uFF1B<code>--server</code>\u5219\u8868\u793A\u8BE5\u96C6\u7FA4\u7684 kube-apiserver \u5730\u5740\u3002</p></blockquote><p><strong>\u8BBE\u7F6E\u5BA2\u6237\u7AEF\u8BA4\u8BC1\u53C2\u6570\uFF1A</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubectl config set-credentials admin   --client-certificate<span class="token operator">=</span>/etc/kubernetes/ssl/admin.pem   --embed-certs<span class="token operator">=</span>true   --client-key<span class="token operator">=</span>/etc/kubernetes/ssl/admin-key.pem <span class="token comment">#\u53EF\u4EE5\u6307\u5B9A\u8DEF\u5F84kubeconfig=/root/config.conf</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>\u8BF4\u660E\uFF1A\u7528\u6237\u53C2\u6570\u4E3B\u8981\u8BBE\u7F6E\u7528\u6237\u7684\u76F8\u5173\u4FE1\u606F\uFF0C\u4E3B\u8981\u662F\u7528\u6237\u8BC1\u4E66\u3002\u5982\u4E0A\u7684\u7528\u6237\u540D\u4E3Aadmin\uFF0C\u8BC1\u4E66\u4E3A\uFF1A/etc/kubernetes/ssl/admin.pem\uFF0C\u79C1\u94A5\u4E3A\uFF1A/etc/kubernetes/ssl/admin-key.pem\u3002\u6CE8\u610F\u5BA2\u6237\u7AEF\u7684\u8BC1\u4E66\u9996\u5148\u8981\u7ECF\u8FC7\u96C6\u7FA4CA\u7684\u7B7E\u7F72\uFF0C\u5426\u5219\u4E0D\u4F1A\u88AB\u96C6\u7FA4\u8BA4\u53EF\u3002\u6B64\u5904\u4F7F\u7528\u7684\u662Fca\u8BA4\u8BC1\u65B9\u5F0F\uFF0C\u4E5F\u53EF\u4EE5\u4F7F\u7528token\u8BA4\u8BC1\uFF0C\u5982kubelet\u7684 TLS Boostrap\u673A\u5236\u4E0B\u7684bootstrapping\u4F7F\u7528\u7684\u5C31\u662Ftoken\u8BA4\u8BC1\u65B9\u5F0F\u3002</p></blockquote><p><strong>\u8BBE\u7F6E\u4E0A\u4E0B\u6587\u53C2\u6570\uFF1A</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubectl config set-context kubernetes   <span class="token parameter variable">--cluster</span><span class="token operator">=</span>kubernetes   <span class="token parameter variable">--user</span><span class="token operator">=</span>admin <span class="token comment">#\u53EF\u4EE5\u6307\u5B9A\u8DEF\u5F84kubeconfig=/root/config.conf</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>\u8BF4\u660E\uFF1A\u4E0A\u4E0B\u6587\u53C2\u6570\u5C06<strong>\u96C6\u7FA4\u53C2\u6570</strong>\u548C<strong>\u7528\u6237\u53C2\u6570</strong>\u5173\u8054\u8D77\u6765\u3002\u5982\u4E0A\u9762\u7684\u4E0A\u4E0B\u6587\u540D\u79F0\u4E3Akubenetes\uFF0C\u96C6\u7FA4\u4E3Akubenetes\uFF0C\u7528\u6237\u4E3Aadmin\uFF0C\u8868\u793A\u4F7F\u7528admin\u7684\u7528\u6237\u51ED\u8BC1\u6765\u8BBF\u95EEkubenetes\u96C6\u7FA4\u7684default\u547D\u540D\u7A7A\u95F4\uFF0C\u4E5F\u53EF\u4EE5\u589E\u52A0--namspace\u6765\u6307\u5B9A\u8BBF\u95EE\u7684\u547D\u540D\u7A7A\u95F4\u3002</p></blockquote><p><strong>\u8BBE\u7F6E\u9ED8\u8BA4\u4E0A\u4E0B\u6587</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubectl config use-context kubernetes  <span class="token comment">#\u53EF\u4EE5\u6307\u5B9A\u8DEF\u5F84kubeconfig=/root/config.conf</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>\u8BF4\u660E\uFF1A\u6700\u540E\u4F7F\u7528kubectl config use-context kubernetes\u6765\u4F7F\u7528\u540D\u4E3Akubenetes\u7684\u73AF\u5883\u9879\u6765\u4F5C\u4E3A\u914D\u7F6E\u3002\u5982\u679C\u914D\u7F6E\u4E86\u591A\u4E2A\u73AF\u5883\u9879\uFF0C\u53EF\u901A\u8FC7\u5207\u6362\u4E0D\u540C\u7684\u73AF\u5883\u9879\u540D\u5B57\u6765\u8BBF\u95EE\u5230\u4E0D\u540C\u7684\u96C6\u7FA4\u73AF\u5883\u3002</p></blockquote><p>\u9ED8\u8BA4\u751F\u6210\u7684 <code>kubeconfig</code> \u88AB\u4FDD\u5B58\u5230 <code>~/.kube/config</code> \u6587\u4EF6</p><h2 id="end-\u94FE\u63A5" tabindex="-1"><a class="header-anchor" href="#end-\u94FE\u63A5" aria-hidden="true">#</a> END \u94FE\u63A5</h2><ul><li><div><a href="22.md" style="float:left;">\u2B06\uFE0F\u4E0A\u4E00\u8282\u{1F517} </a><a href="24.md" style="float:right;"> \uFE0F\u4E0B\u4E00\u8282\u{1F517}</a></div></li></ul>`,21),Nn=e("\u24C2\uFE0F\u56DE\u5230\u76EE\u5F55\u{1F3E0}"),Bn={href:"https://nsddd.top/archives/contributors",target:"_blank",rel:"noopener noreferrer"},On=n("strong",null,"\u{1FAF5}\u53C2\u4E0E\u8D21\u732E\u{1F49E}\u2764\uFE0F\u200D\u{1F525}\u{1F496}",-1),An=e(")"),Tn=e("\u2734\uFE0F\u7248\u6743\u58F0\u660E \xA9 \uFF1A\u672C\u4E66\u6240\u6709\u5185\u5BB9\u9075\u5FAA"),Sn={href:"http://zh.wikipedia.org/wiki/Wikipedia:CC-by-sa-3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC",target:"_blank",rel:"noopener noreferrer"},Fn=e("CC-BY-SA 3.0\u534F\u8BAE\uFF08\u7F72\u540D-\u76F8\u540C\u65B9\u5F0F\u5171\u4EAB\uFF09\xA9");function Un(Gn,Ln){const t=o("ExternalLinkIcon"),i=o("router-link"),c=o("RouterLink");return d(),u("div",null,[n("ul",null,[n("li",null,[n("a",v,[b,s(t)])])]),k,m,h,n("blockquote",null,[n("p",null,[g,n("a",f,[_,s(t)])])]),y,x,n("nav",q,[n("ul",null,[n("li",null,[s(i,{to:"#\u524D\u8A00"},{default:a(()=>[E]),_:1})]),n("li",null,[s(i,{to:"#\u547D\u4EE4\u53C2\u6570"},{default:a(()=>[w]),_:1})]),n("li",null,[s(i,{to:"#\u4F7F\u7528-kubeconfig-\u6587\u4EF6\u7EC4\u7EC7\u96C6\u7FA4\u8BBF\u95EE"},{default:a(()=>[C]),_:1})]),n("li",null,[s(i,{to:"#\u652F\u6301\u591A\u96C6\u7FA4\u3001\u591A\u7528\u6237\u3001\u591A\u8BA4\u8BC1\u673A\u5236"},{default:a(()=>[I]),_:1})]),n("li",null,[s(i,{to:"#\u4E0A\u4E0B\u6587-context"},{default:a(()=>[K]),_:1})]),n("li",null,[s(i,{to:"#kubeconfig-\u73AF\u5883\u53D8\u91CF"},{default:a(()=>[N]),_:1})]),n("li",null,[s(i,{to:"#\u5408\u5E76-kubeconfig-\u6587\u4EF6"},{default:a(()=>[B]),_:1})]),n("li",null,[s(i,{to:"#\u6587\u4EF6\u5F15\u7528"},{default:a(()=>[O]),_:1})]),n("li",null,[s(i,{to:"#kubeconfig-\u4E24\u79CD\u5B9E\u73B0\u65B9\u5F0F"},{default:a(()=>[A]),_:1})]),n("li",null,[s(i,{to:"#\u4EE3\u7406"},{default:a(()=>[T]),_:1})]),n("li",null,[s(i,{to:"#\u5B9A\u4E49\u96C6\u7FA4-\u7528\u6237\u548C-context"},{default:a(()=>[S]),_:1})]),n("li",null,[s(i,{to:"#\u751F\u6210kubeconfig\u7684\u914D\u7F6E\u6B65\u9AA4"},{default:a(()=>[F]),_:1})]),n("li",null,[s(i,{to:"#end-\u94FE\u63A5"},{default:a(()=>[U]),_:1})])])]),G,n("div",L,[D,M,P,n("p",null,[V,n("a",z,[R,s(t)]),H])]),n("details",W,[$,n("ul",null,[n("li",null,[n("a",Z,[j,s(t)])])]),J]),Y,n("p",null,[Q,X,nn,en,sn,an,tn,ln,on,n("a",cn,[rn,s(t)]),dn]),n("h2",un,[pn,vn,n("a",bn,[s(t)])]),kn,n("p",null,[mn,hn,gn,n("a",fn,[_n,s(t)]),yn]),xn,n("div",qn,[En,n("p",null,[wn,n("a",Cn,[In,s(t)])])]),Kn,n("ul",null,[n("li",null,[n("p",null,[s(c,{to:"/"},{default:a(()=>[Nn]),_:1})])]),n("li",null,[n("p",null,[n("a",Bn,[On,s(t)]),An])]),n("li",null,[n("p",null,[Tn,n("a",Sn,[Fn,s(t)])])])])])}const Mn=r(p,[["render",Un],["__file","23.html.vue"]]);export{Mn as default};
