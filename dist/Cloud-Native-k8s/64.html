<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.51">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/img/1.jpg"><title>第64节 kubeadm概述、原理、以及部分源码阅读 | 你好</title><meta name="description" content="链学社致力于打造出区块链去中心化的学习平台">
    <link rel="modulepreload" href="/assets/app.f2f3c0f5.js"><link rel="modulepreload" href="/assets/64.html.3418e44d.js"><link rel="modulepreload" href="/assets/64.html.875cd724.js"><link rel="prefetch" href="/assets/index.html.c499f25b.js"><link rel="prefetch" href="/assets/1.html.fd204fdb.js"><link rel="prefetch" href="/assets/10.html.b7ebfc66.js"><link rel="prefetch" href="/assets/11.html.2e4c4099.js"><link rel="prefetch" href="/assets/12.html.693741b8.js"><link rel="prefetch" href="/assets/13.html.2dae1833.js"><link rel="prefetch" href="/assets/14.html.a87633d9.js"><link rel="prefetch" href="/assets/15.html.88e104a0.js"><link rel="prefetch" href="/assets/16.html.8930277d.js"><link rel="prefetch" href="/assets/17.html.8ade317c.js"><link rel="prefetch" href="/assets/18.html.3b6fe606.js"><link rel="prefetch" href="/assets/19.html.19b0e452.js"><link rel="prefetch" href="/assets/2.html.f043ee1f.js"><link rel="prefetch" href="/assets/20.html.537d64f6.js"><link rel="prefetch" href="/assets/21.html.9eba97d7.js"><link rel="prefetch" href="/assets/22.html.eb5ddb66.js"><link rel="prefetch" href="/assets/23.html.2aa6b813.js"><link rel="prefetch" href="/assets/24.html.1abb586c.js"><link rel="prefetch" href="/assets/25.html.129b8aee.js"><link rel="prefetch" href="/assets/26.html.f00952bd.js"><link rel="prefetch" href="/assets/27.html.bb3833c5.js"><link rel="prefetch" href="/assets/28.html.de76c576.js"><link rel="prefetch" href="/assets/29.html.efa508a0.js"><link rel="prefetch" href="/assets/3.html.3d64c7db.js"><link rel="prefetch" href="/assets/30.html.bb990189.js"><link rel="prefetch" href="/assets/31.html.220881c1.js"><link rel="prefetch" href="/assets/32.html.02e7faad.js"><link rel="prefetch" href="/assets/33.html.9b5caaf0.js"><link rel="prefetch" href="/assets/34.html.b0f614b8.js"><link rel="prefetch" href="/assets/35.html.93b92893.js"><link rel="prefetch" href="/assets/36.html.4c610e94.js"><link rel="prefetch" href="/assets/37.html.9db997c0.js"><link rel="prefetch" href="/assets/38.html.ad90b9e2.js"><link rel="prefetch" href="/assets/39.html.2bfac0cc.js"><link rel="prefetch" href="/assets/4.html.76cf4339.js"><link rel="prefetch" href="/assets/40.html.b1fcd673.js"><link rel="prefetch" href="/assets/41.html.f745a493.js"><link rel="prefetch" href="/assets/42.html.0ec24f8a.js"><link rel="prefetch" href="/assets/43.html.bcf1cf6e.js"><link rel="prefetch" href="/assets/44.html.e47ed028.js"><link rel="prefetch" href="/assets/45.html.08592f76.js"><link rel="prefetch" href="/assets/46.html.390db4b9.js"><link rel="prefetch" href="/assets/47.html.4a2b4f6c.js"><link rel="prefetch" href="/assets/48.html.62b19efd.js"><link rel="prefetch" href="/assets/49.html.eddc3fad.js"><link rel="prefetch" href="/assets/5.html.cb9993c6.js"><link rel="prefetch" href="/assets/50.html.c26fc22a.js"><link rel="prefetch" href="/assets/51.html.d8ff9202.js"><link rel="prefetch" href="/assets/52.html.29e25dea.js"><link rel="prefetch" href="/assets/53.html.ce5d558a.js"><link rel="prefetch" href="/assets/54.html.009cb3de.js"><link rel="prefetch" href="/assets/55.html.b04523dd.js"><link rel="prefetch" href="/assets/56.html.76e64836.js"><link rel="prefetch" href="/assets/57.html.c8708708.js"><link rel="prefetch" href="/assets/58.html.b8af7773.js"><link rel="prefetch" href="/assets/59.html.5dd6a8e8.js"><link rel="prefetch" href="/assets/6.html.7f20f46a.js"><link rel="prefetch" href="/assets/60.html.108c3a17.js"><link rel="prefetch" href="/assets/61.html.2b8a99b9.js"><link rel="prefetch" href="/assets/62.html.7fe3aa41.js"><link rel="prefetch" href="/assets/63.html.ae22611b.js"><link rel="prefetch" href="/assets/64.html.327e22c7.js"><link rel="prefetch" href="/assets/65.html.c010cd61.js"><link rel="prefetch" href="/assets/66.html.09006efe.js"><link rel="prefetch" href="/assets/67.html.c44147c4.js"><link rel="prefetch" href="/assets/68.html.5123bdda.js"><link rel="prefetch" href="/assets/69.html.709fcbfa.js"><link rel="prefetch" href="/assets/7.html.73107fb7.js"><link rel="prefetch" href="/assets/70.html.d5175b4e.js"><link rel="prefetch" href="/assets/71.html.5c7276ad.js"><link rel="prefetch" href="/assets/72.html.be0505f9.js"><link rel="prefetch" href="/assets/73.html.945cee02.js"><link rel="prefetch" href="/assets/74.html.ed0427d0.js"><link rel="prefetch" href="/assets/75.html.22eaa4c1.js"><link rel="prefetch" href="/assets/76.html.83a60559.js"><link rel="prefetch" href="/assets/77.html.6a485035.js"><link rel="prefetch" href="/assets/78.html.5184af63.js"><link rel="prefetch" href="/assets/79.html.f31f80ee.js"><link rel="prefetch" href="/assets/8.html.0592d8bf.js"><link rel="prefetch" href="/assets/80.html.71fe2de3.js"><link rel="prefetch" href="/assets/81.html.674b9f45.js"><link rel="prefetch" href="/assets/82.html.84a9da67.js"><link rel="prefetch" href="/assets/83.html.f9366f23.js"><link rel="prefetch" href="/assets/84.html.077d9bdc.js"><link rel="prefetch" href="/assets/85.html.afe84b99.js"><link rel="prefetch" href="/assets/86.html.0cab34db.js"><link rel="prefetch" href="/assets/87.html.f2d70c50.js"><link rel="prefetch" href="/assets/88.html.3842a471.js"><link rel="prefetch" href="/assets/89.html.bd36ae29.js"><link rel="prefetch" href="/assets/9.html.8b1df622.js"><link rel="prefetch" href="/assets/90.html.59d1af05.js"><link rel="prefetch" href="/assets/91.html.bff9db18.js"><link rel="prefetch" href="/assets/92.html.8d1d3932.js"><link rel="prefetch" href="/assets/93.html.2e25826f.js"><link rel="prefetch" href="/assets/94.html.3bf21ffb.js"><link rel="prefetch" href="/assets/95.html.703f578c.js"><link rel="prefetch" href="/assets/96.html.b168fbc0.js"><link rel="prefetch" href="/assets/97.html.9a9e7eb7.js"><link rel="prefetch" href="/assets/98.html.dba9b839.js"><link rel="prefetch" href="/assets/99.html.403135da.js"><link rel="prefetch" href="/assets/index.html.90f79834.js"><link rel="prefetch" href="/assets/TODO.html.830317c3.js"><link rel="prefetch" href="/assets/1.html.9e750f7a.js"><link rel="prefetch" href="/assets/10.html.e77e0455.js"><link rel="prefetch" href="/assets/11.html.7e785902.js"><link rel="prefetch" href="/assets/12.html.1599a54d.js"><link rel="prefetch" href="/assets/13.html.70628749.js"><link rel="prefetch" href="/assets/14.html.18e6797b.js"><link rel="prefetch" href="/assets/15.html.df743cd2.js"><link rel="prefetch" href="/assets/16.html.55d56ea8.js"><link rel="prefetch" href="/assets/17.html.6874d49f.js"><link rel="prefetch" href="/assets/18.html.65b90de4.js"><link rel="prefetch" href="/assets/19.html.dde6b661.js"><link rel="prefetch" href="/assets/2.html.e1274803.js"><link rel="prefetch" href="/assets/20.html.0fe80452.js"><link rel="prefetch" href="/assets/21.html.f85d8468.js"><link rel="prefetch" href="/assets/22.html.0afb63ed.js"><link rel="prefetch" href="/assets/23.html.acd56ad8.js"><link rel="prefetch" href="/assets/24.html.f874b480.js"><link rel="prefetch" href="/assets/25.html.e020387b.js"><link rel="prefetch" href="/assets/26.html.ccbed0cc.js"><link rel="prefetch" href="/assets/27.html.148446d1.js"><link rel="prefetch" href="/assets/28.html.a94af5c0.js"><link rel="prefetch" href="/assets/29.html.aa33eff4.js"><link rel="prefetch" href="/assets/3.html.cac76b28.js"><link rel="prefetch" href="/assets/30.html.6c68425a.js"><link rel="prefetch" href="/assets/31.html.9b16aa42.js"><link rel="prefetch" href="/assets/32.html.6d1882b9.js"><link rel="prefetch" href="/assets/33.html.450fcdf8.js"><link rel="prefetch" href="/assets/34.html.b2875ca6.js"><link rel="prefetch" href="/assets/35.html.b9867f79.js"><link rel="prefetch" href="/assets/36.html.614ee854.js"><link rel="prefetch" href="/assets/37.html.2d010e5c.js"><link rel="prefetch" href="/assets/38.html.db03c609.js"><link rel="prefetch" href="/assets/39.html.dae7a11d.js"><link rel="prefetch" href="/assets/4.html.d793bb26.js"><link rel="prefetch" href="/assets/40.html.78ecc669.js"><link rel="prefetch" href="/assets/41.html.f71f97a0.js"><link rel="prefetch" href="/assets/42.html.8af2270a.js"><link rel="prefetch" href="/assets/43.html.aeab5555.js"><link rel="prefetch" href="/assets/44.html.ca417de8.js"><link rel="prefetch" href="/assets/45.html.26989a52.js"><link rel="prefetch" href="/assets/46.html.48fe7270.js"><link rel="prefetch" href="/assets/47.html.3e47ee65.js"><link rel="prefetch" href="/assets/48.html.d08a8b7f.js"><link rel="prefetch" href="/assets/49.html.1c55cdc2.js"><link rel="prefetch" href="/assets/5.html.f58f6203.js"><link rel="prefetch" href="/assets/50.html.581cdfdd.js"><link rel="prefetch" href="/assets/51.html.143c32e9.js"><link rel="prefetch" href="/assets/52.html.7488aa3f.js"><link rel="prefetch" href="/assets/53.html.df9bfd27.js"><link rel="prefetch" href="/assets/54.html.97e0befc.js"><link rel="prefetch" href="/assets/55.html.9f2e0fc4.js"><link rel="prefetch" href="/assets/56.html.832dc435.js"><link rel="prefetch" href="/assets/57.html.55b5f82f.js"><link rel="prefetch" href="/assets/58.html.f97be2b4.js"><link rel="prefetch" href="/assets/59.html.c2454b9d.js"><link rel="prefetch" href="/assets/6.html.2b7b8ad3.js"><link rel="prefetch" href="/assets/60.html.5867f9c4.js"><link rel="prefetch" href="/assets/61.html.1e8bbff2.js"><link rel="prefetch" href="/assets/62.html.ce4e8457.js"><link rel="prefetch" href="/assets/63.html.b668ae9a.js"><link rel="prefetch" href="/assets/65.html.53b86f35.js"><link rel="prefetch" href="/assets/66.html.a502d8c9.js"><link rel="prefetch" href="/assets/67.html.7d2e39ec.js"><link rel="prefetch" href="/assets/68.html.4430bebd.js"><link rel="prefetch" href="/assets/69.html.bf5ab228.js"><link rel="prefetch" href="/assets/7.html.44323637.js"><link rel="prefetch" href="/assets/70.html.aa695972.js"><link rel="prefetch" href="/assets/71.html.e0baecdf.js"><link rel="prefetch" href="/assets/72.html.3ed54957.js"><link rel="prefetch" href="/assets/73.html.3269221e.js"><link rel="prefetch" href="/assets/74.html.d36867b2.js"><link rel="prefetch" href="/assets/75.html.8b1ecf89.js"><link rel="prefetch" href="/assets/76.html.6edcd166.js"><link rel="prefetch" href="/assets/77.html.e7635ab7.js"><link rel="prefetch" href="/assets/78.html.0de8f8e0.js"><link rel="prefetch" href="/assets/79.html.b84c0c1d.js"><link rel="prefetch" href="/assets/8.html.fbdd9051.js"><link rel="prefetch" href="/assets/80.html.72b53b23.js"><link rel="prefetch" href="/assets/81.html.2df80b97.js"><link rel="prefetch" href="/assets/82.html.ad487a1e.js"><link rel="prefetch" href="/assets/83.html.c2f31839.js"><link rel="prefetch" href="/assets/84.html.8f08ca4d.js"><link rel="prefetch" href="/assets/85.html.58986e20.js"><link rel="prefetch" href="/assets/86.html.b208cc40.js"><link rel="prefetch" href="/assets/87.html.c3518680.js"><link rel="prefetch" href="/assets/88.html.4987ffcc.js"><link rel="prefetch" href="/assets/89.html.ba926430.js"><link rel="prefetch" href="/assets/9.html.1b790a84.js"><link rel="prefetch" href="/assets/90.html.21f82605.js"><link rel="prefetch" href="/assets/91.html.b7301274.js"><link rel="prefetch" href="/assets/92.html.3662bc0c.js"><link rel="prefetch" href="/assets/93.html.e2ac0831.js"><link rel="prefetch" href="/assets/94.html.02d9e407.js"><link rel="prefetch" href="/assets/95.html.10a9639a.js"><link rel="prefetch" href="/assets/96.html.62960ce9.js"><link rel="prefetch" href="/assets/97.html.d0ab9bbe.js"><link rel="prefetch" href="/assets/98.html.89ca1b0b.js"><link rel="prefetch" href="/assets/99.html.5143f23b.js"><link rel="prefetch" href="/assets/index.html.43f40a16.js"><link rel="prefetch" href="/assets/1.html.bd959b6e.js"><link rel="prefetch" href="/assets/10.html.ae2469e0.js"><link rel="prefetch" href="/assets/11.html.cf3c12f9.js"><link rel="prefetch" href="/assets/12.html.a0411a0f.js"><link rel="prefetch" href="/assets/13.html.2caa0b00.js"><link rel="prefetch" href="/assets/14.html.381371db.js"><link rel="prefetch" href="/assets/15.html.e47b1665.js"><link rel="prefetch" href="/assets/16.html.30b1bf5d.js"><link rel="prefetch" href="/assets/17.html.073b9d56.js"><link rel="prefetch" href="/assets/18.html.8c025525.js"><link rel="prefetch" href="/assets/19.html.f06d2ea4.js"><link rel="prefetch" href="/assets/2.html.c24a2383.js"><link rel="prefetch" href="/assets/20.html.9e702c70.js"><link rel="prefetch" href="/assets/21.html.087be0ef.js"><link rel="prefetch" href="/assets/22.html.67972d7c.js"><link rel="prefetch" href="/assets/23.html.7f287dfd.js"><link rel="prefetch" href="/assets/24.html.e8034405.js"><link rel="prefetch" href="/assets/25.html.8bdb4208.js"><link rel="prefetch" href="/assets/26.html.52f08579.js"><link rel="prefetch" href="/assets/27.html.16632077.js"><link rel="prefetch" href="/assets/28.html.6d11f2d1.js"><link rel="prefetch" href="/assets/29.html.059e6730.js"><link rel="prefetch" href="/assets/3.html.b3db0053.js"><link rel="prefetch" href="/assets/30.html.a53b02db.js"><link rel="prefetch" href="/assets/31.html.0b37e7ce.js"><link rel="prefetch" href="/assets/32.html.cea0c777.js"><link rel="prefetch" href="/assets/33.html.ff558a34.js"><link rel="prefetch" href="/assets/34.html.e8b4b97e.js"><link rel="prefetch" href="/assets/35.html.cb802a9c.js"><link rel="prefetch" href="/assets/36.html.a719dfcb.js"><link rel="prefetch" href="/assets/37.html.d139e2b1.js"><link rel="prefetch" href="/assets/38.html.89fc986d.js"><link rel="prefetch" href="/assets/39.html.f9fda674.js"><link rel="prefetch" href="/assets/4.html.0f09f509.js"><link rel="prefetch" href="/assets/40.html.8a6f76c5.js"><link rel="prefetch" href="/assets/41.html.da32683f.js"><link rel="prefetch" href="/assets/42.html.19b82696.js"><link rel="prefetch" href="/assets/43.html.d3c5a1fb.js"><link rel="prefetch" href="/assets/44.html.37c86fd1.js"><link rel="prefetch" href="/assets/45.html.49d43e8d.js"><link rel="prefetch" href="/assets/46.html.c897c137.js"><link rel="prefetch" href="/assets/47.html.9fc11c19.js"><link rel="prefetch" href="/assets/48.html.61399716.js"><link rel="prefetch" href="/assets/49.html.4bff12f5.js"><link rel="prefetch" href="/assets/5.html.c137122b.js"><link rel="prefetch" href="/assets/6.html.082624e8.js"><link rel="prefetch" href="/assets/7.html.a4ae3c8b.js"><link rel="prefetch" href="/assets/8.html.9f5571b9.js"><link rel="prefetch" href="/assets/9.html.9d8ed5f6.js"><link rel="prefetch" href="/assets/1.html.fefabf1f.js"><link rel="prefetch" href="/assets/10.html.a591fdaf.js"><link rel="prefetch" href="/assets/11.html.f0c58879.js"><link rel="prefetch" href="/assets/12.html.6174ec90.js"><link rel="prefetch" href="/assets/13.html.181888e9.js"><link rel="prefetch" href="/assets/14.html.7b106669.js"><link rel="prefetch" href="/assets/15.html.c0e4acaa.js"><link rel="prefetch" href="/assets/16.html.7a3ba1ea.js"><link rel="prefetch" href="/assets/17.html.7a0b131d.js"><link rel="prefetch" href="/assets/18.html.a9e5ae4a.js"><link rel="prefetch" href="/assets/19.html.f9a1dad0.js"><link rel="prefetch" href="/assets/2.html.47656e60.js"><link rel="prefetch" href="/assets/20.html.7990e495.js"><link rel="prefetch" href="/assets/21.html.10de0a75.js"><link rel="prefetch" href="/assets/22.html.ccdeb6c4.js"><link rel="prefetch" href="/assets/23.html.371d6681.js"><link rel="prefetch" href="/assets/24.html.1e3b14eb.js"><link rel="prefetch" href="/assets/25.html.ce330676.js"><link rel="prefetch" href="/assets/26.html.d044406f.js"><link rel="prefetch" href="/assets/27.html.ccc926f6.js"><link rel="prefetch" href="/assets/28.html.49f5cbc7.js"><link rel="prefetch" href="/assets/29.html.f44fb171.js"><link rel="prefetch" href="/assets/3.html.44eda9ad.js"><link rel="prefetch" href="/assets/30.html.71962bb9.js"><link rel="prefetch" href="/assets/31.html.05d73e5f.js"><link rel="prefetch" href="/assets/32.html.e98a73d9.js"><link rel="prefetch" href="/assets/33.html.55b3c6fb.js"><link rel="prefetch" href="/assets/34.html.5146048c.js"><link rel="prefetch" href="/assets/35.html.51cb1df4.js"><link rel="prefetch" href="/assets/36.html.dea92735.js"><link rel="prefetch" href="/assets/37.html.4987df3a.js"><link rel="prefetch" href="/assets/38.html.94359779.js"><link rel="prefetch" href="/assets/39.html.e9fb19b6.js"><link rel="prefetch" href="/assets/4.html.11bb9c93.js"><link rel="prefetch" href="/assets/40.html.12ce2063.js"><link rel="prefetch" href="/assets/41.html.17b39dbf.js"><link rel="prefetch" href="/assets/42.html.737c2f7f.js"><link rel="prefetch" href="/assets/43.html.4aa549bb.js"><link rel="prefetch" href="/assets/44.html.461dd21b.js"><link rel="prefetch" href="/assets/45.html.f7fa8b44.js"><link rel="prefetch" href="/assets/46.html.0c1c3d86.js"><link rel="prefetch" href="/assets/47.html.7a6006c3.js"><link rel="prefetch" href="/assets/48.html.876530ae.js"><link rel="prefetch" href="/assets/49.html.93195ef1.js"><link rel="prefetch" href="/assets/5.html.d52a2513.js"><link rel="prefetch" href="/assets/50.html.ae771c42.js"><link rel="prefetch" href="/assets/6.html.6207e399.js"><link rel="prefetch" href="/assets/7.html.60b74bd7.js"><link rel="prefetch" href="/assets/8.html.4ebadc89.js"><link rel="prefetch" href="/assets/9.html.38305fea.js"><link rel="prefetch" href="/assets/k8s_011.html.a02b632d.js"><link rel="prefetch" href="/assets/k8s_012.html.43d51b72.js"><link rel="prefetch" href="/assets/k8s_013.html.ec5b47f7.js"><link rel="prefetch" href="/assets/k8s_014.html.f6d97c90.js"><link rel="prefetch" href="/assets/k8s_015.html.e0a1919b.js"><link rel="prefetch" href="/assets/k8s_016.html.3974eb6c.js"><link rel="prefetch" href="/assets/k8s_017.html.75871624.js"><link rel="prefetch" href="/assets/k8s_018.html.12099bf7.js"><link rel="prefetch" href="/assets/k8s_019.html.056e3a37.js"><link rel="prefetch" href="/assets/k8s_020.html.81fc58d1.js"><link rel="prefetch" href="/assets/k8s_021.html.28a3099b.js"><link rel="prefetch" href="/assets/k8s_022.html.bd4c9467.js"><link rel="prefetch" href="/assets/k8s_023.html.ffd7194a.js"><link rel="prefetch" href="/assets/k8s_024.html.3422943c.js"><link rel="prefetch" href="/assets/k8s_025.html.29b4b1e1.js"><link rel="prefetch" href="/assets/k8s_026.html.37a39c28.js"><link rel="prefetch" href="/assets/k8s_027.html.ffb2e25f.js"><link rel="prefetch" href="/assets/k8s_028.html.d98c6ad6.js"><link rel="prefetch" href="/assets/k8s_029.html.ca41febf.js"><link rel="prefetch" href="/assets/k8s_030.html.9902d045.js"><link rel="prefetch" href="/assets/README (copy).html.e4b91025.js"><link rel="prefetch" href="/assets/index.html.32aff7af.js"><link rel="prefetch" href="/assets/404.html.c3e557d0.js"><link rel="prefetch" href="/assets/index.html.962cde63.js"><link rel="prefetch" href="/assets/1.html.d1721624.js"><link rel="prefetch" href="/assets/10.html.3c1a665b.js"><link rel="prefetch" href="/assets/11.html.ef2d507c.js"><link rel="prefetch" href="/assets/12.html.4c06561f.js"><link rel="prefetch" href="/assets/13.html.986b6e44.js"><link rel="prefetch" href="/assets/14.html.80cf1bd3.js"><link rel="prefetch" href="/assets/15.html.a037aa3b.js"><link rel="prefetch" href="/assets/16.html.0b1e0073.js"><link rel="prefetch" href="/assets/17.html.2390897a.js"><link rel="prefetch" href="/assets/18.html.2613edba.js"><link rel="prefetch" href="/assets/19.html.2a75cba1.js"><link rel="prefetch" href="/assets/2.html.cdc9b0b2.js"><link rel="prefetch" href="/assets/20.html.e1bdcc41.js"><link rel="prefetch" href="/assets/21.html.0612af42.js"><link rel="prefetch" href="/assets/22.html.5053237b.js"><link rel="prefetch" href="/assets/23.html.c81e09d2.js"><link rel="prefetch" href="/assets/24.html.a9990682.js"><link rel="prefetch" href="/assets/25.html.e2ab365f.js"><link rel="prefetch" href="/assets/26.html.2a5d5118.js"><link rel="prefetch" href="/assets/27.html.45f6fd87.js"><link rel="prefetch" href="/assets/28.html.a8fb877d.js"><link rel="prefetch" href="/assets/29.html.d71f2800.js"><link rel="prefetch" href="/assets/3.html.f89bd3ce.js"><link rel="prefetch" href="/assets/30.html.f077bd49.js"><link rel="prefetch" href="/assets/31.html.8e98ca79.js"><link rel="prefetch" href="/assets/32.html.71945f5f.js"><link rel="prefetch" href="/assets/33.html.6a2d835e.js"><link rel="prefetch" href="/assets/34.html.ce1e99c9.js"><link rel="prefetch" href="/assets/35.html.f4f0b52b.js"><link rel="prefetch" href="/assets/36.html.d3e09a82.js"><link rel="prefetch" href="/assets/37.html.cd87fed5.js"><link rel="prefetch" href="/assets/38.html.a49a875a.js"><link rel="prefetch" href="/assets/39.html.d141112a.js"><link rel="prefetch" href="/assets/4.html.6d9f98f0.js"><link rel="prefetch" href="/assets/40.html.4a087e06.js"><link rel="prefetch" href="/assets/41.html.55025f16.js"><link rel="prefetch" href="/assets/42.html.881a76a0.js"><link rel="prefetch" href="/assets/43.html.d419cb8f.js"><link rel="prefetch" href="/assets/44.html.e61c51a6.js"><link rel="prefetch" href="/assets/45.html.4c9668f2.js"><link rel="prefetch" href="/assets/46.html.a4e7bb02.js"><link rel="prefetch" href="/assets/47.html.0d5ec603.js"><link rel="prefetch" href="/assets/48.html.3dea757a.js"><link rel="prefetch" href="/assets/49.html.1b1957f9.js"><link rel="prefetch" href="/assets/5.html.56983f85.js"><link rel="prefetch" href="/assets/50.html.a534c2a8.js"><link rel="prefetch" href="/assets/51.html.fab3abce.js"><link rel="prefetch" href="/assets/52.html.a9be0c2f.js"><link rel="prefetch" href="/assets/53.html.f0520deb.js"><link rel="prefetch" href="/assets/54.html.9c8308ca.js"><link rel="prefetch" href="/assets/55.html.276bc729.js"><link rel="prefetch" href="/assets/56.html.27d074e2.js"><link rel="prefetch" href="/assets/57.html.9e934940.js"><link rel="prefetch" href="/assets/58.html.5ead26c7.js"><link rel="prefetch" href="/assets/59.html.d25abf23.js"><link rel="prefetch" href="/assets/6.html.41e42d8a.js"><link rel="prefetch" href="/assets/60.html.dfed4ab4.js"><link rel="prefetch" href="/assets/61.html.d22e7ab9.js"><link rel="prefetch" href="/assets/62.html.981fe677.js"><link rel="prefetch" href="/assets/63.html.62ec2b1b.js"><link rel="prefetch" href="/assets/64.html.ee1b2030.js"><link rel="prefetch" href="/assets/65.html.4ac3453e.js"><link rel="prefetch" href="/assets/66.html.c2c1f73d.js"><link rel="prefetch" href="/assets/67.html.605a59cd.js"><link rel="prefetch" href="/assets/68.html.3d967c94.js"><link rel="prefetch" href="/assets/69.html.264f3fd6.js"><link rel="prefetch" href="/assets/7.html.c82d055d.js"><link rel="prefetch" href="/assets/70.html.fdd7a29a.js"><link rel="prefetch" href="/assets/71.html.d6fcc75f.js"><link rel="prefetch" href="/assets/72.html.331ad4f4.js"><link rel="prefetch" href="/assets/73.html.7e1e94c7.js"><link rel="prefetch" href="/assets/74.html.9e78195c.js"><link rel="prefetch" href="/assets/75.html.7441bdda.js"><link rel="prefetch" href="/assets/76.html.75ad5e04.js"><link rel="prefetch" href="/assets/77.html.c029c345.js"><link rel="prefetch" href="/assets/78.html.e2157ba4.js"><link rel="prefetch" href="/assets/79.html.c60cf90d.js"><link rel="prefetch" href="/assets/8.html.d136ecdb.js"><link rel="prefetch" href="/assets/80.html.e7beec2c.js"><link rel="prefetch" href="/assets/81.html.4bdb5139.js"><link rel="prefetch" href="/assets/82.html.c9d456f0.js"><link rel="prefetch" href="/assets/83.html.df3b0cd8.js"><link rel="prefetch" href="/assets/84.html.78f7ec3f.js"><link rel="prefetch" href="/assets/85.html.2a8b5c8f.js"><link rel="prefetch" href="/assets/86.html.c40244a1.js"><link rel="prefetch" href="/assets/87.html.fa1ce0c7.js"><link rel="prefetch" href="/assets/88.html.77b394fd.js"><link rel="prefetch" href="/assets/89.html.56e99844.js"><link rel="prefetch" href="/assets/9.html.a35612db.js"><link rel="prefetch" href="/assets/90.html.9422dee4.js"><link rel="prefetch" href="/assets/91.html.365c1307.js"><link rel="prefetch" href="/assets/92.html.1783e812.js"><link rel="prefetch" href="/assets/93.html.350f71d3.js"><link rel="prefetch" href="/assets/94.html.59696d1a.js"><link rel="prefetch" href="/assets/95.html.ce66c712.js"><link rel="prefetch" href="/assets/96.html.e566c29a.js"><link rel="prefetch" href="/assets/97.html.e4868aef.js"><link rel="prefetch" href="/assets/98.html.1c94fae3.js"><link rel="prefetch" href="/assets/99.html.83a880ef.js"><link rel="prefetch" href="/assets/index.html.73e6f72d.js"><link rel="prefetch" href="/assets/TODO.html.0b26026e.js"><link rel="prefetch" href="/assets/1.html.b5788a0a.js"><link rel="prefetch" href="/assets/10.html.f39fd2e2.js"><link rel="prefetch" href="/assets/11.html.cb92d50a.js"><link rel="prefetch" href="/assets/12.html.c9956a1c.js"><link rel="prefetch" href="/assets/13.html.ff91dd7d.js"><link rel="prefetch" href="/assets/14.html.1c9711cd.js"><link rel="prefetch" href="/assets/15.html.1e5eba83.js"><link rel="prefetch" href="/assets/16.html.ba7cf532.js"><link rel="prefetch" href="/assets/17.html.c9fb4990.js"><link rel="prefetch" href="/assets/18.html.7fc88060.js"><link rel="prefetch" href="/assets/19.html.de9e37b6.js"><link rel="prefetch" href="/assets/2.html.7ef6be18.js"><link rel="prefetch" href="/assets/20.html.9bbb3ccb.js"><link rel="prefetch" href="/assets/21.html.fcdf9a93.js"><link rel="prefetch" href="/assets/22.html.17e23153.js"><link rel="prefetch" href="/assets/23.html.2ce2e14c.js"><link rel="prefetch" href="/assets/24.html.c040a162.js"><link rel="prefetch" href="/assets/25.html.c9d00da4.js"><link rel="prefetch" href="/assets/26.html.f90d9c09.js"><link rel="prefetch" href="/assets/27.html.8ef183e2.js"><link rel="prefetch" href="/assets/28.html.627cde2b.js"><link rel="prefetch" href="/assets/29.html.7440b5fd.js"><link rel="prefetch" href="/assets/3.html.ae1ba08b.js"><link rel="prefetch" href="/assets/30.html.24d91485.js"><link rel="prefetch" href="/assets/31.html.05f12a6e.js"><link rel="prefetch" href="/assets/32.html.bd4a952f.js"><link rel="prefetch" href="/assets/33.html.069d68d9.js"><link rel="prefetch" href="/assets/34.html.32496e33.js"><link rel="prefetch" href="/assets/35.html.90ee4408.js"><link rel="prefetch" href="/assets/36.html.e5756621.js"><link rel="prefetch" href="/assets/37.html.846f502b.js"><link rel="prefetch" href="/assets/38.html.3fd1550b.js"><link rel="prefetch" href="/assets/39.html.56d14d24.js"><link rel="prefetch" href="/assets/4.html.0ef1b9b6.js"><link rel="prefetch" href="/assets/40.html.dc0bc220.js"><link rel="prefetch" href="/assets/41.html.d6b226ab.js"><link rel="prefetch" href="/assets/42.html.1a9c04fe.js"><link rel="prefetch" href="/assets/43.html.630dd15b.js"><link rel="prefetch" href="/assets/44.html.769acdbf.js"><link rel="prefetch" href="/assets/45.html.be2b464d.js"><link rel="prefetch" href="/assets/46.html.351c57b1.js"><link rel="prefetch" href="/assets/47.html.bf9e6b26.js"><link rel="prefetch" href="/assets/48.html.a72fbe62.js"><link rel="prefetch" href="/assets/49.html.3fdfb617.js"><link rel="prefetch" href="/assets/5.html.0754b34b.js"><link rel="prefetch" href="/assets/50.html.2d5c4caf.js"><link rel="prefetch" href="/assets/51.html.0efd6384.js"><link rel="prefetch" href="/assets/52.html.519900d4.js"><link rel="prefetch" href="/assets/53.html.a4daf0c2.js"><link rel="prefetch" href="/assets/54.html.ab818dda.js"><link rel="prefetch" href="/assets/55.html.971a1ec2.js"><link rel="prefetch" href="/assets/56.html.eb5ac349.js"><link rel="prefetch" href="/assets/57.html.3eab303c.js"><link rel="prefetch" href="/assets/58.html.9fcb1d91.js"><link rel="prefetch" href="/assets/59.html.84166060.js"><link rel="prefetch" href="/assets/6.html.908832f1.js"><link rel="prefetch" href="/assets/60.html.b5689e7e.js"><link rel="prefetch" href="/assets/61.html.ebd61376.js"><link rel="prefetch" href="/assets/62.html.c3b877e0.js"><link rel="prefetch" href="/assets/63.html.aa8cf3dc.js"><link rel="prefetch" href="/assets/65.html.db4ff5c6.js"><link rel="prefetch" href="/assets/66.html.a118e6ab.js"><link rel="prefetch" href="/assets/67.html.4627aae3.js"><link rel="prefetch" href="/assets/68.html.b21cfe7b.js"><link rel="prefetch" href="/assets/69.html.6bbfcafc.js"><link rel="prefetch" href="/assets/7.html.1835cbdc.js"><link rel="prefetch" href="/assets/70.html.8518aabf.js"><link rel="prefetch" href="/assets/71.html.cd57d926.js"><link rel="prefetch" href="/assets/72.html.a1d21c6b.js"><link rel="prefetch" href="/assets/73.html.9d9b6f55.js"><link rel="prefetch" href="/assets/74.html.7659cb12.js"><link rel="prefetch" href="/assets/75.html.75f6b4bd.js"><link rel="prefetch" href="/assets/76.html.6f260984.js"><link rel="prefetch" href="/assets/77.html.85d86128.js"><link rel="prefetch" href="/assets/78.html.07412b45.js"><link rel="prefetch" href="/assets/79.html.e1921ab7.js"><link rel="prefetch" href="/assets/8.html.292a21e0.js"><link rel="prefetch" href="/assets/80.html.48c86647.js"><link rel="prefetch" href="/assets/81.html.e05ef21e.js"><link rel="prefetch" href="/assets/82.html.543b09fd.js"><link rel="prefetch" href="/assets/83.html.2d1eebe3.js"><link rel="prefetch" href="/assets/84.html.cffc163f.js"><link rel="prefetch" href="/assets/85.html.1071322e.js"><link rel="prefetch" href="/assets/86.html.b06c20fa.js"><link rel="prefetch" href="/assets/87.html.35718d18.js"><link rel="prefetch" href="/assets/88.html.d6fe0377.js"><link rel="prefetch" href="/assets/89.html.c5d8b67d.js"><link rel="prefetch" href="/assets/9.html.3a4d634f.js"><link rel="prefetch" href="/assets/90.html.1738830a.js"><link rel="prefetch" href="/assets/91.html.10a2e184.js"><link rel="prefetch" href="/assets/92.html.50fc7eae.js"><link rel="prefetch" href="/assets/93.html.6841fd19.js"><link rel="prefetch" href="/assets/94.html.689c9fd0.js"><link rel="prefetch" href="/assets/95.html.4d9348eb.js"><link rel="prefetch" href="/assets/96.html.cbe71f23.js"><link rel="prefetch" href="/assets/97.html.7b759a71.js"><link rel="prefetch" href="/assets/98.html.cfcf1a28.js"><link rel="prefetch" href="/assets/99.html.8495fa7f.js"><link rel="prefetch" href="/assets/index.html.47bc8173.js"><link rel="prefetch" href="/assets/1.html.cad42fa3.js"><link rel="prefetch" href="/assets/10.html.26843909.js"><link rel="prefetch" href="/assets/11.html.13400b74.js"><link rel="prefetch" href="/assets/12.html.08aeba04.js"><link rel="prefetch" href="/assets/13.html.342b59df.js"><link rel="prefetch" href="/assets/14.html.df93f255.js"><link rel="prefetch" href="/assets/15.html.9308bbd8.js"><link rel="prefetch" href="/assets/16.html.72e5e67d.js"><link rel="prefetch" href="/assets/17.html.22c69d5d.js"><link rel="prefetch" href="/assets/18.html.5d40814c.js"><link rel="prefetch" href="/assets/19.html.df0d49f0.js"><link rel="prefetch" href="/assets/2.html.17d9d742.js"><link rel="prefetch" href="/assets/20.html.6dfde167.js"><link rel="prefetch" href="/assets/21.html.51fd5372.js"><link rel="prefetch" href="/assets/22.html.7731df07.js"><link rel="prefetch" href="/assets/23.html.91b18f69.js"><link rel="prefetch" href="/assets/24.html.1dada6ea.js"><link rel="prefetch" href="/assets/25.html.070c6605.js"><link rel="prefetch" href="/assets/26.html.69ead39d.js"><link rel="prefetch" href="/assets/27.html.0a692102.js"><link rel="prefetch" href="/assets/28.html.4306ecca.js"><link rel="prefetch" href="/assets/29.html.0cf2a4bf.js"><link rel="prefetch" href="/assets/3.html.d7023bad.js"><link rel="prefetch" href="/assets/30.html.51b20db9.js"><link rel="prefetch" href="/assets/31.html.b1daa10f.js"><link rel="prefetch" href="/assets/32.html.4ce4ba54.js"><link rel="prefetch" href="/assets/33.html.f4ce7e4e.js"><link rel="prefetch" href="/assets/34.html.77a7bb3a.js"><link rel="prefetch" href="/assets/35.html.e40aeb07.js"><link rel="prefetch" href="/assets/36.html.0a702051.js"><link rel="prefetch" href="/assets/37.html.3295026b.js"><link rel="prefetch" href="/assets/38.html.ed2c796e.js"><link rel="prefetch" href="/assets/39.html.baa7bbf5.js"><link rel="prefetch" href="/assets/4.html.a6ea136a.js"><link rel="prefetch" href="/assets/40.html.3c6fad79.js"><link rel="prefetch" href="/assets/41.html.2e074578.js"><link rel="prefetch" href="/assets/42.html.dd3dfcec.js"><link rel="prefetch" href="/assets/43.html.66eacd63.js"><link rel="prefetch" href="/assets/44.html.1287d0e4.js"><link rel="prefetch" href="/assets/45.html.2c9be083.js"><link rel="prefetch" href="/assets/46.html.d3a16498.js"><link rel="prefetch" href="/assets/47.html.633e599a.js"><link rel="prefetch" href="/assets/48.html.4e971fff.js"><link rel="prefetch" href="/assets/49.html.4395237f.js"><link rel="prefetch" href="/assets/5.html.93644912.js"><link rel="prefetch" href="/assets/6.html.982f5af5.js"><link rel="prefetch" href="/assets/7.html.4e874e56.js"><link rel="prefetch" href="/assets/8.html.0227c5b4.js"><link rel="prefetch" href="/assets/9.html.32d7dbf2.js"><link rel="prefetch" href="/assets/1.html.979728ef.js"><link rel="prefetch" href="/assets/10.html.3c86387d.js"><link rel="prefetch" href="/assets/11.html.8c360d8c.js"><link rel="prefetch" href="/assets/12.html.e645a05d.js"><link rel="prefetch" href="/assets/13.html.1adc5f03.js"><link rel="prefetch" href="/assets/14.html.4b27318d.js"><link rel="prefetch" href="/assets/15.html.929e2cc7.js"><link rel="prefetch" href="/assets/16.html.8015bd94.js"><link rel="prefetch" href="/assets/17.html.59cf00d7.js"><link rel="prefetch" href="/assets/18.html.f1864624.js"><link rel="prefetch" href="/assets/19.html.dd0ae085.js"><link rel="prefetch" href="/assets/2.html.53489004.js"><link rel="prefetch" href="/assets/20.html.935aa7e2.js"><link rel="prefetch" href="/assets/21.html.950ef591.js"><link rel="prefetch" href="/assets/22.html.3a8e3b77.js"><link rel="prefetch" href="/assets/23.html.f97fb07c.js"><link rel="prefetch" href="/assets/24.html.c885a71b.js"><link rel="prefetch" href="/assets/25.html.1943f294.js"><link rel="prefetch" href="/assets/26.html.33a39f14.js"><link rel="prefetch" href="/assets/27.html.51b15a7d.js"><link rel="prefetch" href="/assets/28.html.fbb34335.js"><link rel="prefetch" href="/assets/29.html.cb954763.js"><link rel="prefetch" href="/assets/3.html.85dfbc6e.js"><link rel="prefetch" href="/assets/30.html.98b54bd3.js"><link rel="prefetch" href="/assets/31.html.5ad41aed.js"><link rel="prefetch" href="/assets/32.html.6ede643f.js"><link rel="prefetch" href="/assets/33.html.94ffed76.js"><link rel="prefetch" href="/assets/34.html.512a2bf9.js"><link rel="prefetch" href="/assets/35.html.200d94c9.js"><link rel="prefetch" href="/assets/36.html.8d3baa72.js"><link rel="prefetch" href="/assets/37.html.5bc7a7a4.js"><link rel="prefetch" href="/assets/38.html.bc23979f.js"><link rel="prefetch" href="/assets/39.html.8c27383c.js"><link rel="prefetch" href="/assets/4.html.a25a6456.js"><link rel="prefetch" href="/assets/40.html.63f13ae9.js"><link rel="prefetch" href="/assets/41.html.7c23cf1f.js"><link rel="prefetch" href="/assets/42.html.e77d91c3.js"><link rel="prefetch" href="/assets/43.html.70413965.js"><link rel="prefetch" href="/assets/44.html.52914fe2.js"><link rel="prefetch" href="/assets/45.html.5ba213be.js"><link rel="prefetch" href="/assets/46.html.e754cd20.js"><link rel="prefetch" href="/assets/47.html.308231e0.js"><link rel="prefetch" href="/assets/48.html.d5fd8d78.js"><link rel="prefetch" href="/assets/49.html.6c39cba2.js"><link rel="prefetch" href="/assets/5.html.e685fa4f.js"><link rel="prefetch" href="/assets/50.html.82279ac3.js"><link rel="prefetch" href="/assets/6.html.78a03ab4.js"><link rel="prefetch" href="/assets/7.html.48e9d4b6.js"><link rel="prefetch" href="/assets/8.html.7f0defe1.js"><link rel="prefetch" href="/assets/9.html.62a8ed3f.js"><link rel="prefetch" href="/assets/k8s_011.html.b814484f.js"><link rel="prefetch" href="/assets/k8s_012.html.8fcc051f.js"><link rel="prefetch" href="/assets/k8s_013.html.9b276659.js"><link rel="prefetch" href="/assets/k8s_014.html.2f46e8c8.js"><link rel="prefetch" href="/assets/k8s_015.html.a32ec728.js"><link rel="prefetch" href="/assets/k8s_016.html.f2610d3a.js"><link rel="prefetch" href="/assets/k8s_017.html.f564f2b4.js"><link rel="prefetch" href="/assets/k8s_018.html.ecc67b42.js"><link rel="prefetch" href="/assets/k8s_019.html.e5afb415.js"><link rel="prefetch" href="/assets/k8s_020.html.25359ffb.js"><link rel="prefetch" href="/assets/k8s_021.html.9e8e259a.js"><link rel="prefetch" href="/assets/k8s_022.html.8b599e96.js"><link rel="prefetch" href="/assets/k8s_023.html.b2059e49.js"><link rel="prefetch" href="/assets/k8s_024.html.3f04aa4e.js"><link rel="prefetch" href="/assets/k8s_025.html.ab58e5fc.js"><link rel="prefetch" href="/assets/k8s_026.html.16c6fc77.js"><link rel="prefetch" href="/assets/k8s_027.html.81e3276c.js"><link rel="prefetch" href="/assets/k8s_028.html.54ff0461.js"><link rel="prefetch" href="/assets/k8s_029.html.b5111336.js"><link rel="prefetch" href="/assets/k8s_030.html.86cd576e.js"><link rel="prefetch" href="/assets/README (copy).html.5fe3c866.js"><link rel="prefetch" href="/assets/index.html.82d1ec5e.js"><link rel="prefetch" href="/assets/404.html.bc57aae7.js">
    <link rel="stylesheet" href="/assets/style.57cbcbfb.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="切换侧边栏" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name can-hide">你好</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="🤵关于我"><span class="title">🤵关于我</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="🤵关于我"><span class="title">🤵关于我</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="external-link" href="https://github.com/3293172751/cs-awesome-Block_Chain" target="_self" aria-label="Github仓库"><!--[--><!--]--> Github仓库 <!----><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="http://nsddd.top" target="_self" aria-label="我的博客"><!--[--><!--]--> 我的博客 <!----><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.zhihu.com/people/3293172751" rel="noopener noreferrer" target="_blank" aria-label="知乎"><!--[--><!--]--> 知乎 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://github.com/C-UB/" rel="noopener noreferrer" target="_blank" aria-label="⛓️链学社组织"><!--[--><!--]--> ⛓️链学社组织 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a href="/" class="" aria-label="🏠首页"><!--[--><!--]--> 🏠首页 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://go.nsddd.top" rel="noopener noreferrer" target="_blank" aria-label="📚Go语言学习"><!--[--><!--]--> 📚Go语言学习 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/Cloud-Native-k8s/" class="router-link-active" aria-label="⚡ k8s学习篇"><!--[--><!--]--> ⚡ k8s学习篇 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/markdown/" class="" aria-label="⚡ docker学习篇"><!--[--><!--]--> ⚡ docker学习篇 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/Cloud-Native/" class="" aria-label="🏄‍♂️ 云原生学习篇"><!--[--><!--]--> 🏄‍♂️ 云原生学习篇 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/3293172751/awesome-docker" rel="noopener noreferrer" target="_blank" aria-label="查看源码"><!--[--><!--]--> 查看源码 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="切换颜色模式"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="🤵关于我"><span class="title">🤵关于我</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="🤵关于我"><span class="title">🤵关于我</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="external-link" href="https://github.com/3293172751/cs-awesome-Block_Chain" target="_self" aria-label="Github仓库"><!--[--><!--]--> Github仓库 <!----><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="http://nsddd.top" target="_self" aria-label="我的博客"><!--[--><!--]--> 我的博客 <!----><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.zhihu.com/people/3293172751" rel="noopener noreferrer" target="_blank" aria-label="知乎"><!--[--><!--]--> 知乎 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://github.com/C-UB/" rel="noopener noreferrer" target="_blank" aria-label="⛓️链学社组织"><!--[--><!--]--> ⛓️链学社组织 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a href="/" class="" aria-label="🏠首页"><!--[--><!--]--> 🏠首页 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://go.nsddd.top" rel="noopener noreferrer" target="_blank" aria-label="📚Go语言学习"><!--[--><!--]--> 📚Go语言学习 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/Cloud-Native-k8s/" class="router-link-active" aria-label="⚡ k8s学习篇"><!--[--><!--]--> ⚡ k8s学习篇 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/markdown/" class="" aria-label="⚡ docker学习篇"><!--[--><!--]--> ⚡ docker学习篇 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/Cloud-Native/" class="" aria-label="🏄‍♂️ 云原生学习篇"><!--[--><!--]--> 🏄‍♂️ 云原生学习篇 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/3293172751/awesome-docker" rel="noopener noreferrer" target="_blank" aria-label="查看源码"><!--[--><!--]--> 查看源码 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/" class="sidebar-item sidebar-heading" aria-label="🏠回到主页"><!--[--><!--]--> 🏠回到主页 <!--[--><!--]--></a><!----></li><li><a class="external-link sidebar-item sidebar-heading" href="https://xxw.nsddd.top/s/wRSz" rel="noopener noreferrer" target="_blank" aria-label="💱个人云盘地址"><!--[--><!--]--> 💱个人云盘地址 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a><!----></li><li><p tabindex="0" class="sidebar-item sidebar-heading active">⚡ k8s云原生学习篇 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/Cloud-Native-k8s/1.html" class="sidebar-item" aria-label="第1节 云平台"><!--[--><!--]--> 第1节 云平台 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/2.html" class="sidebar-item" aria-label="第2节 docker实用操作"><!--[--><!--]--> 第2节 docker实用操作 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/3.html" class="sidebar-item" aria-label="第3节 docker三驾马车"><!--[--><!--]--> 第3节 docker三驾马车 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/4.html" class="sidebar-item" aria-label="第4节 kubernetes(k8s)教程"><!--[--><!--]--> 第4节 kubernetes(k8s)教程 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/5.html" class="sidebar-item" aria-label="第5节 集群搭建"><!--[--><!--]--> 第5节 集群搭建 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/6.html" class="sidebar-item" aria-label="第6节 sealos搭建k8s"><!--[--><!--]--> 第6节 sealos搭建k8s <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/7.html" class="sidebar-item" aria-label="第7节 k8s在线实验学习平台"><!--[--><!--]--> 第7节 k8s在线实验学习平台 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/8.html" class="sidebar-item" aria-label="第8节 图形界面和命名空间"><!--[--><!--]--> 第8节 图形界面和命名空间 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/9.html" class="sidebar-item" aria-label="第9节 Pod"><!--[--><!--]--> 第9节 Pod <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/10.html" class="sidebar-item" aria-label="第10节 Deployment"><!--[--><!--]--> 第10节 Deployment <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/11.html" class="sidebar-item" aria-label="第11节 service"><!--[--><!--]--> 第11节 service <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/12.html" class="sidebar-item" aria-label="第12节 Ingress"><!--[--><!--]--> 第12节 Ingress <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/13.html" class="sidebar-item" aria-label="第13节 存储抽象"><!--[--><!--]--> 第13节 存储抽象 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/14.html" class="sidebar-item" aria-label="第14节 k3s"><!--[--><!--]--> 第14节 k3s <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/15.html" class="sidebar-item" aria-label="第15节 k3s 补充"><!--[--><!--]--> 第15节 k3s 补充 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/16.html" class="sidebar-item" aria-label="Treafik LB"><!--[--><!--]--> Treafik LB <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/17.html" class="sidebar-item" aria-label="第17节 Service LB"><!--[--><!--]--> 第17节 Service LB <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/18.html" class="sidebar-item" aria-label="第18节kubernetes API 访问控制"><!--[--><!--]--> 第18节kubernetes API 访问控制 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/19.html" class="sidebar-item" aria-label="第19节  StatefulSet"><!--[--><!--]--> 第19节  StatefulSet <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/20.html" class="sidebar-item" aria-label="第19节  StatefulSet"><!--[--><!--]--> 第19节  StatefulSet <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/21.html" class="sidebar-item" aria-label="第21节 Minikube 和 Kind"><!--[--><!--]--> 第21节 Minikube 和 Kind <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/22.html" class="sidebar-item" aria-label="第22节 运行有状态应用"><!--[--><!--]--> 第22节 运行有状态应用 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/23.html" class="sidebar-item" aria-label="第23节 Kubeconfig &amp;&amp; token"><!--[--><!--]--> 第23节 Kubeconfig &amp;&amp; token <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/24.html" class="sidebar-item" aria-label="第24节 ETCD"><!--[--><!--]--> 第24节 ETCD <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/25.html" class="sidebar-item" aria-label="第25节 raft 算法"><!--[--><!--]--> 第25节 raft 算法 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/26.html" class="sidebar-item" aria-label="第26节 helm 教程"><!--[--><!--]--> 第26节 helm 教程 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/27.html" class="sidebar-item" aria-label="第27节 k3s 补充（高级）"><!--[--><!--]--> 第27节 k3s 补充（高级） <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/28.html" class="sidebar-item" aria-label="第28节 Linux系统移植，分区，rootfs"><!--[--><!--]--> 第28节 Linux系统移植，分区，rootfs <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/29.html" class="sidebar-item" aria-label="第29节 CloudNative / Kubernetes 学习资源整理"><!--[--><!--]--> 第29节 CloudNative / Kubernetes 学习资源整理 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/30.html" class="sidebar-item" aria-label="第30节 K8s 开发环境搭建"><!--[--><!--]--> 第30节 K8s 开发环境搭建 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/31.html" class="sidebar-item" aria-label="第31节 kubernetes 的编译和调试"><!--[--><!--]--> 第31节 kubernetes 的编译和调试 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/32.html" class="sidebar-item" aria-label="第32节 kubernetes 目录结构"><!--[--><!--]--> 第32节 kubernetes 目录结构 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/33.html" class="sidebar-item" aria-label="第33节 Postman请求Server"><!--[--><!--]--> 第33节 Postman请求Server <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/34.html" class="sidebar-item" aria-label="第34节 API Server"><!--[--><!--]--> 第34节 API Server <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/35.html" class="sidebar-item" aria-label="第35节 client-go 写 k8s 控制器"><!--[--><!--]--> 第35节 client-go 写 k8s 控制器 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/36.html" class="sidebar-item" aria-label="第 36 节 一些疑问"><!--[--><!--]--> 第 36 节 一些疑问 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/37.html" class="sidebar-item" aria-label="第 37 节 一些疑问和解答 2"><!--[--><!--]--> 第 37 节 一些疑问和解答 2 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/38.html" class="sidebar-item" aria-label="第38节 一些疑问和解答3"><!--[--><!--]--> 第38节 一些疑问和解答3 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/39.html" class="sidebar-item" aria-label="第 39 节 关于 Kubernetes 的一些疑问 4"><!--[--><!--]--> 第 39 节 关于 Kubernetes 的一些疑问 4 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/40.html" class="sidebar-item" aria-label="第40节 Istio"><!--[--><!--]--> 第40节 Istio <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/41.html" class="sidebar-item" aria-label="第41节 代码生成"><!--[--><!--]--> 第41节 代码生成 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/42.html" class="sidebar-item" aria-label="第 42 节 Kubernetes 的多租户"><!--[--><!--]--> 第 42 节 Kubernetes 的多租户 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/43.html" class="sidebar-item" aria-label="第43节 kubernetes 的贡献学习"><!--[--><!--]--> 第43节 kubernetes 的贡献学习 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/44.html" class="sidebar-item" aria-label="第44节 kubernetes 资源内部版本和外部版本"><!--[--><!--]--> 第44节 kubernetes 资源内部版本和外部版本 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/45.html" class="sidebar-item" aria-label="第45节 namespace 通信问题"><!--[--><!--]--> 第45节 namespace 通信问题 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/46.html" class="sidebar-item" aria-label="第46节 深挖容器底层技术"><!--[--><!--]--> 第46节 深挖容器底层技术 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/47.html" class="sidebar-item" aria-label="第47节 Kubernetes 概念以及架构"><!--[--><!--]--> 第47节 Kubernetes 概念以及架构 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/48.html" class="sidebar-item" aria-label="第48节 深入理解Kubernetes控制平面组件：ETCD"><!--[--><!--]--> 第48节 深入理解Kubernetes控制平面组件：ETCD <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/49.html" class="sidebar-item" aria-label="第49节 深入理解 Kube-APIServer"><!--[--><!--]--> 第49节 深入理解 Kube-APIServer <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/50.html" class="sidebar-item" aria-label="第50节 Kubernetes 控制平面：调度器"><!--[--><!--]--> 第50节 Kubernetes 控制平面：调度器 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/51.html" class="sidebar-item" aria-label="第51节  Controller Manager"><!--[--><!--]--> 第51节  Controller Manager <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/52.html" class="sidebar-item" aria-label="第52节 kubectl"><!--[--><!--]--> 第52节 kubectl <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/53.html" class="sidebar-item" aria-label="第53节 CRI、CNI、CSI 底层刨析"><!--[--><!--]--> 第53节 CRI、CNI、CSI 底层刨析 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/54.html" class="sidebar-item" aria-label="第54节 Kubernetes 生命周期管理和服务发现"><!--[--><!--]--> 第54节 Kubernetes 生命周期管理和服务发现 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/55.html" class="sidebar-item" aria-label="第55节 服务发现"><!--[--><!--]--> 第55节 服务发现 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/56.html" class="sidebar-item" aria-label="第56节 service"><!--[--><!--]--> 第56节 service <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/57.html" class="sidebar-item" aria-label="第57节 kube-proxy"><!--[--><!--]--> 第57节 kube-proxy <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/58.html" class="sidebar-item" aria-label="第58节 Kubernetes 网络"><!--[--><!--]--> 第58节 Kubernetes 网络 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/59.html" class="sidebar-item" aria-label="第59节 CoreDNS 和 Ingress"><!--[--><!--]--> 第59节 CoreDNS 和 Ingress <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/60.html" class="sidebar-item" aria-label="第60节 生产化集群的管理"><!--[--><!--]--> 第60节 生产化集群的管理 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/61.html" class="sidebar-item" aria-label="第61节 节点资源管理、异常检测以及常见问题排查"><!--[--><!--]--> 第61节 节点资源管理、异常检测以及常见问题排查 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/62.html" class="sidebar-item" aria-label="第62节 Istio 高级流量管理"><!--[--><!--]--> 第62节 Istio 高级流量管理 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/63.html" class="sidebar-item" aria-label="第63节 Prometheus 和 Grafana 日志收集方案"><!--[--><!--]--> 第63节 Prometheus 和 Grafana 日志收集方案 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Cloud-Native-k8s/64.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="第64节 kubeadm概述、原理、以及部分源码阅读"><!--[--><!--]--> 第64节 kubeadm概述、原理、以及部分源码阅读 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/Cloud-Native-k8s/64.html#kubeadm" class="router-link-active router-link-exact-active sidebar-item" aria-label="kubeadm"><!--[--><!--]--> kubeadm <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Cloud-Native-k8s/64.html#kubeadm-init" class="router-link-active router-link-exact-active sidebar-item" aria-label="kubeadm init"><!--[--><!--]--> kubeadm init <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Cloud-Native-k8s/64.html#kubeadm-join" class="router-link-active router-link-exact-active sidebar-item" aria-label="kubeadm join"><!--[--><!--]--> kubeadm join <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Cloud-Native-k8s/64.html#kubeadm-upgrade" class="router-link-active router-link-exact-active sidebar-item" aria-label="kubeadm upgrade"><!--[--><!--]--> kubeadm upgrade <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Cloud-Native-k8s/64.html#kubeadm-config" class="router-link-active router-link-exact-active sidebar-item" aria-label="kubeadm config"><!--[--><!--]--> kubeadm config <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Cloud-Native-k8s/64.html#kubeadm-reset" class="router-link-active router-link-exact-active sidebar-item" aria-label="kubeadm reset"><!--[--><!--]--> kubeadm reset <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Cloud-Native-k8s/64.html#kubeadm-token" class="router-link-active router-link-exact-active sidebar-item" aria-label="kubeadm token"><!--[--><!--]--> kubeadm token <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Cloud-Native-k8s/64.html#kubeadm-version" class="router-link-active router-link-exact-active sidebar-item" aria-label="kubeadm version"><!--[--><!--]--> kubeadm version <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Cloud-Native-k8s/64.html#kubeadm-alpha" class="router-link-active router-link-exact-active sidebar-item" aria-label="kubeadm alpha"><!--[--><!--]--> kubeadm alpha <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Cloud-Native-k8s/64.html#kubeadm-init-phase" class="router-link-active router-link-exact-active sidebar-item" aria-label="kubeadm init phase"><!--[--><!--]--> kubeadm init phase <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Cloud-Native-k8s/64.html#kubeadm-join-phase" class="router-link-active router-link-exact-active sidebar-item" aria-label="kubeadm join phase"><!--[--><!--]--> kubeadm join phase <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Cloud-Native-k8s/64.html#细节" class="router-link-active router-link-exact-active sidebar-item" aria-label="细节"><!--[--><!--]--> 细节 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Cloud-Native-k8s/64.html#end-链接" class="router-link-active router-link-exact-active sidebar-item" aria-label="END 链接"><!--[--><!--]--> END 链接 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/Cloud-Native-k8s/65.html" class="sidebar-item" aria-label="第65节 eBPF 刨析以及源码学习"><!--[--><!--]--> 第65节 eBPF 刨析以及源码学习 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/66.html" class="sidebar-item" aria-label="第66节 Kubernetes 二次开发 CRD 学习"><!--[--><!--]--> 第66节 Kubernetes 二次开发 CRD 学习 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/67.html" class="sidebar-item" aria-label="第67节 K8s 深入理解 Operator-client 详解"><!--[--><!--]--> 第67节 K8s 深入理解 Operator-client 详解 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/68.html" class="sidebar-item" aria-label="第68节 Reflector 原理"><!--[--><!--]--> 第68节 Reflector 原理 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/69.html" class="sidebar-item" aria-label="第69节  DeltaFIFO 原理"><!--[--><!--]--> 第69节  DeltaFIFO 原理 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/70.html" class="sidebar-item" aria-label="第70节 Kubernetes 社区规范"><!--[--><!--]--> 第70节 Kubernetes 社区规范 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/71.html" class="sidebar-item" aria-label="第71节 Prow及其生态系统"><!--[--><!--]--> 第71节 Prow及其生态系统 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/72.html" class="sidebar-item" aria-label="第72节"><!--[--><!--]--> 第72节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/73.html" class="sidebar-item" aria-label="第73节"><!--[--><!--]--> 第73节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/74.html" class="sidebar-item" aria-label="第74节"><!--[--><!--]--> 第74节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/75.html" class="sidebar-item" aria-label="第75节"><!--[--><!--]--> 第75节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/76.html" class="sidebar-item" aria-label="第76节"><!--[--><!--]--> 第76节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/77.html" class="sidebar-item" aria-label="第77节"><!--[--><!--]--> 第77节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/78.html" class="sidebar-item" aria-label="第78节"><!--[--><!--]--> 第78节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/79.html" class="sidebar-item" aria-label="第79节"><!--[--><!--]--> 第79节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/80.html" class="sidebar-item" aria-label="第80节"><!--[--><!--]--> 第80节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/81.html" class="sidebar-item" aria-label="第81节"><!--[--><!--]--> 第81节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/82.html" class="sidebar-item" aria-label="第82节"><!--[--><!--]--> 第82节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/83.html" class="sidebar-item" aria-label="第83节"><!--[--><!--]--> 第83节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/84.html" class="sidebar-item" aria-label="第84节"><!--[--><!--]--> 第84节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/85.html" class="sidebar-item" aria-label="第85节"><!--[--><!--]--> 第85节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/86.html" class="sidebar-item" aria-label="第86节"><!--[--><!--]--> 第86节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/87.html" class="sidebar-item" aria-label="第87节"><!--[--><!--]--> 第87节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/88.html" class="sidebar-item" aria-label="第88节"><!--[--><!--]--> 第88节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/89.html" class="sidebar-item" aria-label="第89节"><!--[--><!--]--> 第89节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/90.html" class="sidebar-item" aria-label="第90节"><!--[--><!--]--> 第90节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/91.html" class="sidebar-item" aria-label="第91节"><!--[--><!--]--> 第91节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/92.html" class="sidebar-item" aria-label="第92节"><!--[--><!--]--> 第92节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/93.html" class="sidebar-item" aria-label="第93节"><!--[--><!--]--> 第93节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/94.html" class="sidebar-item" aria-label="第94节"><!--[--><!--]--> 第94节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/95.html" class="sidebar-item" aria-label="第95节"><!--[--><!--]--> 第95节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/96.html" class="sidebar-item" aria-label="第96节"><!--[--><!--]--> 第96节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/97.html" class="sidebar-item" aria-label="第97节"><!--[--><!--]--> 第97节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/98.html" class="sidebar-item" aria-label="第98节"><!--[--><!--]--> 第98节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/99.html" class="sidebar-item" aria-label="第99节"><!--[--><!--]--> 第99节 <!--[--><!--]--></a><!----></li><li><a href="/Cloud-Native-k8s/100.md" class="sidebar-item" aria-label="100.md"><!--[--><!--]--> 100.md <!--[--><!--]--></a><!----></li><li><a class="external-link sidebar-item" href="https://nsddd.top/archives/contributors" rel="noopener noreferrer" target="_blank" aria-label="💝如何参与贡献？"><!--[--><!--]--> 💝如何参与贡献？ <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><ul><li><a href="http://nsddd.top" target="_blank" rel="noopener noreferrer">author<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h1 id="第64节-kubeadm概述、原理、以及部分源码阅读" tabindex="-1"><a class="header-anchor" href="#第64节-kubeadm概述、原理、以及部分源码阅读" aria-hidden="true">#</a> 第64节 kubeadm概述、原理、以及部分源码阅读</h1><div><a href="63.md" style="float:left;">⬆️上一节🔗 </a><a href="65.md" style="float:right;"> ⬇️下一节🔗</a></div><br><blockquote><p>❤️💕💕新时代拥抱云原生，云原生具有环境统一、按需付费、即开即用、稳定性强特点。Myblog:<a href="http://nsddd.top/" target="_blank" rel="noopener noreferrer">http://nsddd.top<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><hr><p>[TOC]</p><h2 id="kubeadm" tabindex="-1"><a class="header-anchor" href="#kubeadm" aria-hidden="true">#</a> kubeadm</h2><ul><li><a href="https://github.com/kubernetes/kubeadm/blob/main/docs/design/" target="_blank" rel="noopener noreferrer">github kubeadm design docs<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><p>我们在前面几十个小节学习中也知道了 REST API是Kubernetes的基本结构。组件和外部用户命令之间的所有操作和通信都是API服务器处理的REST API调用。因此，Kubernetes平台中的所有内容都被视为API对象，并且在API中有相应的条目。</p><p>大多数操作都可以通过<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/kubectl_cli/overview_of_kubectl.html" target="_blank" rel="noopener noreferrer"><code>kubectl</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>命令行界面或其他命令行工具(如<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/overview_of_kubeadm.html" target="_blank" rel="noopener noreferrer"><code>kubeadm</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>)执行，而这些工具又使用API。不过，你也可以使用REST调用直接访问API。</p><p>Kubeadm是一个工具，它提供<code>kubeadm init</code>和<code>kubeadm join</code>作为创建Kubernetes集群的最佳实践“快捷路径”。</p><blockquote><p>kubeadm是一个用于部署Kubernetes集群的工具。它被设计用于自动化大多数Kubernetes集群的部署任务，从而使Kubernetes集群的部署变得更加简单和高效。kubeadm负责初始化Master节点，并在节点上安装Kubernetes组件。它还可以添加Worker节点，以便将它们添加到集群中。</p></blockquote><p>kubeadm执行必要的操作来启动和运行最小可行集群。按照设计，它只关心引导，而不关心配置机器。同样，安装各种漂亮的插件(比如Kubernetes Dashboard、监控解决方案和特定于云的插件)也不在讨论范围之内。</p><p>相反，我们期望在kubeadm的基础上构建更高级、更定制化的工具，理想情况下，使用kubeadm作为所有部署的基础将使创建符合规范的集群变得更容易。</p><h2 id="kubeadm-init" tabindex="-1"><a class="header-anchor" href="#kubeadm-init" aria-hidden="true">#</a> kubeadm init</h2><p>此命令用于初始化Kubernetes控制平面节点。</p><p><code>init</code>命令执行以下阶段:</p><ol><li><strong>preflight</strong> 运行预检查</li><li><strong>certs</strong>：证书生成 <ul><li><strong>/ca</strong> 生成用于为其他Kubernetes组件提供身份的自签名Kubernetes CA</li><li><strong>/apiserver</strong> 生成用于提供Kubernetes API的证书</li><li><strong>/apiserver-kubelet-client</strong> 生成API服务器用于连接kubelet的证书</li><li><strong>/front-proxy-ca</strong> 生成用于提供前置代理身份的自签名CA</li><li><strong>/front-proxy-client</strong> 生成前置代理客户端证书</li><li><strong>/etcd-ca</strong> 生成用于为etcd提供身份的自签名CA</li><li><strong>/etcd-server</strong> 生成用于提供etcd服务的证书</li><li><strong>/etcd-peer</strong> 生成供etcd节点相互通信的证书</li><li><strong>/etcd-healthcheck-client</strong> 生成用于健康检查etcd的活性探针证书</li><li><strong>/apiserver-etcd-client</strong> 生成apiserver用于访问etcd的证书</li><li><strong>/sa</strong> 生成用于签署服务帐户令牌的私钥及其公钥</li></ul></li><li><strong>kubeconfig</strong>：生成所有kubeconfig文件，以建立控制平面和管理员kubeconfig文件 <ul><li><strong>/admin</strong> 为管理员和kubeadm本身生成kubeconfig文件</li><li><strong>/kubelet</strong> 为kubelet生成kubeconfig文件，仅用于集群引导目的</li><li><strong>/controller-manager</strong> 为控制器管理器生成kubeconfig文件</li><li><strong>/scheduler</strong> 为调度器生成kubeconfig文件</li></ul></li><li><strong>kubelet-start</strong> 写入kubelet设置并（重新）启动kubelet</li><li><strong>control-plane</strong>：生成所有静态Pod清单文件，以建立控制平面 <ul><li><strong>/apiserver</strong> 生成kube-apiserver静态Pod清单</li><li><strong>/controller-manager</strong> 生成kube-controller-manager静态Pod清单</li><li><strong>/scheduler</strong> 生成kube-scheduler静态Pod清单</li></ul></li><li><strong>etcd</strong>：为本地etcd生成静态Pod清单文件 <ul><li><strong>/local</strong> 为本地单节点etcd实例生成静态Pod清单文件</li></ul></li><li><strong>upload-config</strong>：将kubeadm和kubelet配置上传到ConfigMap <ul><li><strong>/kubeadm</strong> 将kubeadm ClusterConfiguration上传到ConfigMap</li><li><strong>/kubelet</strong> 将kubelet组件配置上传到ConfigMap</li></ul></li><li><strong>upload-certs</strong> 将证书上传到kubeadm-certs</li><li><strong>mark-control-plane</strong> 将节点标记为控制平面</li><li><strong>bootstrap-token</strong> 生成用于将节点加入集群的引导令牌</li><li><strong>kubelet-finalize</strong>：在TLS引导后更新与kubelet相关的设置 <ul><li><strong>/experimental-cert-rotation</strong> 启用kubelet客户端证书轮换</li></ul></li><li><strong>addon</strong>：安装通过一致性测试所需的必要插件 <ul><li><strong>/coredns</strong> 将CoreDNS插件安装到Kubernetes集群</li><li><strong>/kube-proxy</strong> 将kube-proxy插件安装到Kubernetes集群</li></ul></li><li><strong>show-join-command</strong> 显示控制平面和工作节点的加入命令</li></ol><h3 id="选项" tabindex="-1"><a class="header-anchor" href="#选项" aria-hidden="true">#</a> 选项</h3><table><thead><tr><th>选项</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>--apiserver-advertise-address</td><td>string</td><td>API Server 广告其监听的 IP 地址。如果未设置，则使用默认网络接口。</td></tr><tr><td>--apiserver-bind-port</td><td>int32</td><td>默认值：6443。API Server绑定的端口。</td></tr><tr><td>--apiserver-cert-extra-sans</td><td>stringSlice</td><td>API Server 服务证书的可选额外主体替代名称（SAN），可以是 IP 地址和 DNS 名称。</td></tr><tr><td>--cert-dir</td><td>string</td><td>默认值：&quot;/etc/kubernetes/pki&quot;。</td></tr><tr><td>--certificate-key</td><td>string</td><td>用于加密 kubeadm-certs Secret 中的控制平面证书的密钥。</td></tr><tr><td>--config</td><td>string</td><td>kubeadm 配置文件的路径。</td></tr><tr><td>--cri-socket</td><td>string</td><td>要连接的CRI套接字的路径。如果为空，kubeadm将尝试自动检测此值；仅在安装了多个CRI或存在非标准CRI套接字时使用此选项。</td></tr><tr><td>--dry-run</td><td></td><td>不应用任何更改；只输出将要执行的操作。</td></tr><tr><td>--experimental-upload-certs</td><td></td><td>上传控制平面证书到 kubeadm-certs Secret。</td></tr><tr><td>--feature-gates</td><td>string</td><td>一组键值对，描述各种功能的特性门。可选项为：</td></tr><tr><td>-h, --help</td><td></td><td>init 的帮助信息。</td></tr><tr><td>--ignore-preflight-errors</td><td>stringSlice</td><td>要将其错误显示为警告的检查列表。示例：“IsPrivilegedUser，Swap”。值“all”会忽略所有检查的错误。</td></tr><tr><td>--image-repository</td><td>string</td><td>默认值：“http://k8s.gcr.io/”。选择一个容器注册表以拉取控制平面映像。</td></tr><tr><td>--kubernetes-version</td><td>string</td><td>默认值：“stable-1”。为控制平面选择特定的 Kubernetes 版本。</td></tr><tr><td>--node-name</td><td>string</td><td>指定节点名称。</td></tr><tr><td>--pod-network-cidr</td><td>string</td><td>指定 Pod 网络的 IP 地址范围。如果设置，则控制平面将自动为每个节点分配 CIDR。</td></tr><tr><td>--service-cidr</td><td>string</td><td>默认值：“10.96.0.0/12”。使用替代 IP 地址范围来设置服务 VIP。</td></tr><tr><td>--service-dns-domain</td><td>string</td><td>默认值：“cluster.local”。使用替代域名为服务命名，例如“myorg.internal”。</td></tr><tr><td>--skip-certificate-key-print</td><td></td><td>不打印用于加密控制平面证书的密钥。</td></tr><tr><td>--skip-phases</td><td>stringSlice</td><td>要跳过的阶段列表。</td></tr><tr><td>--skip-token-print</td><td></td><td>跳过打印由“kubeadm init”生成的默认引导令牌。</td></tr><tr><td>--token</td><td>string</td><td>用于在节点和控制平面节点之间建立双向信任的令牌。格式为[a-z0-9] {6}。[a-z0-9] {16} - 例如abcdef.0123456789abcdef</td></tr><tr><td>--token-ttl duration</td><td></td><td>默认值：24h0m0s。令牌自动删除之前的持续时间（例如1s，2m，3h）。如果设置为“0”，则令牌永不过期。</td></tr></tbody></table><h3 id="从父命令继承的选项" tabindex="-1"><a class="header-anchor" href="#从父命令继承的选项" aria-hidden="true">#</a> 从父命令继承的选项</h3><table><thead><tr><th style="text-align:left;">选项</th><th style="text-align:left;">类型</th><th style="text-align:left;">描述</th></tr></thead><tbody><tr><td style="text-align:left;">--rootfs</td><td style="text-align:left;">string</td><td style="text-align:left;">[EXPERIMENTAL] The path to the &#39;real&#39; host root filesystem.</td></tr></tbody></table><h3 id="初始化流程" tabindex="-1"><a class="header-anchor" href="#初始化流程" aria-hidden="true">#</a> 初始化流程</h3><h4 id="pre-flifht-检查" tabindex="-1"><a class="header-anchor" href="#pre-flifht-检查" aria-hidden="true">#</a> pre-flifht 检查</h4><p>在执行 kubeadm init 命令之前，kubeadm 会运行一个 preflight 阶段，用于检查集群节点是否满足 Kubernetes 的最低要求。在 preflight 阶段中，kubeadm 会根据用户提供的选项来执行一系列检查，以确保 Kubernetes 控制平面的正常运行。</p><p>常用的 preflight 阶段选项包括：</p><ul><li>-config：指定 kubeadm 配置文件的路径；</li><li>-cri-socket：指定容器运行时（CRI）的 socket 文件路径；</li><li>-skip-phases：跳过 preflight 阶段中的某些检查阶段；</li><li>-ignore-preflight-errors：忽略 preflight 阶段中的某些错误。</li></ul><h4 id="certificate-生成阶段" tabindex="-1"><a class="header-anchor" href="#certificate-生成阶段" aria-hidden="true">#</a> certificate 生成阶段</h4><p>在初始化 Kubernetes 控制平面时，kubeadm 还会自动为 Kubernetes 组件生成 TLS 证书和秘钥。这些证书和秘钥用于确保 Kubernetes 组件之间的安全通信。</p><p>生成自签名CA（如果提供了，则使用现有CA），为集群中的每个组件设置标识。如果用户提供了自己的CA证书和/或密钥，并将其放入通过 <code>--cert-dir</code> 选项（默认值为<code>/etc/kubernetes/pki</code> ）配置的证书目录中。可以按照<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/kubeadm_init.html#zidingyizhengshu" target="_blank" rel="noopener noreferrer">使用自定义证书<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>文档中的描述跳过此步骤。API服务器证书拥有用于 <code>--apiserver-cert-extra-sans</code>参数（必要时小写）的额外SAN条目。</p><h4 id="生成-kubeconfig-文件" tabindex="-1"><a class="header-anchor" href="#生成-kubeconfig-文件" aria-hidden="true">#</a> 生成 kubeconfig 文件</h4><p>将kubeconfig文件写到<code>/etc/kubernetes/</code>中，供kubelet、控制器-管理器和调度器连接API服务器，每个kubeconfig文件都有自己的标识，另外还有一个名为<code>admin.conf</code>的kubeconfig文件用于管理。</p><h4 id="pod" tabindex="-1"><a class="header-anchor" href="#pod" aria-hidden="true">#</a> pod</h4><p>为API服务器、控制器管理器和调度器生成静态Pod清单。如果没有提供外部etcd，则为etcd生成额外的静态Pod清单。</p><p>静态Pod清单被写入<code>/etc/kubernetes/manifests</code>；kubelet监视这个目录，以便在启动时创建pod。</p><p>一旦控制平面pod启动并运行，<code>kubeadm init</code>流程就可以继续。</p><ol><li><p>将标签和污染应用到控制平面节点，这样就不会在那里运行额外的工作负载。</p></li><li><p>生成令牌，额外的节点可以使用该令牌在将来向控制平面注册自己。用户可以选择通过<code>--token</code>选项提供令牌，如<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/kubeadm_token.html" target="_blank" rel="noopener noreferrer">kubeadm token<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>文档中所述。</p></li><li><p>配置所有必要的配置，允许节点使用<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/accessing_api/authenticating_with_bootstrap_tokens.html" target="_blank" rel="noopener noreferrer">引导令牌<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>和<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/command_line_tools_reference/tls_bootstrapping.html" target="_blank" rel="noopener noreferrer">TLS引导<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>机制加入集群：</p><ul><li>编写一个ConfigMap来提供加入集群所需的所有信息，并设置相关的RBAC访问规则。</li><li>使引导令牌访问CSR签名API。</li><li>为新的CSR请求配置自动批准。</li></ul><p>有关更多信息，请参见<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/kubeadm_join.html" target="_blank" rel="noopener noreferrer">kubeadm join<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。</p></li><li><p>通过API服务器安装DNS服务器(CoreDNS)和kube-proxy插件组件。在Kubernetes v1.11和更高版本中，CoreDNS是默认的DNS服务器。如果你要安装kube-dns而不是CoreDNS，必须在kubeadm <code>ClusterConfiguration</code>配置DNS插件。</p></li></ol><h3 id="使用kubeadm的初始化阶段" tabindex="-1"><a class="header-anchor" href="#使用kubeadm的初始化阶段" aria-hidden="true">#</a> 使用kubeadm的初始化阶段</h3><p>Kubeadm允许你分阶段创建一个控制平面节点。在v1.13中，<code>kubeadm init phase</code>命令已经从alpha级别的<code>kubeadm alpha phase</code>升级到了GA级别。</p><p>要查看有序的阶段和子阶段列表，可以调用<code>kubeadm init --help</code>。列表将位于帮助信息的顶部，每个阶段旁边都有一个描述。注意，通过调用<code>kubeadm init</code>，所有阶段和子阶段都将按照这个顺序执行。</p><p>有些阶段有独特的选项，如果你想查看可用的选项列表，请添加<code>--help</code>，例如:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> kubeadm init phase control-plane controller-manager <span class="token parameter variable">--help</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>你还可以使用<code>--help</code>查看特定父阶段的子阶段列表:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> kubeadm init phase control-plane <span class="token parameter variable">--help</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>kubeadm init</code>还暴露了一个名为<code>--skip-phase</code>的选项，该选项可用于跳过某些阶段。该选项接受一个阶段名称列表，这些名称可以从上面的有序列表中获取。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> kubeadm init phase control-plane all <span class="token parameter variable">--config</span><span class="token operator">=</span>configfile.yaml
<span class="token function">sudo</span> kubeadm init phase etcd <span class="token builtin class-name">local</span> <span class="token parameter variable">--config</span><span class="token operator">=</span>configfile.yaml
<span class="token comment"># you can now modify the control plane and etcd manifest files</span>
<span class="token function">sudo</span> kubeadm init --skip-phases<span class="token operator">=</span>control-plane,etcd <span class="token parameter variable">--config</span><span class="token operator">=</span>configfile.yaml
<span class="token function">sudo</span> kubeadm init phase control-plane all <span class="token parameter variable">--config</span><span class="token operator">=</span>configfile.yaml
<span class="token function">sudo</span> kubeadm init phase etcd <span class="token builtin class-name">local</span> <span class="token parameter variable">--config</span><span class="token operator">=</span>configfile.yaml
<span class="token comment"># you can now modify the control plane and etcd manifest files</span>
<span class="token function">sudo</span> kubeadm init --skip-phases<span class="token operator">=</span>control-plane,etcd <span class="token parameter variable">--config</span><span class="token operator">=</span>configfile.yaml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该示例将编写基于<code>configfile.yaml</code>中的配置，位于<code>/etc/kubernetes/manifests</code>中的清单文件。这允许你修改文件，然后使用<code>--skip-phases</code>选项跳过这些阶段。通过调用最后一个命令，你将创建一个带有自定义清单文件的控制平面节点。</p><h3 id="为kubeadm-init指定配置文件" tabindex="-1"><a class="header-anchor" href="#为kubeadm-init指定配置文件" aria-hidden="true">#</a> 为kubeadm init指定配置文件</h3><p>可以用配置文件而不是命令行选项来配置<code>kubeadm init</code>，一些更高级的特性可能只作为配置文件选项使用。该文件通过 <code>--config</code> 选项传递。</p><h4 id="可以使用自定义镜像" tabindex="-1"><a class="header-anchor" href="#可以使用自定义镜像" aria-hidden="true">#</a> 可以使用自定义镜像</h4><p>默认情况下，kubeadm从 <code>k8s.gcr.io</code>中拉取镜像，除非请求的Kubernetes版本是CI版本，这种情况下，将使用 <code>gcr.io/kubernetes-ci-images</code> 。</p><p>这种情况下在国内可能会出现拉取 over time</p><p>你可以向kubeadm指定一个配置文件覆盖此行为。允许自定义有：</p><ul><li>提供一个替代 <code>k8s.gcr.io</code>的<code>imageRepository</code>。</li><li>将<code>useHyperKubeImage</code>设置为<code>true</code>以使用HyperKube图像。</li><li>为etcd或DNS插件提供特定的<code>imageRepository</code>和<code>imageTag</code>。</li></ul><p>请注意，配置字段<code>kubernetesVersion</code>和命令行选项 <code>--kubernetes-version</code> 都会影响镜像的版本。</p><h3 id="使用自定义证书" tabindex="-1"><a class="header-anchor" href="#使用自定义证书" aria-hidden="true">#</a> 使用自定义证书</h3><p>默认情况下，kubeadm生成集群运行所需的所有证书。你也可以通过提供自己的证书来覆盖此行为。</p><p>为此，你必须将它们放在由 <code>--cert-dir</code>选项或 <code>CertificatesDir</code>配置文件键指定的目录中。默认情况下，该目录为<code>/etc/kubernetes/pki</code>。</p><p>如果存在给定的证书和私钥对，kubeadm将跳过生成步骤，使用现有文件。例如，这意味着你可以将现有的CA复制到 <code>/etc/kubernetes/pki/ca.crt</code>和 <code>/etc/kubernetes/pki/ca.key</code>，kubeadm将使用此CA签署其余的证书。</p><h4 id="外部ca模式" tabindex="-1"><a class="header-anchor" href="#外部ca模式" aria-hidden="true">#</a> 外部CA模式</h4><p>也可以只提供<code>ca.crt</code> 文件，而不提供<code>ca.key</code>文件（这只适用于根CA文件，不适用于其他证书对）。如果所有其他证书和kubeconfig文件都到位，kubeadm将识别此条件并激活“外部CA”模式。kubeadm将在磁盘上没有CA密钥的情况下继续执行。</p><p>相反，使用 <code>--controllers=csrsigner</code>独立运行控制器管理器，并指向CA证书和密钥。</p><h3 id="指定-cri" tabindex="-1"><a class="header-anchor" href="#指定-cri" aria-hidden="true">#</a> 指定 CRI</h3><p>从v1.6.0开始，Kubernetes就默认启用了CRI容器运行时接口。默认情况下使用的容器运行时是Docker，它是通过<code>kubelet</code>内置的<code>dockershim </code>CRI启用的。</p><p>从 Kubernetes 1.20 开始，默认容器运行时为 <code>containerd</code>，而之前的版本默认容器运行时为 <code>Docker</code>。</p><p>成功安装<code>kubeadm</code>和<code>kubelet</code>之后，执行以下两个额外步骤:</p><ol><li><p>按照上面运行时shim项目清单中的安装文档，在每个节点上安装运行时shim。</p></li><li><p>配置kubelet使用远程CRI运行时。请记住将<code>RUNTIME_ENDPOINT</code>更改为你自己的值，比如 <code>/var/run/{your_runtime}.sock</code>：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&gt;</span> /etc/systemd/system/kubelet.service.d/20-cri.conf <span class="token operator">&lt;&lt;</span>EOF<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>Environment<span class="token operator">=</span><span class="token string">&quot;KUBELET_EXTRA_ARGS=--container-runtime=remote --container-runtime-endpoint=<span class="token variable">$RUNTIME_ENDPOINT</span>&quot;</span>EOFsystemctl daemon-reload
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ol><p>现在<code>kubelet</code>已经准备好使用指定的CRI运行时，可以继续使用<code>kubeadm init</code>和<code>kubeadm join</code>来部署Kubernetes集群。</p><p>在使用外部CRI实现时，请将在执行 <code>kubeadm init</code> 和<code>kubeadm reset</code>时添加 <code>--cri-socket</code> 选项。</p><h3 id="离线运行-kubeadm" tabindex="-1"><a class="header-anchor" href="#离线运行-kubeadm" aria-hidden="true">#</a> 离线运行 kubeadm</h3><p>要在没有互联网连接的情况下运行kubeadm，你必须预先拉取所需的控制平面镜像。</p><p>在Kubernetes v1.11和更高版本中，你可以使用 <code>kubeadm config images</code>的子命令获取和拉取镜像:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>❯ ./kubeadm config images list

W0319 <span class="token number">15</span>:08:46.559718   <span class="token number">50461</span> version.go:112<span class="token punctuation">]</span> could not obtain neither client nor remote version<span class="token punctuation">;</span> fall back to: <span class="token number">1.0</span>.0-placeholder-version
W0319 <span class="token number">15</span>:08:46.561620   <span class="token number">50461</span> images.go:80<span class="token punctuation">]</span> could not <span class="token function">find</span> officially supported version of etcd <span class="token keyword">for</span> Kubernetes v1.0.0-placeholder-version, falling back
to the nearest etcd version <span class="token punctuation">(</span><span class="token number">3.2</span>.24<span class="token punctuation">)</span>
registry.k8s.io/kube-apiserver:v1.0.0-placeholder-version
registry.k8s.io/kube-controller-manager:v1.0.0-placeholder-version
registry.k8s.io/kube-scheduler:v1.0.0-placeholder-version
registry.k8s.io/kube-proxy:v1.0.0-placeholder-version
registry.k8s.io/pause:3.9
registry.k8s.io/etcd:3.2.24
registry.k8s.io/coredns/coredns:v1.10.1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>拉取：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>kubeadm config images pull
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="kubeadm-join" tabindex="-1"><a class="header-anchor" href="#kubeadm-join" aria-hidden="true">#</a> kubeadm join</h2><p>该命令初始化Kubernetes工作节点并将其加入到集群。在希望加入现有集群的所有机器上运行此操作。</p><p><code>kubeadm init</code> 和 <code>kubeadm join</code> 一起提供了良好的用户体验，可以从头开始创建最佳实践的裸Kubernetes集群。然而，kubeadm是如何做到这一点的，可能并不明显。</p><p>在加入由kubeadm初始化的集群时，我们需要建立双向信任。这分为<em><strong>发现</strong></em>（让节点信任Kubernetes控制平面）和<em>TLS<strong>引导</strong></em>(让Kubernetes控制平面信任节点)。</p><p>有两种主要的发现方案。第一种方法是使用共享令牌和API服务器的IP地址。第二种方法是提供一个文件——标准kubeconfig文件的子集。该文件可以是本地文件，也可以通过HTTPS URL下载。形式为<code>kubeadm join --discovery-token abcdef.1234567890abcdef 1.2.3.4:6443</code>、 <code>kubeadm join --discovery-file path/to/file.conf</code>或<code>kubeadm join --discovery-file https://url/file.conf</code>。只能使用其中一种形式。如果发现信息是从URL加载的，则必须使用HTTPS。此外，在这种情况下，使用已安装的主机CA包验证连接。</p><h3 id="命令阶段" tabindex="-1"><a class="header-anchor" href="#命令阶段" aria-hidden="true">#</a> 命令阶段</h3><p><code>join [api-server-endpoint]</code>命令执行以下阶段:</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>The <span class="token string">&quot;join [api-server-endpoint]&quot;</span> command executes the <span class="token keyword">following</span> phases:
<span class="token identifier"><span class="token punctuation">`</span><span class="token punctuation">`</span></span><span class="token punctuation">`</span>
preflight              Run <span class="token keyword">join</span> pre<span class="token operator">-</span>flight checks
control<span class="token operator">-</span>plane<span class="token operator">-</span><span class="token keyword">prepare</span>  <span class="token keyword">Prepare</span> the machine <span class="token keyword">for</span> serving a control plane
  <span class="token operator">/</span>download<span class="token operator">-</span>certs        <span class="token punctuation">[</span>EXPERIMENTAL<span class="token punctuation">]</span> Download certificates shared among control<span class="token operator">-</span>plane nodes <span class="token keyword">from</span> the kubeadm<span class="token operator">-</span>certs Secret
  <span class="token operator">/</span>certs                 Generate the certificates <span class="token keyword">for</span> the new control plane components
  <span class="token operator">/</span>kubeconfig            Generate the kubeconfig <span class="token keyword">for</span> the new control plane components
  <span class="token operator">/</span>control<span class="token operator">-</span>plane         Generate the manifests <span class="token keyword">for</span> the new control plane components
kubelet<span class="token operator">-</span><span class="token keyword">start</span>          <span class="token keyword">Write</span> kubelet settings<span class="token punctuation">,</span> certificates <span class="token operator">and</span> <span class="token punctuation">(</span>re<span class="token punctuation">)</span><span class="token keyword">start</span> the kubelet
control<span class="token operator">-</span>plane<span class="token operator">-</span><span class="token keyword">join</span>     <span class="token keyword">Join</span> a machine <span class="token keyword">as</span> a control plane instance
  <span class="token operator">/</span>etcd                  <span class="token keyword">Add</span> a new <span class="token keyword">local</span> etcd member
  <span class="token operator">/</span><span class="token keyword">update</span><span class="token operator">-</span><span class="token keyword">status</span>         Register the new control<span class="token operator">-</span>plane node <span class="token keyword">into</span> the ClusterStatus maintained <span class="token operator">in</span> the kubeadm<span class="token operator">-</span>config ConfigMap <span class="token punctuation">(</span>DEPRECATED<span class="token punctuation">)</span>
  <span class="token operator">/</span>mark<span class="token operator">-</span>control<span class="token operator">-</span>plane    Mark a node <span class="token keyword">as</span> a control<span class="token operator">-</span>plane
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>preflight</code>：运行加入前检查</li><li><code>control-plane-prepare</code>：准备机器以服务于控制平面</li><li><ul><li><code>/download-certs</code>：[实验性] 从 kubeadm-certs Secret 下载控制平面节点间共享的证书</li><li><code>/certs</code>：为新的控制平面组件生成证书</li><li><code>/kubeconfig</code>：为新的控制平面组件生成 kubeconfig</li><li><code>/control-plane</code>：为新的控制平面组件生成清单</li></ul></li><li><code>kubelet-start</code>：编写 kubelet 设置，证书并启动 kubelet</li><li><code>control-plane-join</code>：将机器作为控制平面实例加入</li><li><ul><li><code>/etcd</code>：添加一个新的本地 etcd 成员</li><li><code>/update-status</code>：将新的控制平面节点注册到维护在 kubeadm-config ConfigMap 中的 ClusterStatus 中 (已弃用)</li><li><code>/mark-control-plane</code>：将节点标记为控制平面节点</li></ul></li></ul><h3 id="选项-1" tabindex="-1"><a class="header-anchor" href="#选项-1" aria-hidden="true">#</a> 选项</h3><table><thead><tr><th>选项</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td><code>--apiserver-advertise-address</code></td><td>string</td><td>如果节点应该托管新的控制平面实例，则是 API 服务器将广告它正在侦听的 IP 地址。如果未设置，将使用默认网络接口。</td></tr><tr><td><code>--apiserver-bind-port</code></td><td>int32</td><td>默认值：6443。如果节点应该托管新的控制平面实例，则是 API 服务器绑定的端口。</td></tr><tr><td><code>--certificate-key</code></td><td>string</td><td>使用此密钥解密由 init 上传的证书密钥。</td></tr><tr><td><code>--config</code></td><td>string</td><td>kubeadm 配置文件的路径。</td></tr><tr><td><code>--cri-socket</code></td><td>string</td><td>连接的 CRI 套接字的路径。如果为空，kubeadm 将尝试自动检测此值。仅在安装了多个 CRI 或具有非标准 CRI 套接字时使用此选项。</td></tr><tr><td><code>--discovery-file</code></td><td>string</td><td>对于基于文件的发现，要从中加载群集信息的文件或 URL。</td></tr><tr><td><code>--discovery-token</code></td><td>string</td><td>对于基于令牌的发现，用于验证从 API 服务器获取的群集信息的令牌。</td></tr><tr><td><code>--discovery-token-ca-cert-hash</code></td><td>stringSlice</td><td>对于基于令牌的发现，验证根 CA 公钥是否与此哈希值匹配（格式：“ : ”）。</td></tr><tr><td><code>--discovery-token-unsafe-skip-ca-verification</code></td><td></td><td>对于基于令牌的发现，允许加入而不使用 --discovery-token-ca-cert-hash 固定。</td></tr><tr><td><code>--experimental-control-plane</code></td><td></td><td>在此节点上创建新的控制平面实例。</td></tr><tr><td><code>-h</code>, <code>--help</code></td><td></td><td>join 的帮助信息</td></tr><tr><td><code>--ignore-preflight-errors</code></td><td>stringSlice</td><td>显示为警告的检查列表的错误。示例：“IsPrivilegedUser,Swap”。值“all”会忽略所有检查的错误。</td></tr><tr><td><code>--node-name</code></td><td>string</td><td>指定节点名称。</td></tr><tr><td><code>--skip-phases</code></td><td>stringSlice</td><td>要跳过的阶段列表。</td></tr><tr><td><code>--tls-bootstrap-token</code></td><td>string</td><td>在加入节点时，指定用于临时身份验证 Kubernetes 控制平面的令牌。</td></tr><tr><td><code>--token</code></td><td>string</td><td>在未提供 discovery-token 和 tls-bootstrap-token 时使用此令牌。</td></tr></tbody></table><h3 id="加入流程" tabindex="-1"><a class="header-anchor" href="#加入流程" aria-hidden="true">#</a> 加入流程</h3><p><code>kubeadm join</code>引导Kubernetes工作节点或控制平面节点，并将其添加到集群中。对于工作节点，该操作包括以下步骤:</p><ol><li><p>kubeadm从API服务器下载必要的集群信息。默认情况下，它使用引导令牌和CA密钥的哈希值来验证数据的真实性。根CA也可以通过文件或URL直接获取。</p></li><li><p>一旦获取了集群信息，kubelet就可以启动TLS引导流程。</p><p>TLS引导使用共享令牌与Kubernetes API服务器进行临时认证，提交证书签名请求(CSR)；默认情况下，控制平面自动签署此CSR请求。</p></li><li><p>最后，kubeadm将本地kubelet配置为使用分配给节点的最终标识连接到API服务器。</p></li></ol><p>对于控制平面节点，还要执行额外的步骤:</p><ol><li>从集群中下载控制平面节点之间共享的证书(如果用户显式地请求)。</li><li>生成控制平面组件清单、证书和kubeconfig。</li><li>添加新的本地etcd成员。</li><li>将此节点添加到kubeadm集群的ClusterStatus中。</li></ol><h3 id="使用kubeadm的加入阶段" tabindex="-1"><a class="header-anchor" href="#使用kubeadm的加入阶段" aria-hidden="true">#</a> 使用kubeadm的加入阶段</h3><p>Kubeadm允许你分阶段将节点加入到集群。<code>kubeadm join phase</code>命令是在v1.14.0中添加的。</p><p>要查看阶段的有序列表和子阶段列表，可以调用<code>kubeadm join --help</code>。列表将位于帮助的顶部，每个阶段旁边都有一个描述。注意，通过调用<code>kubeadm join</code>，所有阶段和子阶段都将按照这个顺序执行。</p><p>有些阶段有独特的选项，所以如果你想查看可用的选项列表，请添加<code>--help</code>，例如:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubeadm <span class="token function">join</span> phase kubelet-start <span class="token parameter variable">--help</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>与<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/kubeadm_init_phase.html" target="_blank" rel="noopener noreferrer"><code>kubeadm init phase</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>命令类似，<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/kubeadm_join_phase.html" target="_blank" rel="noopener noreferrer"><code>kubadm join phase</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>允许你使用<code>--skip-phase</code>选项跳过某些阶段。</p><p>例如：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> kubeadm <span class="token function">join</span> --skip-phases<span class="token operator">=</span>preflight <span class="token parameter variable">--config</span><span class="token operator">=</span>config.yaml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="kubeadm-upgrade" tabindex="-1"><a class="header-anchor" href="#kubeadm-upgrade" aria-hidden="true">#</a> kubeadm upgrade</h2><p><code>kubeadm upgrade</code>是一个用户友好的命令，它将复杂的升级逻辑封装在一个命令后面，支持计划升级和实际执行升级。</p><p>如果需要，<code>kubeadm upgrade</code>还可以用于降级集群。</p><p>检查可以升级到哪些版本，并验证当前集群是否可以升级。要跳过internet检查，请传入可选<code>[version]</code>参数。</p><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code>❯ ./kubeadm upgrade
Upgrade your cluster smoothly to a newer version with this command

<span class="token property">Usage</span><span class="token punctuation">:</span>
  kubeadm upgrade [flags]
  kubeadm upgrade [command]

Available <span class="token property">Commands</span><span class="token punctuation">:</span>
  apply       Upgrade your Kubernetes cluster to the specified version
  diff        Show what differences would be applied to existing static pod manifests. See <span class="token property">also</span><span class="token punctuation">:</span> kubeadm upgrade apply --dry-run
  node        Upgrade commands for a node in the cluster
  plan        Check which versions are available to upgrade to and validate whether your current cluster is upgradeable. To skip the internet check<span class="token punctuation">,</span> pass in the optional [version] parameter
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="kubeadm-config" tabindex="-1"><a class="header-anchor" href="#kubeadm-config" aria-hidden="true">#</a> kubeadm config</h2><p>从v1.8.0开始，kubeadm将集群的配置上传到<code>kube-system</code>名称空间中名为<code>kubeadm-config</code>的ConfigMap，然后在升级时读取ConfigMap。这支持正确配置系统组件，并提供了无缝的用户体验。</p><p>你可以执行<code>kubeadm config view</code>来查看ConfigMap。如果使用kubeadm v1.7初始化集群。在使用<code>kubeadm upgrade</code>之前，必须使用<code>kubeadm config upload</code>创建ConfigMap。</p><p>在Kubernetes v1.11.0中，添加了一些新命令。你可以使用<code>kubeadm config print-default</code> 来打印默认配置，而<code>kubeadm config migrate</code> 可以将旧的配置文件转换为新版本。<code>kubeadm config images list</code> 和<code>kubeadm config images pull</code> 可用于列出和拉取kubeadm所需的镜像。</p><p>在 <code>Kubernetes v1.13.0</code> 以及以后的版本中，如果要列出/拉出的是kube-dns镜像，而不是CoreDNS镜像，则必须使用这里描述的<code>--config</code> 方式。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>❯ kubeadm config upload <span class="token parameter variable">--help</span>

There is a ConfigMap <span class="token keyword">in</span> the kube-system namespace called <span class="token string">&quot;kubeadm-config&quot;</span> that kubeadm uses to store internal configuration about the
cluster. kubeadm CLI v1.8.0+ automatically creates this ConfigMap with the config used with <span class="token string">&#39;kubeadm init&#39;</span>, but <span class="token keyword">if</span> you
initialized your cluster using kubeadm v1.7.x or lower, you must use the <span class="token string">&#39;config upload&#39;</span> <span class="token builtin class-name">command</span> to create this
ConfigMap. This is required so that <span class="token string">&#39;kubeadm upgrade&#39;</span> can configure your upgraded cluster correctly.

Usage:
  kubeadm config <span class="token punctuation">[</span>flags<span class="token punctuation">]</span>
  kubeadm config <span class="token punctuation">[</span>command<span class="token punctuation">]</span>

Available Commands:
  images      Interact with container images used by kubeadm
  migrate     Read an older version of the kubeadm configuration API types from a file, and output the similar config object <span class="token keyword">for</span> the newer version
  print       Print configuration

Flags:
  -h, <span class="token parameter variable">--help</span>                <span class="token builtin class-name">help</span> <span class="token keyword">for</span> config
      <span class="token parameter variable">--kubeconfig</span> string   The kubeconfig <span class="token function">file</span> to use when talking to the cluster. If the flag is not set, a <span class="token builtin class-name">set</span> of standard locations can be searched <span class="token keyword">for</span> an existing kubeconfig file. <span class="token punctuation">(</span>default <span class="token string">&quot;/etc/kubernetes/admin.conf&quot;</span><span class="token punctuation">)</span>

Global Flags:
      --add-dir-header           If true, adds the <span class="token function">file</span> directory to the header of the log messages
      --log-file string          If non-empty, use this log <span class="token function">file</span>
      --log-file-max-size uint   Defines the maximum size a log <span class="token function">file</span> can grow to. Unit is megabytes. If the value is <span class="token number">0</span>, the maximum <span class="token function">file</span> size is unlimited. <span class="token punctuation">(</span>default <span class="token number">1800</span><span class="token punctuation">)</span>
      --one-output               If true, only <span class="token function">write</span> logs to their native severity level <span class="token punctuation">(</span>vs also writing to each lower severity level<span class="token punctuation">)</span>
      <span class="token parameter variable">--rootfs</span> string            <span class="token punctuation">[</span>EXPERIMENTAL<span class="token punctuation">]</span> The path to the <span class="token string">&#39;real&#39;</span> <span class="token function">host</span> root filesystem.
      --skip-headers             If true, avoid header prefixes <span class="token keyword">in</span> the log messages
      --skip-log-headers         If true, avoid headers when opening log files
  -v, <span class="token parameter variable">--v</span> Level                  number <span class="token keyword">for</span> the log level verbosity
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="kubeadm-config-upload-from-file" tabindex="-1"><a class="header-anchor" href="#kubeadm-config-upload-from-file" aria-hidden="true">#</a> kubeadm config upload from-file</h3><p>上传一个配置文件到集群内的ConfigMap，用于kubeadm配置。</p><p>使用这个命令，你可以使用提供给<code>kubeadm init</code>的相同配置文件将配置上传到集群中的ConfigMap。如果使用v1.7初始化集群。在使用<code>kubeadm upgrade</code>升级到v1.8之前，你需要使用相同的配置文件运行这个命令。</p><p>配置位于<code>kube-system</code>命名空间中的<code>kubeadm-config</code> ConfigMap中。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubeadm config upload from-file <span class="token punctuation">[</span>flags<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p><code>kubeadm config upload from-file --help </code> 查看支持的 flages</p></blockquote><h3 id="kubeadm-config-view" tabindex="-1"><a class="header-anchor" href="#kubeadm-config-view" aria-hidden="true">#</a> kubeadm config view</h3><p>使用这个命令，你可以在kubeadm配置所在的集群中查看ConfigMap。</p><p>配置位于<code>kube-system</code>命名空间中的<code>kubeadm-config</code> ConfigMap中。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubeadm config view <span class="token punctuation">[</span>flags<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="kubeadm-reset" tabindex="-1"><a class="header-anchor" href="#kubeadm-reset" aria-hidden="true">#</a> kubeadm reset</h2><p>此命令将还原<code>kubeadm init</code>和<code>kubeadm join</code>所做的任何更改。</p><p>运行此命令，以恢复<code> kubeadm init</code>和 <code>kubeadm join</code>对该主机所做的任何更改。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubeadm reset
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="清理外部etcd" tabindex="-1"><a class="header-anchor" href="#清理外部etcd" aria-hidden="true">#</a> 清理外部etcd</h3><p>如果使用外部etcd， <code>kubeadm reset</code>不会删除任何etcd数据。这意味着，如果再次使用相同的etcd端点运行<code>kubeadm init</code>，您将看到以前集群的状态。</p><p>要擦除etcd数据，建议使用etcdctl这样的客户端，例如:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>etcdctl del <span class="token string">&quot;&quot;</span> <span class="token parameter variable">--prefix</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="kubeadm-token" tabindex="-1"><a class="header-anchor" href="#kubeadm-token" aria-hidden="true">#</a> kubeadm token</h2><p>引导令牌用于在连接集群的节点和控制平面节点之间建立双向信任，如<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/accessing_api/authenticating_with_bootstrap_tokens.html" target="_blank" rel="noopener noreferrer">使用引导令牌进行认证<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>中所述。</p><p><code>kubeadm init</code>使用24小时TTL创建初始令牌。下面的命令可以管理该令牌，并创建和管理新的令牌。</p><h3 id="kubeadm-token-create" tabindex="-1"><a class="header-anchor" href="#kubeadm-token-create" aria-hidden="true">#</a> kubeadm token create</h3><p>在服务器上创建引导令牌。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubeadm token create <span class="token punctuation">[</span>token<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这个命令将为您创建一个 <strong>引导令牌</strong>。你可以指定此令牌的用法、“生存时间”和可选的人性化描述。</p><p><code>[token]</code>是要写的实际令牌。这应该是一个安全生成的随机令牌形式<code>[a-z0-9]{6}.[a-z0-9]{16}</code>。如果没有给出<code>[token]</code>，则kubeadm将生成一个随机令牌。</p><blockquote><p>所以所 引导令牌是和 kueadme 对应的：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>❯ kubeadm token create
qg8u0m.g31qk96l34ns9gz4

❯ kubectl get secrets -A | grep -i qg8u0m
kube-system       bootstrap-token-qg8u0m                           bootstrap.kubernetes.io/token         6      2m10s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="kubeadm-token-delete" tabindex="-1"><a class="header-anchor" href="#kubeadm-token-delete" aria-hidden="true">#</a> kubeadm token delete</h3><p>删除服务器上的引导令牌。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubeadm token delete <span class="token punctuation">[</span>token-value<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>例如：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>❯ kubeadm token delete qg8u0m
bootstrap token <span class="token string">&quot;qg8u0m&quot;</span> deleted
❯ kubeadm token list
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="kubeadm-token-generate" tabindex="-1"><a class="header-anchor" href="#kubeadm-token-generate" aria-hidden="true">#</a> kubeadm token generate</h3><p>生成并打印引导令牌，但不要在服务器上创建它。</p><p>这个命令将输出一个随机生成的引导令牌，可以与<code>init</code>和<code>join</code>命令一起使用。</p><p>你不必使用此命令来生成令牌。只要格式是<code>[a-z0-9]{6}.[a-z0-9]{16}</code>，你出可以自己生成。提供此命令是为了方便以给定格式生成令牌。</p><p>你还可以使用<code>kubeadm init</code>而无需指定令牌，它将为你生成并打印一个令牌。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubeadm token generate <span class="token punctuation">[</span>flags<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="kubeadm-token-list" tabindex="-1"><a class="header-anchor" href="#kubeadm-token-list" aria-hidden="true">#</a> kubeadm token list</h3><p>列出服务器上的引导令牌。</p><h2 id="kubeadm-version" tabindex="-1"><a class="header-anchor" href="#kubeadm-version" aria-hidden="true">#</a> kubeadm version</h2><p>这个命令打印kubeadm的版本。</p><h2 id="kubeadm-alpha" tabindex="-1"><a class="header-anchor" href="#kubeadm-alpha" aria-hidden="true">#</a> kubeadm alpha</h2><p>Kubeadm alpha命令是Kubeadm工具中的一个实验性功能，用于启用Kubernetes集群的某些高级功能。在Kubeadm alpha命令中，用户可以使用各种参数和标志来配置所需的功能并启动Kubernetes集群。</p><h3 id="kubeadm-alpha-certs-renew" tabindex="-1"><a class="header-anchor" href="#kubeadm-alpha-certs-renew" aria-hidden="true">#</a> kubeadm alpha certs renew</h3><p>你可以使用<code>all</code>子命令更新所有Kubernetes证书，或者有选择地更新它们。</p><h3 id="renew" tabindex="-1"><a class="header-anchor" href="#renew" aria-hidden="true">#</a> renew</h3><p>更新Kubernetes集群的证书。</p><h3 id="all" tabindex="-1"><a class="header-anchor" href="#all" aria-hidden="true">#</a> all</h3><p>更新所有可用证书。</p><p>更新运行控制平面所需的所有已知证书。无论过期日期如何，都会无条件地运行续订。为了获得更多的控制，还可以单独运行续订。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubeadm alpha certs renew all <span class="token punctuation">[</span>flags<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="kubeadm-alpha-kubeconfig-user" tabindex="-1"><a class="header-anchor" href="#kubeadm-alpha-kubeconfig-user" aria-hidden="true">#</a> kubeadm alpha kubeconfig user</h3><p><code>user</code>子命令可用于为其他用户创建kubeconfig文件。</p><h2 id="kubeadm-init-phase" tabindex="-1"><a class="header-anchor" href="#kubeadm-init-phase" aria-hidden="true">#</a> kubeadm init phase</h2><p>在v1.8.0中，kubeadm引入了<code>kubeadm alpha phase</code>命令，目的是使kubeadm更加模块化。在v1.13.0中，这个命令逐渐过渡到<code>kubeadm init phase</code>。这种模块化使你能够调用引导过程的原子子步骤。因此，你可以让kubeadm完成某些部分，并在需要自定义的地方进行填充。</p><p><code>kubeadm init phase</code>与<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/kubeadm_init.html#chushihualiucheng" target="_blank" rel="noopener noreferrer"><code>kubeadm init</code>工作流程<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>是一致的，并且两者都使用相同的代码。</p><h2 id="kubeadm-join-phase" tabindex="-1"><a class="header-anchor" href="#kubeadm-join-phase" aria-hidden="true">#</a> kubeadm join phase</h2><p>在v1.14.0中，kubeadm引入了<code>kubeadm join phase</code>命令，目的是使kubeadm更加模块化。这种模块化使你能够调用加入（join）过程的原子子步骤。因此，你可以让kubeadm完成某些部分，并在需要自定义的地方进行填充。</p><p><code>kubeadm join phase</code>与<code>kubeadm join</code>工作流程是一致的，并且在后台两者都使用相同的代码。</p><h2 id="细节" tabindex="-1"><a class="header-anchor" href="#细节" aria-hidden="true">#</a> 细节</h2><p>kubeadm 围绕着 init 和 join 为主体开展的。</p><p><code>kubeadm init</code>和<code>kubeadm join</code>所建立的集群应该是:</p><ul><li><p>安全的：</p><p>它应该采用最新的最佳实践，如:</p><ul><li>强制执行RBAC</li><li>使用节点授权器</li><li>使用控制平面组件之间的安全通信</li><li>使用API服务器和kubelet之间的安全通信</li><li>锁定kubelet API</li><li>锁定对kube-proxy和CoreDNS等系统组件的API访问</li><li>锁定引导令牌可以访问的内容</li><li>等待</li></ul></li><li><p>易用的：</p><p>用户运行的两个命令不应该超两个:</p><ul><li><code>kubeadm init</code></li><li><code>export KUBECONFIG=/etc/kubernetes/admin.conf</code></li><li><code>kubectl apply -f &lt;network-of-choice.yaml&gt;</code></li><li><code>kubeadm join --token &lt;token&gt; &lt;master-ip&gt;:&lt;master-port&gt;</code></li></ul></li><li><p>可扩展的：</p><ul><li>例如，它应该不支持所有网络提供者，相反，配置网络已超出了范围</li><li>应该提供使用配置文件定制各种参数的可能性</li></ul></li></ul><h3 id="常量和著名的值与路径" tabindex="-1"><a class="header-anchor" href="#常量和著名的值与路径" aria-hidden="true">#</a> 常量和著名的值与路径</h3><p>为了降低复杂性并简化基于kubeadm实现的部署解决方案的开发，kubeadm为众所周知的路径和文件名使用一组有限的常量值。</p><p>Kubernetes目录<code>/etc/kubernetes</code>在应用程序中是一个常量，因为它在大多数情况下都是给定的路径，并且是最直观的位置；其他常量路径和文件名为:</p><ul><li><strong><code>/etc/kubernetes/manifests</code> 作为kubelet应该寻找静态Pod清单的路径。静态pod的清单有:</strong><ul><li><code>etcd.yaml</code></li><li><code>kube-apiserver.yaml</code></li><li><code>kube-controller-manager.yaml</code></li><li><code>kube-scheduler.yaml</code></li></ul></li><li><strong><code>/etc/kubernetes/</code> 作为存储具有控制平面组件标识符的kubeconfig文件的路径。kubeconfig文件的名称有:</strong><ul><li><code>kubelet.conf</code> (<code>bootstrap-kubelet.conf</code> 在TLS引导期间)</li><li><code>controller-manager.conf</code></li><li><code>scheduler.conf</code></li><li><code>admin.conf</code> 用于集群管理员和kubeadm自己</li></ul></li><li><strong>证书和密钥文件名称:</strong><ul><li><code>ca.crt</code>、 <code>ca.key</code> 用于Kubernetes证书授权</li><li><code>apiserver.crt</code>、 <code>apiserver.key</code> 用于API服务器证书</li><li><code>apiserver-kubelet-client.crt</code>、 <code>apiserver-kubelet-client.key</code> 作为API服务器的客户端证书用于连接安全地连接kubelet</li><li><code>sa.pub</code>、 <code>sa.key</code> 在签名<code>ServiceAccount</code>时，作为控制器管理器的密钥</li><li><code>front-proxy-ca.crt</code>、 <code>front-proxy-ca.key</code> 用于前端代理证书授权</li><li><code>front-proxy-client.crt</code>、 <code>front-proxy-client.key</code> 用于前端代理客户端</li></ul></li></ul><h3 id="kubeadm初始化流程的内部设计" tabindex="-1"><a class="header-anchor" href="#kubeadm初始化流程的内部设计" aria-hidden="true">#</a> kubeadm初始化流程的内部设计</h3><p><code>kubeadm init</code>内部流程（第二个段落标题）由一系列要执行的原子工作任务组成，如<code>kubeadm init</code>中所述。</p><p><code>kubeadm init phase</code>命令允许用户分别调用每个任务，并最终提供一个可重用和可组合的API/工具箱，其他Kubernetes引导工具、任何IT自动化工具或高级用户都可以使用该API/工具箱创建自定义集群。</p><h3 id="预检查-preflight" tabindex="-1"><a class="header-anchor" href="#预检查-preflight" aria-hidden="true">#</a> 预检查（preflight)</h3><p>Kubeadm在启动 init 之前执行一组预先检查，目的是验证先决条件并避免常见的集群启动问题。在任何情况下，用户都可以使用<code>--ignore-preflight-errors</code> 选项跳过特定的预先检查（或者最终跳过所有的预先检查）。</p><ul><li>[警告]如果要使用的Kubernetes版本（使用 <code>--kubernetes-version</code>选项指定）至少比kubeadm CLI版本高一个次要版本。</li><li>Kubernetes系统要求: <ul><li>如果运行在linux上: <ul><li>[错误]如果不是拥有特定KernelSpec的内核3.10+或4</li><li>[错误]如果需要的cgroups子系统没有建立</li></ul></li><li>如果使用docker： <ul><li>[警告/错误]如果Docker服务不存在，如果它被禁用，如果它不是活动的。</li><li>[错误]如果Docker端点不存在或不工作</li><li>[警告]如果docker版本&gt;17.03</li></ul></li><li>如果使用其它CRI引擎： <ul><li>[错误]如果crictl套接字没有应答</li></ul></li></ul></li><li>[错误]如果用户不是root</li><li>[错误]如果机器主机名不是有效的DNS子域名</li><li>[警告]如果无法通过网络查找访问主机名</li><li>[错误]如果kubelet版本低于kubeadm支持的最小kubelet版本（当前次要版本 - 1）</li><li>[错误]如果kubelet版本比所需的控制平面版本（不支持的版本倾斜）高至少一个次要版本</li><li>[警告]如果kubelet服务不存在或被禁用</li><li>[警告]如果firewalld是活动的</li><li>[错误]如果API服务器bindPort或端口使用的是<code>10250/10251/10252</code></li><li>[错误]如果<code>/etc/kubernetes/manifest</code>文件夹已经存在且不是空的</li><li>[错误]如果<code>/proc/sys/net/bridge/bridge-nf-call-iptables</code>文件不存在或不包含1</li><li>[错误]如果advertise地址是ipv6， <code>/proc/sys/net/bridge/bridge-nf-call-ip6tables</code>不存在或不包含1。</li><li>[错误]如果swap是打开的</li><li>[错误]如果命令路径中不存在<code>ip</code>、<code>iptables</code>、<code>mount</code>、<code>nsenter</code>命令</li><li>[警告]如果命令路径中没有<code>ebtables</code>、<code>ethtool</code>、<code>socat</code>、<code>tc</code>、<code>touch</code>、<code>crictl</code>命令</li><li>[警告]如果API服务器、控制器管理器、调度器的额外参数包含一些无效选项</li><li>[警告]如果通过代理连接到<a href="https://api.advertiseaddress:API.BindPort/" target="_blank" rel="noopener noreferrer">https://API.AdvertiseAddress:API.BindPort<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>[警告]如果通过代理连接到服务子网（仅选中第一个地址）</li><li>[警告]如果通过代理连接到Pod子网（仅选中第一个地址）</li><li>如果提供外部etcd: <ul><li>[错误]如果etcd版本小于3.0.14</li><li>[错误]如果指定etcd证书或密钥，但没有提供</li></ul></li><li>如果没有提供外部etcd（因此将安装本地etcd）: <ul><li>[错误]如果2379端口被占用</li><li>[错误]如果 Etcd.DataDir文件夹已经存在并且不为空</li></ul></li><li>如果授权模式为ABAC: <ul><li>[错误]如果<code>abac_policy.json</code>文件不存在</li></ul></li><li>如果授权模式是WebHook： <ul><li>[错误]如果<code>webhook_authz .conf</code>文件不存在</li></ul></li></ul><p>请注意：</p><ol><li>可以使用 <code>kubeadm init phase preflight</code>命令单独执行预先检查</li></ol><h3 id="生成必要的证书" tabindex="-1"><a class="header-anchor" href="#生成必要的证书" aria-hidden="true">#</a> 生成必要的证书</h3><p>Kubeadm生成用于不同目的的证书和私钥对:</p><ul><li><p>一个用于Kubernetes集群的自签名证书颁发机构，保存在<code>ca.crt</code>文件和<code>ca.key</code>私钥文件中</p></li><li><p>API服务器的服务证书，使用</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>ca.crt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>作为CA生成，并保存到</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>apiserver.crt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>文件及其私钥</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>apiserver.key
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>。此证书应包含以下可选名称:</p><ul><li>Kubernetes服务的内部集群IP（服务CIDR中的第一个地址，例如：如果服务子网是<code>10.96.0.0/12</code>，则集群IP为<code>10.96.0.1</code>）</li><li>Kubernetes DNS名称；例如：如果指定<code>--service-dns-domain</code> 为 <code>cluster.local</code>，则DNS名称为<code>kubernetes.default.svc.cluster.local</code> ，加上默认DNS名称： <code>kubernetes.default.svc</code>、<code>kubernetes.default</code>、 <code>kubernetes</code></li><li>节点名称</li><li><code>--apiserver-advertise-address</code></li><li>由用户指定的其他替代名称</li></ul></li><li><p>用于API服务器安全地连接到kubelet的客户端证书，使用<code>ca.crt</code>作为CA生成，并保存到<code>apiserver-kubelet-client.crt</code>文件中及其私钥<code>apiserver-kubelet-client.key</code>。这个证书应该在 <code>system:masters</code>组织中</p></li><li><p>用于签名服务账户令牌的私钥，并保存至 <code>sa.key</code> 文件及其公钥文件 <code>sa.pub</code></p></li><li><p>用于前端代理授权的证书，并保存至 <code>front-proxy-ca.crt</code>文件及其密钥文件y<code>front-proxy-ca.key</code></p></li><li><p>用于前端代理客户端的客户端证书，使用 <code>front-proxy-ca.crt</code>作为CA生成，并保存至 <code>front-proxy-client.crt</code> 文件及其私钥<code>front-proxy-client.key</code></p></li></ul><p>证书默认存储在<code>/etc/kubernetes/pki</code>中，但是这个目录可以使用<code>--cert-dir</code>选项进行配置。</p><p><strong>请注意：</strong></p><ol><li>如果一个给定的证书和私钥对都存在，并且它的内容符合上面的规范，那么将使用现有的文件，并且跳过给定证书的生成阶段。例如，这意味着用户可以将现有CA复制到<code>/etc/kubernetes/pki/ca.{crt,key}</code>，然后kubeadm将使用这些文件来签署其余的证书。</li><li>仅对于CA，可以只提供<code>ca.crt</code>文件而不提供<code>ca.key</code>文件，如果所有其他证书和kubeconfig文件已经到位，kubeadm识别这种情况并激活外部CA模式，这也意味着在控制器管理器的<code>csrsigner</code>控制器不会启动。</li><li>如果kubeadm在<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/kubeadm_init.html#waibucamoshi" target="_blank" rel="noopener noreferrer">外部CA模式<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>下运行；所有证书都必须由用户提供，因为kubeadm不能自己生成证书。</li><li>在kubeadm以<code>--dry-run</code>模式执行时，证书文件被写入一个临时文件夹。</li><li>可以使用<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/kubeadm_init_phase.html#kubeadm-init-phase-certs" target="_blank" rel="noopener noreferrer"><code>kubeadm init phase certs all</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 命令单独调用证书生成。</li></ol><h3 id="为控制平面组件生成kubeconfig文件" tabindex="-1"><a class="header-anchor" href="#为控制平面组件生成kubeconfig文件" aria-hidden="true">#</a> 为控制平面组件生成kubeconfig文件</h3><p>带有控制平面组件标识的Kubeadm kubeconfig文件:</p><ul><li><p>一个kubeconfig文件，供kubelet使用，</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>/etc/kubernetes/kubelet.conf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>；在这个文件中嵌入了一个带有kubelet标识的客户端证书。此客户证书应该：</p><ul><li>在 <code>system:nodes</code>组织中，根据<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/accessing_api/using_node_authorization.html" target="_blank" rel="noopener noreferrer">节点授权<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>模块的要求</li><li>CN为 <code>system:node:&lt;hostname-lowercased&gt;</code></li></ul></li><li><p>一个kubeconfig文件，供控制器管理器使用，<code>/etc/kubernetes/controller-manager.conf</code>；在这个文件中嵌入了一个带有控制器管理器标识的客户端证书。这个客户端证书的CN应该为 <code>system:kube-controller-manager</code>，这是由默认的<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/accessing_api/using_rbac_authorization.html#hexinzujianjiaose" target="_blank" rel="noopener noreferrer">RBAC核心组件角色<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>定义的</p></li><li><p>一个kubeconfig文件，供调度器使用，<code>/etc/kubernetes/scheduler.conf</code>；在这个文件中嵌入了一个带有调度器标识的客户端证书。这个客户端证书CN应该为<code>system:kube-scheduler</code>，这是由默认的<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/accessing_api/using_rbac_authorization.html#hexinzujianjiaose-1" target="_blank" rel="noopener noreferrer">RBAC核心组件角色<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>定义的</p></li></ul><p>此外，还生成一个kubeadm自身和管理员使用的kubeconfig文件，并将其保存到<code>/etc/kubernetes/admin.conf</code>文件中。这里的<code>admin</code>定义了管理集群并希望完全控制（root）集群的实际人员。用于<code>admin</code>的嵌入式客户端证书应该：</p><ul><li>在<code>system:masters</code>组织中，如默认的<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/accessing_api/using_rbac_authorization.html#mianxiangyonghudejiaose" target="_blank" rel="noopener noreferrer">RBAC用户面向角色绑定<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>所定义的那样</li><li>包含一个CN，但它可以是任何值。Kubeadm使用CN <code>kubernetes-admin</code></li></ul><p>请注意：</p><ol><li><code>ca.crt</code>证书被嵌入到所有kubeconfig文件中。</li><li>如果存在一个给定的kubeconfig文件，并且它的内容符合上面的规范，那么将使用现有的文件，并且跳过给定kubeconfig的生成阶段。</li><li>如果kubeadm在外部CA模式下运行，那么用户还必须提供所有必需的kubeconfig，因为kubeadm本身不能生成任何kubeonfig</li><li>在kubeadm以<code>--dry-run</code>模式时，kubeconfig文件被写入一个临时文件夹。</li><li>可以使用<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/kubeadm_init_phase.html#kubeadm-init-phase-kubeconfig" target="_blank" rel="noopener noreferrer"><code>kubeadm init phase kubeconfig all</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 命令单独调用Kubeconfig文件生成。</li></ol><h3 id="为控制平面组件生成pod吊舱清单" tabindex="-1"><a class="header-anchor" href="#为控制平面组件生成pod吊舱清单" aria-hidden="true">#</a> 为控制平面组件生成pod吊舱清单</h3><p>Kubeadm将控制平面组件的静态Pod清单文件写入<code>/etc/kubernetes/manifests</code>；kubelet监控这个目录，以便在启动时创建pod。</p><p>静态Pod清单共享一组公共属性:</p><ul><li><p>所有静态pod都部署在<code>kube-system</code>命名空间中</p></li><li><p>所有静态pod都有 <code>tier:control-plane</code> 和<code>component:{component-name}</code> 标签</p></li><li><p>所有静态pod都有 <code>scheduler.alpha.kubernetes.io/critical-pod</code>注解（这将转移到适当的解决方案，即在就绪时使用Pod优先级和抢占）</p></li><li><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>hostNetwork: true
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>设置在所有静态pod上，允许在配置网络之前启动控制平面；结果:</p><ul><li>控制器管理器和调度器用来引用API服务器的<code>address</code>是<code>127.0.0.1</code></li><li>如果使用本地etcd服务器，<code>etcd-servers</code>地址将被设置为<code>127.0.0.1:2379</code></li></ul></li><li><p>控制器管理器和调度器都启用了选主功能</p></li><li><p>控制器管理器和调度器将使用各自的惟一标识引用kubeconfig文件</p></li><li><p>所有静态pod获取用户指定的所有额外选项，如<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/kubeadm_init.html#xiangkongzhipingmianchuandizidingyixuanxiang" target="_blank" rel="noopener noreferrer">向控制平面传递自定义选项<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>中所述</p></li><li><p>所有静态pod获取用户（<code>hostPath</code>）指定的所有额外卷</p></li></ul><p>请注意：</p><ol><li>所有的镜像，对于 <code>--kubernetes-version</code>或当前架构，将从<code>k8s.gcr.io</code>拉取。如果指定了替代镜像仓库或CI镜像仓库，则使用此仓库；如果所有控制平面组件都应该使用特定的容器镜像，则将使用此镜像。有关详细信息，请参见<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/kubeadm_init.html#shiyongzidingyijingxiang" target="_blank" rel="noopener noreferrer">使用自定义镜像<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>在kubeadm以<code>--dry-run</code>模式执行时，静态Pod文件被写入一个临时文件夹</li><li>可以使用 <a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/kubeadm_init_phase.html#kubeadm-init-phase-control-plane" target="_blank" rel="noopener noreferrer"><code>kubeadm init phase control-plane all</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>命令单独调用主组件的静态Pod清单生成</li></ol><h4 id="api服务器" tabindex="-1"><a class="header-anchor" href="#api服务器" aria-hidden="true">#</a> API服务器</h4><p>API服务器的静态Pod清单受用户提供的参数影响:</p><ul><li>要绑定的<code>apiserver-advertise-address</code> 和<code>apiserver-bind-port</code> ；如果没有提供，这些值默认为机器上默认网络接口的IP地址和6443端口</li><li>用于服务的<code>service-cluster-ip-range</code></li><li>如果指定了外部etcd服务器，则指定 <code>etcd-servers</code> 地址和相关TLS设置（<code>etcd-cafile</code>、<code>etcd-certfile</code>、<code>etcd-keyfile</code>）；如果不提供外部etcd服务器，则使用本地etcd（通过主机网络）</li><li>如果指定了云提供商，则配置相应的 <code>--cloud-provider</code>，如果存在 <code>--cloud-config</code>路径（这是实验性的、alpha级别，将在未来版本中删除）</li></ul><p>其他无条件设置的API服务器选项有：</p><ul><li><p><code>--insecure-port=0</code> 避免与API服务器的不安全连接</p></li><li><p><code>--enable-bootstrap-token-auth=true</code> 启用 <code>BootstrapTokenAuthenticator</code> 认证模块。更多信息，请参见<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/command_line_tools_reference/tls_bootstrapping.html" target="_blank" rel="noopener noreferrer">TLS引导<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li><li><p><code>--allow-privileged</code> 为<code>true</code> （必须，例如：kube-proxy）</p></li><li><p><code>--requestheader-client-ca-file</code> 为<code>front-proxy-ca.crt</code></p></li><li><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>--enable-admission-plugins
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>为：</p><ul><li><a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/accessing_api/using_admission_controllers.html#namespacelifecycle" target="_blank" rel="noopener noreferrer"><code>NamespaceLifecycle</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 避免删除系统保留的命名空间</li><li><a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/accessing_api/using_admission_controllers.html#limitranger" target="_blank" rel="noopener noreferrer"><code>LimitRanger</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 和<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/accessing_api/using_admission_controllers.html#resourcequota" target="_blank" rel="noopener noreferrer"><code>ResourceQuota</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 执行命名空间限制</li><li><a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/accessing_api/using_admission_controllers.html#serviceaccount" target="_blank" rel="noopener noreferrer"><code>ServiceAccount</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 执行服务账户自动化</li><li><a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/accessing_api/using_admission_controllers.html#persistentvolumelabel" target="_blank" rel="noopener noreferrer"><code>PersistentVolumeLabel</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 将地区（region）或区域（zone）标签附加到云提供商定义的持久卷上（不推荐使用此准入控制器，并将在将来的版本中删除）。在默认情况下，当不明确选择使用<code>gce</code>或<code>aws</code>作为云提供商时，在v1.9以上版本中，kubeadm不会部署此准入控制器）</li><li><a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/accessing_api/using_admission_controllers.html#defaultstorageclass" target="_blank" rel="noopener noreferrer"><code>DefaultStorageClass</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 在 <code>PersistentVolumeClaim</code>对象上强制执行默认存储类、</li><li><a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/accessing_api/using_admission_controllers.html#defaulttolerationseconds" target="_blank" rel="noopener noreferrer"><code>DefaultTolerationSeconds</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/accessing_api/using_admission_controllers.html#noderestriction" target="_blank" rel="noopener noreferrer"><code>NodeRestriction</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 限制kubelet可以修改的内容（例如，只有这个节点上的pod）</li></ul></li><li><p><code>--kubelet-preferred-address-types</code> 为<code>InternalIP,ExternalIP,Hostname;</code> 这使得<code>kubectl logs</code>和其他API服务器与kubelet的通信可以在节点的主机名无法解析的环境中工作</p></li><li><p>使用前面步骤生成的证书的选项:</p><ul><li><code>--client-ca-file</code> 为<code>ca.crt</code></li><li><code>--tls-cert-file</code> 为<code>apiserver.crt</code></li><li><code>--tls-private-key-file</code> 为<code>apiserver.key</code></li><li><code>--kubelet-client-certificate</code> 为<code>apiserver-kubelet-client.crt</code></li><li><code>--kubelet-client-key</code> 为<code>apiserver-kubelet-client.key</code></li><li><code>--service-account-key-file</code> 为<code>sa.pub</code></li><li><code>--requestheader-client-ca-file</code> 为-proxy-ca.crt`</li><li><code>--proxy-client-cert-file</code> 为<code>front-proxy-client.crt</code></li><li><code>--proxy-client-key-file</code> 为<code>front-proxy-client.key</code></li></ul></li><li><p>用于保护前端代理（</p><p>API聚合</p><p>）通信的其他选项：</p><ul><li><code>--requestheader-username-headers=X-Remote-User</code></li><li><code>--requestheader-group-headers=X-Remote-Group</code></li><li>``--requestheader-extra-headers-prefix=X-Remote-Extra-`</li><li><code>--requestheader-allowed-names=front-proxy-client</code></li></ul></li></ul><h4 id="控制器管理器" tabindex="-1"><a class="header-anchor" href="#控制器管理器" aria-hidden="true">#</a> 控制器管理器</h4><p>API服务器的静态Pod清单受用户提供的参数影响:</p><ul><li><p>如果调用kubeadm时指定了</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>--pod-network-cidr
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>，则通过设置以下选项可以启用某些CNI网络插件所需的子网管理器特性:</p><ul><li><code>--allocate-node-cidrs=true</code></li><li><code>--cluster-cidr</code> 和<code>--node-cidr-mask-size</code> 选项（根据指定的CIDR）</li><li>如果指定了云提供商，则配置相应的 <code>--cloud-provider</code>，如果存在 <code>--cloud-config</code>路径（这是实验性的、alpha级别，将在未来版本中删除）</li></ul></li></ul><p>其他无条件设置的选项有:</p><ul><li><code>--controllers</code> 为TLS引导启用所有默认控制器以及<code>BootstrapSigner</code>和<code>TokenCleaner</code>控制器。有关详细信息，请参见<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/command_line_tools_reference/tls_bootstrapping.html" target="_blank" rel="noopener noreferrer">TLS引导<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><code>--use-service-account-credentials</code> 为<code>true</code></li><li>使用前面步骤生成的证书的选项: <ul><li><code>--root-ca-file</code> 为<code>ca.crt</code></li><li><code>--cluster-signing-cert-file</code> 为<code>ca.crt</code>，如果禁用了外部CA模式，则设置为<code>&quot;&quot;</code></li><li><code>--cluster-signing-key-file</code> 为<code>ca.key</code>，如果禁用了外部CA模式，则设置为<code>&quot;&quot;</code></li><li><code>--service-account-private-key-file</code> 为<code>sa.key</code></li></ul></li></ul><h4 id="调度器" tabindex="-1"><a class="header-anchor" href="#调度器" aria-hidden="true">#</a> 调度器</h4><p>调度器的静态Pod清单不受用户提供的参数的影响。</p><h3 id="为本地etcd生成静态pod清单" tabindex="-1"><a class="header-anchor" href="#为本地etcd生成静态pod清单" aria-hidden="true">#</a> 为本地etcd生成静态Pod清单</h3><p>如果用户指定了一个外部etcd，则跳过此步骤，否则kubeadm将生成一个静态Pod清单文件，用于创建在Pod中运行的本地etcd实例，该实例具有以下属性:</p><ul><li>在 <code>localhost:2379</code> 上进行监听并使用 <code>HostNetwork=true</code></li><li>将 <code>hostPath</code>从<code>dataDir</code>挂载到主机的文件系统</li><li>用户指定的任何额外选项</li></ul><p>请注意：</p><ol><li>etcd镜像将从<code>k8.gcr.io</code>中拉取。如果指定了另一个镜像仓库，则使用此镜像仓库；如果指定了其他镜像名称，则将使用此镜像名称。有关详细信息，请参见<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/kubeadm_init.html#shiyongzidingyijingxiang-1" target="_blank" rel="noopener noreferrer">使用自定义镜像<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>在kubeadm以<code>--dry-run</code>模式执行时，静态Pod文件被写入一个临时文件夹</li><li>本地etcd的静态Pod清单生成可以使用<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/kubeadm_init_phase.html#kubeadm-init-phase-etcd" target="_blank" rel="noopener noreferrer"><code>kubeadm init phase etcd local</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 命令单独调用</li></ol><h3 id="可选的动态kublet配置" tabindex="-1"><a class="header-anchor" href="#可选的动态kublet配置" aria-hidden="true">#</a> 可选的动态Kublet配置</h3><p>要使用此功能，请调用 <code>kubeadm alpha kubelet config enable-dynamic</code>。它将kubelet初始化配置写入 <code>/var/lib/kubelet/config/init/kubelet</code>文件。</p><p>初始化配置用于在此特定节点上启动kubelet，为kubelet的drop-in文件提供了另一种选择；这些配置将被kubelet基本配置所替代，如下面的步骤所述。有关更多信息，请参见<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/tasks/administer_cluster/set_kubelet_parameters_via_a_config_file.html" target="_blank" rel="noopener noreferrer">通过配置文件设置Kubelet参数<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。</p><p>请注意：</p><ul><li>要使动态kubelet配置工作，<code>--dynamic-config-dir=/var/lib/kubelet/config/dynamic</code> 应该在 <code>/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</code>中指定</li><li>使用配置文件<code>--config some-file.yaml</code>向<code>kubeadm init</code> 或<code>kubeadm join</code> 传递一个 <code>KubeletConfiguration</code>对象，可以更改kubelet配置。可以使用<code>---</code>分隔符将<code>KubeletConfiguration</code>对象与其他对象（如<code>InitConfiguration</code>）分隔开。有关更多细节，请查看 <code>kubeadm config print-default</code>命令。</li></ul><h3 id="等待控制平面启动" tabindex="-1"><a class="header-anchor" href="#等待控制平面启动" aria-hidden="true">#</a> 等待控制平面启动</h3><p>这是kubeadm集群的关键时刻。kubeadm将等待<code>localhost:6443/healthz</code>返回<code>ok</code>，但是为了检测死锁条件，如果<code>localhost:10255/healthz</code> （kubelet存活）或<code>localhost:10255/healthz/syncloop</code> （kubelet就绪）在40秒和60秒后都没有返回<code>ok</code>，则kubeadm将快速失败。</p><p>kubeadm依赖于kubelet来拉取控制平面镜像，并将其作为静态pod正常运行。控制平面启动后，kubeadm将完成以如下段落中描述的任务。</p><h3 id="在v1-9中为可选的alpha级别-写入kubelet基本配置" tabindex="-1"><a class="header-anchor" href="#在v1-9中为可选的alpha级别-写入kubelet基本配置" aria-hidden="true">#</a> （在v1.9中为可选的alpha级别）写入kubelet基本配置</h3><p>如果使用 <code>--feature-gates=DynamicKubeletConfig</code>调用kubeadm：</p><ul><li>将kubelet基本配置写入<code>kube-system</code>命名空间中的<code>kubelet-base-config-v1.9</code> ConfigMap</li><li>创建RBAC规则，授予对所有引导令牌和所有kubelet实例(即 <code>system:bootstrappers:kubeadm:default-node-token</code> 和<code>system:nodes</code>组)的ConfigMap的读访问权</li><li>通过 <code>Node.spec.configSource</code>指向新创建的ConfigMap，为初始控制平面节点启用动态kubelet配置特性。</li></ul><h3 id="将kubeadm集群配置保存在configmap中-供以后使用" tabindex="-1"><a class="header-anchor" href="#将kubeadm集群配置保存在configmap中-供以后使用" aria-hidden="true">#</a> 将kubeadm集群配置保存在ConfigMap中，供以后使用</h3><p>kubeadm将通过选项或配置文件传递给<code>kubeadm init</code>的配置保存在<code>kube-system</code>命名空间中名为<code>kubeadm-config</code>的ConfigMap中。</p><p>这将确保将来执行kubeadm操作（如：<code>kubeadm upgrade</code>）将能够确定实际/当前集群状态，并基于该数据做出新的决策。</p><p>请注意：</p><ol><li>在上传之前，敏感信息，例如令牌，将从配置中删除</li><li>可以使用<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/kubeadm_init_phase.html#kubeadm-init-phase-upload-config" target="_blank" rel="noopener noreferrer"><code>kubeadm init phase upload-config</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 命令单独调用主节点配置的上传</li><li>如果使用kubeadm v1.7初始化集群。在升级到v1.8之前，你必须手动创建主节点配置ConfigMap。为了简化这一任务，实现了 <a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/kubeadm_config.html" target="_blank" rel="noopener noreferrer"><code>kubeadm config upload (from-flags|from-file)</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ol><h3 id="标记主节点" tabindex="-1"><a class="header-anchor" href="#标记主节点" aria-hidden="true">#</a> 标记主节点</h3><p>一旦控制平面可用，kubeadm就会执行以下操作:</p><ul><li>为主节点添加 <code>node-role.kubernetes.io/master=&quot;&quot;</code>标签</li><li>为主节点添加 <code>node-role.kubernetes.io/master:NoSchedule</code>污染</li></ul><p>请注意：</p><ul><li>可以使用<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/kubeadm_init_phase.html#kubeadm-init-phase-mark-control-plane" target="_blank" rel="noopener noreferrer"><code>kubeadm init phase mark-control-plane</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 命令单独调用标记控制平面阶段</li></ul><h3 id="配置tls引导用于节点加入集群" tabindex="-1"><a class="header-anchor" href="#配置tls引导用于节点加入集群" aria-hidden="true">#</a> 配置TLS引导用于节点加入集群</h3><p>Kubeadm<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/accessing_api/authenticating_with_bootstrap_tokens.html" target="_blank" rel="noopener noreferrer">使用引导令牌进行认证<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，将新节点连接到现有集群；有关更多细节，请参见<a href="https://github.com/kubernetes/community/blob/master/contributors/design-proposals/cluster-lifecycle/bootstrap-discovery.md" target="_blank" rel="noopener noreferrer">设计提案<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。</p><p><code>kubeadm init</code>确保为该进程正确配置了所有内容，这包括以下步骤以及设置API服务器和控制器选项（如前面各段落中所述）。请注意：</p><ul><li>可以使用<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/kubeadm_init_phase.html#kubeadm-init-phase-bootstrap-token" target="_blank" rel="noopener noreferrer"><code>kubeadm init phase bootstrap-token</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 命令配置节点的TLS引导，执行如下各段落描述的所有配置步骤；或者，每个步骤都可以单独调用</li></ul><h4 id="创建引导令牌" tabindex="-1"><a class="header-anchor" href="#创建引导令牌" aria-hidden="true">#</a> 创建引导令牌</h4><p><code>kubeadm init</code>创建第一个引导令牌，该令牌可以自动生成，也可以由用户使用 <code>--token</code>箕提供；正如引导令牌规范中所记录的那样，令牌应该以名称 <code>bootstrap-token-&lt;token-id&gt;</code> 作为Secret保存在<code>kube-system</code>命名空间中。请注意:</p><ol><li>由<code>kubeadm init</code>创建的缺省令牌将用于验证TLS引导过程中的临时用户；这些用户将是<code>system:bootstrappers:kubeadm:default-node-token</code> 组的成员</li><li>令牌的有效性有限，默认为24小时（间隔可以使用<code>—token-ttl</code> 选项更改）</li><li>可以使用<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/kubeadm_token.html" target="_blank" rel="noopener noreferrer"><code>kubeadm token</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>命令创建其他令牌，该命令为令牌管理提供了其他有用的功能</li></ol><h4 id="允许要加入的节点调用csr-api" tabindex="-1"><a class="header-anchor" href="#允许要加入的节点调用csr-api" aria-hidden="true">#</a> 允许要加入的节点调用CSR API</h4><p>Kubeadm确保 <code>system:bootstrappers:kubeadm:default-node-token</code>组中的用户能够访问证书签名API。</p><p>这是通过在上面的组和默认RBAC角色 <code>system:node-bootstrapper</code>之间创建一个名为 <code>kubeadm:kubelet-bootstrap</code>的集群角色绑定来实现的。</p><h4 id="为新的引导令牌设置自动批准" tabindex="-1"><a class="header-anchor" href="#为新的引导令牌设置自动批准" aria-hidden="true">#</a> 为新的引导令牌设置自动批准</h4><p>Kubeadm确保引导令牌将由<code>csrapprover</code>控制器自动批准其CSR请求。</p><p>这是通过在<code>system:bootstrappers:kubeadm:default-node-token</code> 组和默认角色 <code>system:certificates.k8s.io:certificatesigningrequests:nodeclient</code>之间创建一个名为 <code>kubeadm:node-autoapprove-bootstrap</code> 的集群角色绑定来实现的。</p><p>应该也创建了 <code>system:certificates.k8s.io:certificatesigningrequests:nodeclient</code>角色，该角色被授予了对<code>/apis/certificates.k8s.io/certificatesigningrequests/nodeclient</code>的POST权限。</p><h4 id="为节点证书旋转设置自动批准" tabindex="-1"><a class="header-anchor" href="#为节点证书旋转设置自动批准" aria-hidden="true">#</a> 为节点证书旋转设置自动批准</h4><p>Kubeadm确保为节点启用证书旋转，节点的新证书请求将由<code>csrapprover</code>控制器自动批准其CSR请求。</p><p>这是通过在<code>system:nodes</code> 组和默认角色 <code>system:certificates.k8s.io:certificatesigningrequests:selfnodeclient</code>之间创建一个名为 <code>kubeadm:node-autoapprove-certificate-rotation</code> 的集群角色绑定来实现的。</p><h4 id="创建公共cluster-info-configmap" tabindex="-1"><a class="header-anchor" href="#创建公共cluster-info-configmap" aria-hidden="true">#</a> 创建公共cluster-info ConfigMap</h4><p>这个阶段在<code>kube-public</code>命名空间中创建<code>cluster-info</code> ConfigMap。</p><p>此外，它还创建了一个角色和一个角色绑定，授予未经认证的用户（即 <code>system:unauthenticated</code>组中的用户）访问该ConfigMap的权限。</p><p>请注意：</p><ol><li>对<code>cluster-info</code> ConfigMap的访问不受速率限制。如果你把你的主节点暴露在互联网上，这可能是个问题，也可能不是；最坏的情况是DoS攻击，攻击者使用API服务器能够处理的所有正在运行的请求来访问<code>cluster-info</code> ConfigMap。</li></ol><h3 id="安装插件" tabindex="-1"><a class="header-anchor" href="#安装插件" aria-hidden="true">#</a> 安装插件</h3><p>Kubeadm通过API服务器安装内部DNS服务器和kube-proxy插件组件。请注意:</p><ol><li>此阶段可以使用 <a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/kubeadm_init_phase.html#kubeadm-init-phase-addon" target="_blank" rel="noopener noreferrer"><code>kubeadm init phase addon all</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>命令单独调用。</li></ol><h4 id="proxy" tabindex="-1"><a class="header-anchor" href="#proxy" aria-hidden="true">#</a> proxy</h4><p>在 <code>kube-system</code> 命名空间中创建一个用于<code>kube-proxy</code>的ServiceAccount；然后<code>kube-proxy</code>作为DaemonSet部署:</p><ul><li>到主节点的凭据（<code>ca.crt</code>和<code>token</code>）来自ServiceAccount</li><li>主节点的位置来自ConfigMap</li><li><code>kube-proxy</code> ServiceAccount绑定到 <code>system:node-proxier</code> ClusterRole中的特权</li></ul><h4 id="dns" tabindex="-1"><a class="header-anchor" href="#dns" aria-hidden="true">#</a> DNS</h4><p>请注意：</p><ul><li>CoreDNS服务被命名为<code>kube-dns</code>。这样做是为了防止当用户将集群DNS从kube-dns切换到CoreDNS（反之亦然）时服务中的任何中断</li><li>在Kubernetes v1.10或更早的版本中，必须使用 <code>--feature-gates=CoreDNS=true</code>启用CoreDNS</li><li>在Kubernetes v1.11和v1.12版本中，CoreDNS是默认的DNS服务器，必须使用 <code>--feature-gates=CoreDNS=false</code>调用kubeadm来安装kube-dns</li><li>在Kubernetes v1.13及更高版本中，CoreDNS特性开关不再可用，可以使用这里描述的<code>--config</code>方法安装kube-dns</li></ul><p>在<code>kube-system</code>命名空间中创建了一个用于CoreDNS或kube-dns的ServiceAccount。</p><p>部署<code>kube-dns</code>部署和服务:</p><ul><li>这是相对未经修改的上游核心部署</li><li><code>kube-dns</code>服务帐户绑定到 <code>system:kube-dns</code> ClusterRole的特权</li></ul><h3 id="可选的自托管" tabindex="-1"><a class="header-anchor" href="#可选的自托管" aria-hidden="true">#</a> 可选的自托管</h3><p>要在现有的静态Pod控制平面上启用自托管，请使用<code>kubeadm alpha selfhosting pivot</code>。</p><p>自托管基本上用DaemonSet替换了用于控制平面组件的pod吊舱；这是通过对API服务器、调度器和控制器管理器静态吊舱执行以下步骤实现的:</p><ul><li>从磁盘加载静态Pod规约</li><li>从静态Pod清单文件中提取PodSpec</li><li>修改PodSpec使之与自托管兼容，更多细节: <ul><li>添加节点选择器属性，定向至拥有<code>node-role.kubernetes.io/master=&quot;&quot;</code> 标签的节点</li><li>添加 <code>node-role.kubernetes.io/master:NoSchedule</code> 污染的容忍</li><li>将 <code>spec.DNSPolicy</code> 设置为<code>ClusterFirstWithHostNet</code></li></ul></li><li>使用上面提到的PodSpec，为自托管组件构建一个新的DaemonSet对象。</li><li>在<code>kube-system</code>命名空间中创建DaemonSet资源，并等待pod开始运行。</li><li>删除静态Pod清单文件。kubelet将停止原来运行的静态pod托管组件</li></ul><p>请注意，自托管尚未恢复到节点重启；这可以通过外部检查点或控制平面pod的kubelet检查点来修复。有关更多细节，请参见<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/kubeadm_init.html#zituoguan" target="_blank" rel="noopener noreferrer">自托管<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。</p><h3 id="kubeadm-join-phase的内部设计" tabindex="-1"><a class="header-anchor" href="#kubeadm-join-phase的内部设计" aria-hidden="true">#</a> kubeadm join phase的内部设计</h3><p>与<code>kubeadm init</code>类似，<code>kubeadm join</code>内部工作流程也由一系列要执行的原子工作任务组成。</p><p>这分为发现（让节点信任Kubernetes主节点）和TLS引导（让Kubernetes主节点信任该节点）。</p><p>参见<a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/accessing_api/authenticating_with_bootstrap_tokens.html" target="_blank" rel="noopener noreferrer">使用引导令牌进行认证<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>或相应的<a href="https://github.com/kubernetes/community/blob/master/contributors/design-proposals/cluster-lifecycle/bootstrap-discovery.md" target="_blank" rel="noopener noreferrer">设计提案<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。</p><h3 id="预先-preflight-检查" tabindex="-1"><a class="header-anchor" href="#预先-preflight-检查" aria-hidden="true">#</a> 预先（preflight）检查</h3><p><code>kubeadm</code>在启动加入集群之前执行一组预先检查，目的是验证先决条件并避免常见的集群启动问题。</p><p>请注意：</p><ol><li><code>kubeadm join</code>预先检查基本上是<code>kubeadm init</code>预先检查的子集</li><li>从v1.9开始，kubeadm为CRI-generic功能提供了更好的支持；在这种情况下，为crictl跳过或替换docker特定的控件。</li><li>从v1.9开始，kubeadm支持运行在Windows上的节点加入集群；在这种情况下，将跳过linux特定的控件。</li><li>在任何情况下，用户都可以使用<code>--ignore-preflight-errors</code> 选项跳过特定的预先检查（或者最终跳过所有的预先检查）。</li></ol><h3 id="发现cluster-info" tabindex="-1"><a class="header-anchor" href="#发现cluster-info" aria-hidden="true">#</a> 发现cluster-info</h3><p>有两种主要的发现方案。第一种方法是使用共享令牌和API服务器的IP地址。第二种方法是提供一个文件（它是标准kubeconfig文件的子集）。</p><h4 id="共享令牌发现" tabindex="-1"><a class="header-anchor" href="#共享令牌发现" aria-hidden="true">#</a> 共享令牌发现</h4><p>如果使用<code>--discovery-token</code>调用<code>kubeadm join</code>，则使用令牌发现；在本例中，节点基本上从<code>kube-public</code>命名空间中的<code>cluster-info</code> ConfigMap中检索集群CA证书。</p><p>为了防止“中间人”的攻击，我们采取了以下几个步骤:</p><ul><li>首先，通过不安全的连接检索CA证书（这是可能的，因为<code>kubeadm init</code>为<code>system:unauthenticated</code>授予了对 <code>cluster-info</code> 用户的访问权限）</li><li>然后CA证书经过以下验证步骤: <ul><li>基本验证：对JWT签名使用令牌ID</li><li>公钥验证：使用提供的 <code>--discovery-token-ca-cert-hash</code>。这个值在<code>kubeadm init</code>的输出中可用，或者可以使用标准工具计算（哈希是通过Subject Public Key Info (SPKI)对象的字节计算的，如RFC7469中所示）。<code>--discovery-token-ca-cert-hash flag</code> 选项可以重复多次，以允许多个公钥。</li><li>作为附加验证，CA证书通过安全连接检索，然后与最初检索的CA进行比较</li></ul></li></ul><p>请注解：</p><ol><li>通过传递<code>--discovery-token-unsafe-skip-ca-verification</code> 选项，可以路过公钥验证；这削弱了kubeadm安全模型，因为其他人可能冒充Kubernetes主节点。</li></ol><h4 id="文件或https发现" tabindex="-1"><a class="header-anchor" href="#文件或https发现" aria-hidden="true">#</a> 文件或HTTPS发现</h4><p>如果使用<code>--discovery-file</code>调用<code>kubeadm join</code>，则使用文件发现；该文件可以是本地文件，也可以通过HTTPS URL下载；对于HTTPS，使用已安装的主节点CA 包验证节点加入集群。</p><p>通过文件发现，集群CA证书被添加在文件本身中；事实上，发现文件是一个kubeconfig文件，只设置了 <code>server</code>和 <code>certificate-authority-data</code>属性，如 <a href="https://www.coderdocument.com/docs/kubernetes/v1.14/reference/setup_tools_reference/kubeadm/kubeadm_join.html" target="_blank" rel="noopener noreferrer"><code>kubeadm join</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>参考文档中所述；当与集群建立连接时，kubeadm尝试访问<code>cluster-info</code> ConfigMap，如果可用，则使用它。</p><h3 id="tls引导" tabindex="-1"><a class="header-anchor" href="#tls引导" aria-hidden="true">#</a> TLS引导</h3><p>一旦知道集群信息，就会写入<code>bootstrap-kubelet.conf</code>文件，从而允许kubelet执行TLS引导（相反，直到v.1.7 TLS引导才由kubeadm管理）。</p><p>TLS引导机制使用共享令牌与Kubernetes主节点进行临时认证，为本地创建的密钥对提交证书签名请求(CSR)。</p><p>然后自动批准请求，保存<code>ca.crt</code>文件和<code>kubelet.conf</code>文件，kubelet将使用该文件加入集群，同时删除<code>bootstrap-kubelet.conf</code>。</p><p>请注意：</p><ul><li>临时认证是根据<code>kubeadm init</code>流程中保存的令牌进行验证的（或者使用<code>kubeadm token</code>创建的其他令牌）</li><li>临时认证解析为<code>system:bootstrappers:kubeadm:default-node-token</code> 组的用户成员，该用户组在<code>kubeadm init</code>流程中被授予访问CSR API的权限</li><li>自动CSR批准由<code>csrapprover</code>控制器根据<code>kubeadm init</code>流程的配置进行管理</li></ul><h4 id="在v1-9中为可选的alpha级别-写入kubelet初始化配置" tabindex="-1"><a class="header-anchor" href="#在v1-9中为可选的alpha级别-写入kubelet初始化配置" aria-hidden="true">#</a> （在v1.9中为可选的alpha级别）写入kubelet初始化配置</h4><p>如果使用 <code>--feature-gates=DynamicKubeletConfig</code>调用<code>kubeadm</code>：</p><ul><li>使用引导令牌凭证将kubelet基本配置写入<code>kube-system</code>命名空间中的<code>kubelet-base-config-v1.9</code> ConfigMap，并将其作为 kubelet初始化文件 <code>/var/lib/kubelet/config/init/kubelet</code> 写入磁盘。</li><li>一旦kubelet开始使用节点自己的凭据（<code>/etc/kubernetes/kubelet.conf</code>），更新当前节点配置，指定的节点或kubelet和配置来源于上述ConfigMap。</li></ul><p>请注意：</p><ol><li>要使动态kubelet配置工作，需要在<code>/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</code>中设置<code>--dynamic-config-dir=/var/lib/kubelet/config/dynamic</code>选项。</li></ol><h2 id="end-链接" tabindex="-1"><a class="header-anchor" href="#end-链接" aria-hidden="true">#</a> END 链接</h2><ul><li><div><a href="63.md" style="float:left;">⬆️上一节🔗 </a><a href="65.md" style="float:right;"> ️下一节🔗</a></div></li></ul><ul><li><p><a href="/" class="">Ⓜ️回到目录🏠</a></p></li><li><p><a href="https://nsddd.top/archives/contributors" target="_blank" rel="noopener noreferrer"><strong>🫵参与贡献💞❤️‍🔥💖</strong><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>)</p></li><li><p>✴️版权声明 © ：本书所有内容遵循<a href="http://zh.wikipedia.org/wiki/Wikipedia:CC-by-sa-3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" target="_blank" rel="noopener noreferrer">CC-BY-SA 3.0协议（署名-相同方式共享）©<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li></ul></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/3293172751/awesome-docker/edit/master/docs/Cloud-Native-k8s/64.md" rel="noopener noreferrer" target="_blank" aria-label="在GitHub上贡献此页面"><!--[--><!--]--> 在GitHub上贡献此页面 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">上次更新: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 3293172751nss@gmail.com">Xinwei Xiong</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: 3293172751nss@gmail.com">xiongxinwei</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/Cloud-Native-k8s/63.html" class="" aria-label="第63节 Prometheus 和 Grafana 日志收集方案"><!--[--><!--]--> 第63节 Prometheus 和 Grafana 日志收集方案 <!--[--><!--]--></a></span><span class="next"><a href="/Cloud-Native-k8s/65.html" class="" aria-label="第65节 eBPF 刨析以及源码学习"><!--[--><!--]--> 第65节 eBPF 刨析以及源码学习 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.f2f3c0f5.js" defer></script>
  </body>
</html>
